<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Reparación Electrodomésticos | ERB Servicio Técnico Gama Blanca</title>
    <meta name="description" content="Servicio técnico experto en reparación de electrodomésticos de gama blanca, industrial e instalación de aires acondicionados. ¡Soluciones rápidas y con garantía!">
    <link rel="canonical" href="https://erbserviciotecnico.com/">
    <link rel="icon" href="/favicon.ico">

    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css">
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-TQC24XCERF"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Reparación Electrodomésticos | ERB Servicio Técnico Gama Blanca</title>
    <meta name="description" content="Servicio técnico experto en reparación de electrodomésticos de gama blanca, industrial e instalación de aires acondicionados. ¡Soluciones rápidas y con garantía!">
    <link rel="canonical" href="https://erbserviciotecnico.com/">
    <link rel="icon" href="/favicon.ico">

    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css">
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-TQC24XCERF"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());
      gtag('config', 'G-TQC24XCERF');
    </script>

    <style>
        body {
            font-family: 'Inter', sans-serif; 
        }
        .hero-bg {
            background-image: linear-gradient(rgba(0, 0, 0, 0.6), rgba(0, 0, 0, 0.6)), url('/imagen-hero.jpg.jpeg'); 
            background-size: cover;
            background-position: center;
            min-height: 100vh; 
        }
        
        @media (max-width: 768px) {
            .hero-bg {
                background-image: linear-gradient(rgba(0, 0, 0, 0.6), rgba(0, 0, 0, 0.6)), url('/imagen-hero-movil.jpg'); 
            }
        }

        .navy-blue {
            background-color: #001f3f; 
        }
        .text-navy {
            color: #001f3f;
        }
        .border-navy {
            border-color: #001f3f;
        }
        .btn-primary {
            background-color: #001f3f;
            color: white;
            transition: background-color 0.3s ease;
        }
        .btn-primary:hover {
            background-color: #003366; 
        }
        .btn-google {
            background-color: #DB4437;
            color: white;
            transition: background-color 0.3s ease;
        }
        .btn-google:hover {
            background-color: #C33D2E;
        }
        .section-title {
            border-bottom: 3px solid #001f3f;
            padding-bottom: 0.5rem;
            display: inline-block;
        }
        .service-card, .benefit-card, .testimonial-card {
            transition: transform 0.3s ease, box-shadow 0.3s ease;
        }
        .service-card:hover, .benefit-card:hover, .testimonial-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.1), 0 4px 6px -2px rgba(0, 0, 0, 0.05);
        }
        #mobile-menu {
            transform: translateX(-100%);
            transition: transform 0.3s ease-in-out;
        }
        #mobile-menu.open {
            transform: translateX(0);
        }
        .brand-logo img {
            height: 50px; 
            width: auto;
            margin: 0.5rem;
            filter: grayscale(100%);
            transition: filter 0.3s ease;
        }
        .brand-logo img:hover {
            filter: grayscale(0%);
        }
        .filter-btn {
            transition: background-color 0.3s ease, color 0.3s ease;
        }
        .filter-btn.active {
            background-color: #001f3f;
            color: white;
        }
        .service-hidden {
            display: none !important;
        }
        #map {
            height: 350px;
            width: 100%;
            border-radius: 0.5rem;
            overflow: hidden;
            box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.1), 0 4px 6px -2px rgba(0, 0, 0, 0.05);
        }
        #cookie-banner {
            position: fixed;
            bottom: 0;
            left: 0;
            right: 0;
            background-color: #1a202c; /* bg-gray-800 */
            color: white;
            padding: 1rem; /* p-4 */
            box-shadow: 0 -2px 10px rgba(0,0,0,0.2);
            z-index: 1000;
            display: none; 
        }
        #cookie-banner a {
            color: #63b3ed; /* text-blue-400 */
            text-decoration: underline;
        }
        #cookie-banner a:hover {
            color: #90cdf4; /* text-blue-300 */
        }

        #loading-spinner.hidden, #success-message-modal.hidden, #testimonial-loading-spinner.hidden, #testimonial-auth-message.hidden {
            display: none;
        }
        #google-signin-btn.hidden, #signout-btn.hidden, #user-info.hidden {
            display: none;
        }
        #testimonialForm.hidden {
            display: none;
        }

        /* Estilos para estrellas de calificación */
        .star-rating .fa-star {
            color: #ddd; /* Color de estrella vacía */
            cursor: pointer;
            transition: color 0.2s ease-in-out;
        }
        .star-rating .fa-star.selected,
        .star-rating .fa-star:hover,
        .star-rating .fa-star:hover ~ .fa-star {
            color: #f5b301; /* Color de estrella llena/hover */
        }
        .star-rating:hover .fa-star.selected:hover ~ .fa-star {
            color: #ddd; /* Mantener seleccionadas al hacer hover sobre otras */
        }
        .testimonial-stars .fa-star {
             color: #f5b301;
        }
        .testimonial-stars .fa-star.empty {
            color: #ddd;
        }

    </style>
</head>
<body class="bg-white text-gray-800">

    <script type="application/ld+json">
    {
      "@context": "https://schema.org",
      "@type": "LocalBusiness",
      "name": "ERB Servicio Técnico",
      "image": "https://erbserviciotecnico.com/logo.png", 
      "@id": "https://erbserviciotecnico.com/", 
      "url": "https://erbserviciotecnico.com/",
      "telephone": "+34612548508",
      "priceRange": "$$", 
      "description": "Especialistas en reparación de electrodomésticos de gama blanca, domésticos e industriales, y servicio de instalación de aires acondicionados en Barcelona, Coruña, Valencia y Castellón.",
      "address": {
        "@type": "PostalAddress",
        "addressCountry": "ES" 
      },
      "areaServed": [
        { "@type": "City", "name": "Barcelona" },
        { "@type": "City", "name": "Coruña" },
        { "@type": "City", "name": "Valencia" },
        { "@type": "City", "name": "Castellón de la Plana" }
      ],
      "hasOfferCatalog": {
        "@type": "OfferCatalog",
        "name": "Servicios Técnicos",
        "itemListElement": [
          { "@type": "Offer", "itemOffered": { "@type": "Service", "name": "Reparación de electrodomésticos gama blanca", "serviceType": "Reparación de electrodomésticos" } },
          { "@type": "Offer", "itemOffered": { "@type": "Service", "name": "Reparación de electrodomésticos industriales", "serviceType": "Reparación de electrodomésticos industriales" } },
          { "@type": "Offer", "itemOffered": { "@type": "Service", "name": "Instalación de aires acondicionados", "serviceType": "Instalación de aire acondicionado" } }
        ]
      },
      "aggregateRating": { 
        "@type": "AggregateRating",
        "ratingValue": "4.8", 
        "reviewCount": "25" 
      }
    }
    </script>

    <header class="navy-blue text-white shadow-lg sticky top-0 z-50">
        <div class="container mx-auto px-6 py-4 flex justify-between items-center">
            <a href="#inicio" class="text-2xl font-bold flex items-center">
                <img src="/logo.png" alt="ERB Servicio Técnico Logo" class="h-8 mr-2" onerror="this.onerror=null;this.src='https://placehold.co/100x30/001f3f/ffffff?text=ERB';"> <span data-lang="company_name_header">ERB Servicio Técnico</span>
            </a>
            <nav class="hidden md:flex space-x-4">
                <a href="#inicio" class="hover:text-gray-300 px-3 py-2 rounded-md text-sm font-medium" data-lang="nav_home">Inicio</a>
                <a href="#servicios" class="hover:text-gray-300 px-3 py-2 rounded-md text-sm font-medium" data-lang="nav_services">Servicios</a>
                <a href="#beneficios" class="hover:text-gray-300 px-3 py-2 rounded-md text-sm font-medium" data-lang="nav_benefits">Beneficios</a>
                <a href="#marcas" class="hover:text-gray-300 px-3 py-2 rounded-md text-sm font-medium" data-lang="nav_brands">Marcas</a>
                <a href="#nosotros" class="hover:text-gray-300 px-3 py-2 rounded-md text-sm font-medium" data-lang="nav_about">Sobre Nosotros</a>
                <a href="#testimonios" class="hover:text-gray-300 px-3 py-2 rounded-md text-sm font-medium" data-lang="nav_testimonials">Testimonios</a>
                <a href="#contacto" class="hover:text-gray-300 px-3 py-2 rounded-md text-sm font-medium" data-lang="nav_contact">Contacto</a>
            </nav>
            <div class="flex items-center">
                <div class="relative mr-4">
                    <button id="language-selector-btn" class="flex items-center focus:outline-none">
                        <i class="fas fa-globe mr-1"></i>
                        <span id="current-lang-text">ES</span>
                        <i class="fas fa-chevron-down ml-1 text-xs"></i>
                    </button>
                    <div id="language-dropdown" class="absolute right-0 mt-2 py-2 w-28 navy-blue rounded-md shadow-xl z-20 hidden">
                        <a href="#" class="block px-4 py-2 text-sm text-white hover:bg-blue-800" data-lang-option="es">Español</a>
                        <a href="#" class="block px-4 py-2 text-sm text-white hover:bg-blue-800" data-lang-option="ca">Català</a>
                        <a href="#" class="block px-4 py-2 text-sm text-white hover:bg-blue-800" data-lang-option="va">Valencià</a>
                    </div>
                </div>
                <button id="mobile-menu-button" class="md:hidden focus:outline-none">
                    <i class="fas fa-bars text-2xl"></i>
                </button>
            </div>
        </div>
    </header>

    <div id="mobile-menu" class="fixed inset-0 navy-blue text-white z-40 p-6 md:hidden">
        <div class="flex justify-end mb-8">
            <button id="close-mobile-menu-button" class="focus:outline-none">
                <i class="fas fa-times text-3xl"></i>
            </button>
        </div>
        <nav class="flex flex-col space-y-4 text-center">
            <a href="#inicio" class="hover:text-gray-300 text-lg py-2" data-lang="nav_home_mobile">Inicio</a>
            <a href="#servicios" class="hover:text-gray-300 text-lg py-2" data-lang="nav_services_mobile">Servicios</a>
            <a href="#beneficios" class="hover:text-gray-300 text-lg py-2" data-lang="nav_benefits_mobile">Beneficios</a>
            <a href="#marcas" class="hover:text-gray-300 text-lg py-2" data-lang="nav_brands_mobile">Marcas</a>
            <a href="#nosotros" class="hover:text-gray-300 text-lg py-2" data-lang="nav_about_mobile">Sobre Nosotros</a>
            <a href="#testimonios" class="hover:text-gray-300 text-lg py-2" data-lang="nav_testimonials_mobile">Testimonios</a>
            <a href="#contacto" class="hover:text-gray-300 text-lg py-2" data-lang="nav_contact_mobile">Contacto</a>
        </nav>
    </div>

    <section id="inicio" class="hero-bg text-white min-h-screen flex items-center">
        <div class="container mx-auto px-6 text-center">
            <h1 class="text-4xl md:text-5xl font-bold mb-6" data-lang="hero_h1">Reparación de Electrodomésticos: ERB Servicio Técnico</h1>
            <p class="text-lg md:text-xl mb-8 max-w-3xl mx-auto" data-lang="hero_subtitle">Especialistas en reparación y mantenimiento de electrodomésticos de gama blanca, industrial e instalación de aires acondicionados.</p>
            <a href="#contacto" class="btn-primary hover:bg-blue-700 text-white font-bold py-3 px-8 rounded-lg text-lg" data-lang="hero_cta">Solicita Presupuesto</a>
        </div>
    </section>

    <section id="servicios" class="py-16 md:py-24 bg-gray-50">
        <div class="container mx-auto px-6">
            <h2 class="text-3xl md:text-4xl font-bold text-center mb-4 text-navy" data-lang="services_title">Nuestros Servicios</h2>
            <p class="text-center text-gray-600 mb-8 max-w-xl mx-auto" data-lang="services_intro">Soluciones expertas para todo tipo de electrodomésticos y climatización.</p>
            
            <div class="flex justify-center space-x-2 md:space-x-4 mb-10">
                <button class="filter-btn active px-4 py-2 md:px-6 md:py-3 rounded-lg border border-navy text-navy hover:bg-navy-blue hover:text-white" data-filter="all" data-lang="filter_all">Todos</button>
                <button class="filter-btn px-4 py-2 md:px-6 md:py-3 rounded-lg border border-navy text-navy hover:bg-navy-blue hover:text-white" data-filter="domestico" data-lang="filter_domestic">Doméstico</button>
                <button class="filter-btn px-4 py-2 md:px-6 md:py-3 rounded-lg border border-navy text-navy hover:bg-navy-blue hover:text-white" data-filter="industrial" data-lang="filter_industrial">Industrial</button>
            </div>

            <div id="service-list" class="grid md:grid-cols-2 lg:grid-cols-3 gap-8">
                </div>
        </div>
    </section>
    
    <section id="beneficios" class="py-16 md:py-24 bg-white">
        <div class="container mx-auto px-6">
            <h2 class="text-3xl md:text-4xl font-bold text-center mb-12 section-title text-navy" data-lang="benefits_title">Por Qué Elegirnos</h2>
            <div class="grid md:grid-cols-2 lg:grid-cols-4 gap-8">
                <div class="benefit-card text-center p-6 bg-gray-50 rounded-xl shadow">
                    <div class="text-3xl text-navy mb-4"><i class="fas fa-phone-volume"></i></div>
                    <h3 class="text-xl font-semibold text-navy mb-2" data-lang="benefit1_title">Atención Inmediata</h3>
                    <p class="text-gray-600 text-sm" data-lang="benefit1_desc">Solicita tu inspección llamando a nuestros canales de atención al cliente.</p>
                </div>
                <div class="benefit-card text-center p-6 bg-gray-50 rounded-xl shadow">
                    <div class="text-3xl text-navy mb-4"><i class="fas fa-shipping-fast"></i></div>
                    <h3 class="text-xl font-semibold text-navy mb-2" data-lang="benefit2_title">Sin Coste de Desplazamiento</h3>
                    <p class="text-gray-600 text-sm" data-lang="benefit2_desc">Reparación en el acto si decides reparar, no cobramos el desplazamiento.</p>
                </div>
                <div class="benefit-card text-center p-6 bg-gray-50 rounded-xl shadow">
                    <div class="text-3xl text-navy mb-4"><i class="fas fa-shield-alt"></i></div>
                    <h3 class="text-xl font-semibold text-navy mb-2" data-lang="benefit3_title">Garantía de 6 Meses</h3>
                    <p class="text-gray-600 text-sm" data-lang="benefit3_desc">Disfruta de tu electrodoméstico como nuevo con garantía en la reparación de 6 meses.</p>
                </div>
                <div class="benefit-card text-center p-6 bg-gray-50 rounded-xl shadow">
                    <div class="text-3xl text-navy mb-4"><i class="fas fa-euro-sign"></i></div>
                    <h3 class="text-xl font-semibold text-navy mb-2" data-lang="benefit4_title">Precios Competitivos</h3>
                    <p class="text-gray-600 text-sm" data-lang="benefit4_desc">Precios competitivos en todas las reparaciones de electrodomésticos.</p>
                </div>
            </div>
        </div>
    </section>

    <section id="marcas" class="py-16 md:py-24 bg-gray-100">
        <div class="container mx-auto px-6">
            <h2 class="text-3xl md:text-4xl font-bold text-center mb-12 section-title text-navy" data-lang="brands_title">Trabajamos con las Mejores Marcas</h2>
            <div class="flex flex-wrap justify-center items-center">
                <div class="brand-logo p-2"><img src="/samsung-logo-wordmark-rgb.png" alt="Reparación electrodomésticos Samsung" onerror="this.onerror=null;this.src='https://placehold.co/150x50/ffffff/000000?text=Samsung';"></div>
                <div class="brand-logo p-2"><img src="/lg-logo-1.png" alt="Reparación electrodomésticos LG" onerror="this.onerror=null;this.src='https://placehold.co/150x50/ffffff/000000?text=LG';"></div>
                <div class="brand-logo p-2"><img src="/balay.png" alt="Reparación electrodomésticos Balay" onerror="this.onerror=null;this.src='https://placehold.co/150x50/ffffff/000000?text=Balay';"></div>
                <div class="brand-logo p-2"><img src="/siemens-Photoroom.png" alt="Reparación electrodomésticos Siemens" onerror="this.onerror=null;this.src='https://placehold.co/150x50/ffffff/000000?text=Siemens';"></div>
                <div class="brand-logo p-2"><img src="/Whirlpool_Corporation_Logo_(as_of_2017).svg.png" alt="Reparación electrodomésticos Whirlpool" onerror="this.onerror=null;this.src='https://placehold.co/150x50/ffffff/000000?text=Whirlpool';"></div>
                <div class="brand-logo p-2"><img src="/neckar.png" alt="Reparación electrodomésticos Neckar" onerror="this.onerror=null;this.src='https://placehold.co/150x50/ffffff/000000?text=Neckar';"></div>
                <div class="brand-logo p-2"><img src="/bosch.png" alt="Reparación electrodomésticos Bosch" onerror="this.onerror=null;this.src='https://placehold.co/150x50/ffffff/000000?text=Bosch';"></div>
                <div class="brand-logo p-2"><img src="/Haier_logo.svg.png" alt="Reparación electrodomésticos Haier" onerror="this.onerror=null;this.src='https://placehold.co/150x50/ffffff/000000?text=Haier';"></div>
                <div class="brand-logo p-2"><img src="/mitsubishi-Photoroom.png" alt="Reparación aires acondicionados Mitsubishi Electric" onerror="this.onerror=null;this.src='https://placehold.co/150x50/ffffff/000000?text=Mitsubishi';"></div>
                <div class="brand-logo p-2"><img src="/saunier-Photoroom.png" alt="Reparación calderas Saunier Duval" onerror="this.onerror=null;this.src='https://placehold.co/150x50/ffffff/000000?text=Saunier+Duval';"></div>
                <div class="brand-logo p-2"><img src="/ariston-Photoroom.png" alt="Reparación termos Ariston" onerror="this.onerror=null;this.src='https://placehold.co/150x50/ffffff/000000?text=Ariston';"></div>
                <div class="brand-logo p-2"><img src="/vaillant-Photoroom.png" alt="Reparación calderas Vaillant" onerror="this.onerror=null;this.src='https://placehold.co/150x50/ffffff/000000?text=Vaillant';"></div>
                <div class="brand-logo p-2"><img src="/junkers.png" alt="Reparación calentadores Junkers" onerror="this.onerror=null;this.src='https://placehold.co/150x50/ffffff/000000?text=Junkers';"></div>
            </div>
        </div>
    </section>

    <section id="nosotros" class="py-16 md:py-24 bg-white">
        <div class="container mx-auto px-6">
            <div class="text-center">
                <h2 class="text-3xl md:text-4xl font-bold mb-12 section-title text-navy" data-lang="about_title">Sobre Nosotros</h2>
            </div>
            <div class="grid md:grid-cols-2 gap-12 items-center">
                <div>
                    <img src="https://placehold.co/600x400/001f3f/ffffff?text=Equipo+ERB" alt="Equipo de ERB Servicio Técnico" class="rounded-lg shadow-xl w-full h-auto object-cover">
                </div>
                <div class="text-gray-700">
                    <p class="mb-4" data-lang="about_text_p1">Somos un equipo de técnicos especializados con años de experiencia en la reparación y mantenimiento de electrodomésticos de gama blanca, tanto domésticos como industriales, así como en la instalación de aires acondicionados.</p>
                    <p class="mb-4" data-lang="about_text_p2">Nuestro compromiso es ofrecer un servicio rápido, eficiente y con garantía, asegurando la máxima satisfacción de nuestros clientes en Barcelona, Coruña, Valencia y Castellón de la Plana.</p>
                    <p data-lang="about_text_p3">Confía en nosotros para devolverle la vida a tus electrodomésticos.</p>
                </div>
            </div>
        </div>
    </section>

    <section id="testimonios" class="py-16 md:py-24 bg-gray-50">
        <div class="container mx-auto px-6">
            <h2 class="text-3xl md:text-4xl font-bold text-center mb-12 section-title text-navy" data-lang="testimonials_title">Opiniones de Nuestros Clientes</h2>
            
            <div class="max-w-2xl mx-auto bg-white p-8 rounded-xl shadow-lg mb-16">
                <h3 class="text-2xl font-semibold text-navy mb-6" data-lang="testimonial_form_title">Deja tu Opinión</h3>
                
                <div id="auth-container" class="mb-6 text-center">
                    <div id="user-info" class="hidden mb-4">
                        <p><span data-lang="testimonial_logged_in_as">Conectado como:</span> <span id="user-display-name" class="font-semibold"></span></p>
                        <button id="signout-btn" class="mt-2 text-sm text-red-600 hover:underline" data-lang="testimonial_sign_out">Cerrar Sesión</button>
                    </div>
                    <button id="google-signin-btn" class="btn-google hover:bg-red-700 text-white font-bold py-2 px-4 rounded-lg inline-flex items-center">
                        <i class="fab fa-google mr-2"></i> <span data-lang="testimonial_signin_google">Iniciar sesión con Google para opinar</span>
                    </button>
                </div>

                <div id="testimonial-auth-message" class="text-center p-4 mb-4 bg-yellow-100 text-yellow-700 rounded-md">
                    <p data-lang="testimonial_login_to_submit">Por favor, inicia sesión con Google para dejar una opinión.</p>
                </div>

                <form id="testimonialForm" class="space-y-6 hidden">
                    <div>
                        <label for="testimonialNombre" class="block text-sm font-medium text-gray-700" data-lang="testimonial_form_name">Tu Nombre</label>
                        <input type="text" name="testimonialNombre" id="testimonialNombre" required class="mt-1 block w-full px-4 py-3 rounded-md shadow-sm border-gray-300 focus:ring-navy focus:border-navy bg-gray-100" readonly>
                    </div>
                    <div>
                        <label class="block text-sm font-medium text-gray-700" data-lang="testimonial_form_rating">Tu Puntuación</label>
                        <div id="testimonialRating" class="star-rating flex space-x-1 mt-1 text-2xl">
                            <i class="fas fa-star" data-value="1"></i>
                            <i class="fas fa-star" data-value="2"></i>
                            <i class="fas fa-star" data-value="3"></i>
                            <i class="fas fa-star" data-value="4"></i>
                            <i class="fas fa-star" data-value="5"></i>
                        </div>
                        <input type="hidden" name="ratingValue" id="ratingValue" required>
                    </div>
                    <div>
                        <label for="testimonialMensaje" class="block text-sm font-medium text-gray-700" data-lang="testimonial_form_message">Tu Comentario</label>
                        <textarea name="testimonialMensaje" id="testimonialMensaje" rows="4" required class="mt-1 block w-full px-4 py-3 rounded-md shadow-sm border-gray-300 focus:ring-navy focus:border-navy"></textarea>
                    </div>
                    <div>
                        <button type="submit" id="submit-testimonial-form" class="w-full btn-primary text-white font-bold py-3 px-6 rounded-lg text-lg transition duration-300" data-lang="testimonial_form_submit">Enviar Opinión</button>
                    </div>
                </form>
                <div id="testimonial-form-status" class="mt-4 text-center"></div>
                 <div id="testimonial-loading-spinner" class="hidden flex items-center justify-center mt-4">
                    <div class="animate-spin rounded-full h-8 w-8 border-t-2 border-b-2 border-navy"></div>
                    <p class="ml-2 text-navy" data-lang="form_sending">Enviando...</p>
                </div>
            </div>

            <div id="testimonial-list" class="grid md:grid-cols-2 lg:grid-cols-3 gap-8">
                </div>
            <p id="no-testimonials" class="text-center text-gray-600 mt-8 hidden" data-lang="testimonials_empty">Aún no hay testimonios. ¡Sé el primero en dejar tu opinión iniciando sesión!</p>
        </div>
    </section>


    <section id="contacto" class="py-16 md:py-24 navy-blue text-white">
        <div class="container mx-auto px-6">
            <h2 class="text-3xl md:text-4xl font-bold text-center mb-12" data-lang="contact_title">Contacta con Nosotros</h2>
            <div class="grid md:grid-cols-2 gap-10 items-start">
                <div>
                    <h3 class="text-2xl font-semibold mb-6" data-lang="contact_form_title">Envíanos un Mensaje</h3>
                    <form id="contactForm" action="https://formsubmit.co/serviciotecnico.erb@gmail.com" method="POST" class="space-y-6">
                        <input type="hidden" name="_subject" value="Nuevo mensaje desde la web ERB Servicio Técnico">
                        <input type="hidden" name="_captcha" value="false"> 
                        <input type="hidden" name="_template" value="table"> 
                        
                        <div>
                            <label for="nombre" class="block text-sm font-medium" data-lang="form_name">Nombre</label>
                            <input type="text" name="nombre" id="nombre" required class="mt-1 block w-full px-4 py-3 rounded-md shadow-sm bg-white text-gray-800 focus:ring-blue-500 focus:border-blue-500 border-gray-300">
                        </div>
                        <div>
                            <label for="telefono" class="block text-sm font-medium" data-lang="form_phone">Teléfono</label>
                            <input type="tel" name="telefono" id="telefono" required class="mt-1 block w-full px-4 py-3 rounded-md shadow-sm bg-white text-gray-800 focus:ring-blue-500 focus:border-blue-500 border-gray-300">
                        </div>
                        <div>
                            <label for="ubicacion" class="block text-sm font-medium" data-lang="form_location">Ubicación del servicio</label>
                            <select name="ubicacion" id="ubicacion" required class="mt-1 block w-full px-4 py-3 rounded-md shadow-sm bg-white text-gray-800 focus:ring-blue-500 focus:border-blue-500 border-gray-300">
                                <option value="barcelona" data-lang="loc_barcelona">Barcelona</option>
                                <option value="la_coruna" data-lang="loc_coruna">La Coruña</option>
                                <option value="valencia" data-lang="loc_valencia">Valencia</option>
                                <option value="castellon" data-lang="loc_castellon">Castellón de la Plana</option>
                            </select>
                        </div>
                        <div>
                            <label for="equipo" class="block text-sm font-medium" data-lang="form_appliance">Electrodoméstico a reparar o servicio</label>
                            <select name="equipo" id="equipo" required class="mt-1 block w-full px-4 py-3 rounded-md shadow-sm bg-white text-gray-800 focus:ring-blue-500 focus:border-blue-500 border-gray-300">
                                </select>
                        </div>
                        <div>
                            <label for="mensaje" class="block text-sm font-medium" data-lang="form_message">Descripción del problema</label>
                            <textarea name="mensaje" id="mensaje" rows="4" required class="mt-1 block w-full px-4 py-3 rounded-md shadow-sm bg-white text-gray-800 focus:ring-blue-500 focus:border-blue-500 border-gray-300"></textarea>
                        </div>
                        <div>
                            <button type="submit" id="submit-contact-form" class="w-full bg-white hover:bg-gray-200 text-navy font-bold py-3 px-6 rounded-lg text-lg transition duration-300" data-lang="form_submit">Enviar Mensaje</button>
                        </div>
                    </form>
                    <div id="form-status" class="mt-4 text-center text-white"></div> 
                </div>

                <div class="space-y-8">
                    <div>
                        <h3 class="text-2xl font-semibold mb-4" data-lang="contact_info_title">Otras Formas de Contacto</h3>
                        <p class="flex items-center mb-3">
                            <i class="fas fa-phone mr-3 text-xl"></i>
                            <a href="tel:+34612548508" class="hover:underline" data-lang="contact_phone_text">+34 612 548 508</a>
                        </p>
                        <p class="flex items-center mb-3">
                            <i class="fas fa-envelope mr-3 text-xl"></i>
                            <a href="mailto:serviciotecnico.erb@gmail.com" class="hover:underline" data-lang="contact_email_text">serviciotecnico.erb@gmail.com</a> </p>
                        <p class="flex items-center mb-6">
                            <img src="/123.png" alt="WhatsApp ERB" class="w-6 h-6 mr-2" onerror="this.onerror=null;this.src='https://placehold.co/24x24/ffffff/000000?text=WA';"> <a href="https://wa.me/34612548508" target="_blank" class="hover:underline" data-lang="contact_whatsapp_text">Chatea con nosotros en WhatsApp</a>
                        </p>
                         <p class="flex items-start">
                            <i class="fas fa-map-marker-alt mr-3 text-xl mt-1"></i>
                            <span data-lang="contact_areas">Servicio en: Barcelona, Coruña, Valencia y Castellón de la Plana</span>
                        </p>
                    </div>
                    <div>
                        <h3 class="text-2xl font-semibold mb-4" data-lang="contact_map_title">Nuestra Área de Cobertura</h3>
                        <div id="map">
                             <div id="map-error-message" class="p-4 bg-red-100 text-red-700 rounded-md hidden">
                                <strong data-lang="map_error_title">Error al cargar el mapa:</strong>
                                <p data-lang="map_error_text">El mapa no se puede mostrar en este momento. Si eres el administrador del sitio, asegúrate de que la URL actual esté autorizada en la configuración de la clave API de Google Maps en Google Cloud Console.</p>
                                <p data-lang="map_error_url_is">URL actual para autorizar:</p>
                                <code id="map-current-url" class="text-xs bg-red-200 p-1 rounded"></code>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <div id="loading-spinner" class="hidden fixed inset-0 bg-black bg-opacity-75 flex items-center justify-center z-[100]">
        <div class="animate-spin rounded-full h-20 w-20 border-t-4 border-b-4 border-white"></div>
    </div>

    <div id="success-message-modal" class="hidden fixed inset-0 bg-black bg-opacity-75 flex items-center justify-center z-[100] p-4">
        <div class="bg-white p-8 md:p-10 rounded-xl shadow-2xl text-center max-w-md w-full">
            <div class="mb-5">
                <svg class="mx-auto h-16 w-16 text-green-500" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z" />
                </svg>
            </div>
            <h3 class="text-2xl md:text-3xl font-bold text-gray-800 mb-3" data-lang="form_success_modal_title">¡Enviado con Éxito!</h3>
            <p class="text-gray-600 mb-6" data-lang="form_success_modal_text">Gracias por tu mensaje. En breve nos pondremos en contacto contigo.</p>
            <button id="close-success-modal-btn" class="bg-navy-blue text-white hover:bg-blue-700 font-semibold py-3 px-8 rounded-lg text-lg transition duration-300" data-lang="form_success_modal_close">Cerrar</button>
        </div>
    </div>


    <footer class="bg-gray-900 text-gray-300 py-12">
        <div class="container mx-auto px-6 text-center">
            <p id="footer-copyright-text" data-lang="footer_copyright">© 2025 ERB Servicio Técnico de Electrodomésticos | BARCELONA – CORUÑA – VALENCIA – CASTELLÓN de la Plana</p>
            <div class="mt-4 space-x-4 text-sm">
                <a href="/politica-privacidad.html" class="hover:text-white" data-lang="footer_privacy" id="privacyLink">Política de Privacidad</a>
                <a href="/aviso-legal.html" class="hover:text-white" data-lang="footer_legal" id="legalLink">Aviso Legal</a>
                <a href="/politica-cookies.html" class="hover:text-white" data-lang="footer_cookies" id="cookiesLink">Política de Cookies</a>
            </div>
        </div>
    </footer>

    <div id="cookie-banner" class="items-center justify-between flex-wrap md:flex">
        <p class="text-sm mb-2 md:mb-0 md:mr-4">
            <span data-lang="cookie_banner_text">Este sitio web utiliza cookies para asegurar la mejor experiencia. Al continuar navegando, aceptas su uso, incluidas cookies para Google Analytics y Google Ads. Consulta nuestra</span>
            <a href="/politica-cookies.html" id="cookieBannerPolicyLink" class="font-semibold" data-lang="cookie_banner_policy_link">política de cookies</a>.
        </p>
        <button id="accept-cookies-btn" class="bg-blue-500 hover:bg-blue-600 text-white font-bold py-2 px-4 rounded-lg text-sm" data-lang="cookie_banner_accept">
            Aceptar
        </button>
    </div>

    <script type="module">
        import { initializeApp } from "https://www.gstatic.com/firebasejs/11.8.1/firebase-app.js";
        import { getAuth, onAuthStateChanged, GoogleAuthProvider, signInWithRedirect, signOut, getRedirectResult, browserSessionPersistence, setPersistence } from "https://www.gstatic.com/firebasejs/11.8.1/firebase-auth.js";
        import { getFirestore, collection, addDoc, query, onSnapshot, serverTimestamp, orderBy, limit } from "https://www.gstatic.com/firebasejs/11.8.1/firebase-firestore.js";

        const firebaseConfig = {
          apiKey: "AIzaSyCkuxUilQ75CH4Lx96loCsTASsF1u0WwSc",
          authDomain: "xddddd-23011.firebaseapp.com",
          projectId: "xddddd-23011",
          storageBucket: "xddddd-23011.appspot.com", 
          messagingSenderId: "723576872564",
          appId: "1:723576872564:web:a7c3f486442d7619967b21"
        };
        
        const appId = firebaseConfig.appId; 
        console.log("Firebase App ID en uso para Firestore paths:", appId);

        const app = initializeApp(firebaseConfig);
        const auth = getAuth(app);
        const db = getFirestore(app);
        
        let currentFirebaseUser = null; 

        const googleSignInBtn = document.getElementById('google-signin-btn');
        const signOutBtn = document.getElementById('signout-btn');
        const userInfoDiv = document.getElementById('user-info');
        const userDisplayNameSpan = document.getElementById('user-display-name');
        const testimonialNombreInput = document.getElementById('testimonialNombre');
        const testimonialForm = document.getElementById('testimonialForm');
        const testimonialFormStatus = document.getElementById('testimonial-form-status');
        const testimonialAuthMessage = document.getElementById('testimonial-auth-message'); 
        const testimonialListDiv = document.getElementById('testimonial-list'); 
        const noTestimonialsP = document.getElementById('no-testimonials'); 

        // Intentar establecer la persistencia a 'session'
        setPersistence(auth, browserSessionPersistence)
          .then(() => {
            console.log("Persistencia de autenticación establecida a 'session'.");
            // Una vez establecida la persistencia, verificar el resultado de la redirección.
            return getRedirectResult(auth);
          })
          .then((result) => {
            if (result && result.user) {
              console.log("Usuario obtenido de getRedirectResult:", result.user);
            }
            loadTestimonials(); // Cargar testimonios después de procesar redirect y persistencia
          })
          .catch((error) => {
            console.error("Error al establecer persistencia o en getRedirectResult:", error);
            // Mostrar un mensaje más específico si es un error de almacenamiento conocido
            if (error.code && (error.code.includes('storage') || error.code.includes('auth/operation-not-supported-in-this-environment'))) {
                 if (testimonialFormStatus) {
                    testimonialFormStatus.innerHTML = (translations[currentLanguage]?.testimonial_storage_error || "El inicio de sesión no pudo completarse. Es posible que la configuración de privacidad de tu navegador (prevención de rastreo o bloqueo de cookies de terceros) esté interfiriendo. Por favor, ajusta la configuración para este sitio e inténtalo de nuevo.");
                    testimonialFormStatus.className = 'mt-4 text-center text-red-500 p-3 bg-red-100 rounded-md';
                }
            } else if (testimonialFormStatus) {
                testimonialFormStatus.textContent = translations[currentLanguage]?.testimonial_signin_error || "Error al procesar inicio de sesión con Google.";
                testimonialFormStatus.className = 'mt-4 text-center text-red-500';
            }
            loadTestimonials(); // Intentar cargar testimonios de todas formas
          });


        function updateAuthUI(user) {
            currentFirebaseUser = user;
            if (user) { 
                googleSignInBtn.classList.add('hidden');
                userInfoDiv.classList.remove('hidden');
                signOutBtn.classList.remove('hidden');
                testimonialAuthMessage.classList.add('hidden'); 
                testimonialForm.classList.remove('hidden'); 

                userDisplayNameSpan.textContent = user.displayName || 'Usuario de Google';
                testimonialNombreInput.value = user.displayName || '';
                testimonialNombreInput.readOnly = true;
                testimonialNombreInput.classList.add('bg-gray-100');
            } else { 
                googleSignInBtn.classList.remove('hidden');
                userInfoDiv.classList.add('hidden');
                signOutBtn.classList.add('hidden');
                testimonialAuthMessage.classList.remove('hidden'); 
                const authMsgP = testimonialAuthMessage.querySelector('p');
                if (authMsgP && translations[currentLanguage]) {
                    authMsgP.textContent = translations[currentLanguage].testimonial_login_to_submit || "Por favor, inicia sesión con Google para dejar una opinión.";
                }
                testimonialForm.classList.add('hidden'); 

                userDisplayNameSpan.textContent = '';
                testimonialNombreInput.value = ''; 
                testimonialNombreInput.readOnly = false;
                testimonialNombreInput.classList.remove('bg-gray-100');
            }
        }
        
        onAuthStateChanged(auth, (user) => {
            console.log("onAuthStateChanged disparado. Usuario:", user);
            updateAuthUI(user);
        });
        
        if (googleSignInBtn) {
            googleSignInBtn.addEventListener('click', () => {
                // Asegurarse de que la persistencia esté configurada antes de redirigir
                setPersistence(auth, browserSessionPersistence)
                .then(() => {
                    const provider = new GoogleAuthProvider();
                    return signInWithRedirect(auth, provider);
                })
                .catch((error) => {
                     console.error("Error al iniciar redirección con Google (posiblemente error de persistencia):", error);
                     if (testimonialFormStatus) {
                        testimonialFormStatus.textContent = translations[currentLanguage]?.testimonial_signin_error || "Error al iniciar sesión con Google. Revisa la configuración de tu navegador.";
                        testimonialFormStatus.className = 'mt-4 text-center text-red-500 p-3 bg-red-100 rounded-md';
                    }
                });
            });
        }

        if (signOutBtn) {
            signOutBtn.addEventListener('click', async () => {
                try {
                    await signOut(auth);
                } catch (error) {
                    console.error("Error al cerrar sesión:", error);
                }
            });
        }
        
        // ... (resto del código de testimonios: estrellas, envío de formulario, displayTestimonial, loadTestimonials)
        // ... (allServices, translations, setLanguage, etc.)
        // Asegúrate de que las definiciones de estas variables y funciones estén presentes.
        // El código de loadTestimonials y displayTestimonial, y la lógica de las estrellas
        // y el envío del formulario de testimonios se mantienen como en la versión anterior.
        // Solo se han modificado las partes de inicialización de Auth y manejo de UI de Auth.

        const testimonialRatingStars = document.querySelectorAll('#testimonialRating .fa-star');
        const ratingValueInput = document.getElementById('ratingValue');
        const testimonialLoadingSpinner = document.getElementById('testimonial-loading-spinner');
        const submitTestimonialButton = document.getElementById('submit-testimonial-form');

        let currentRating = 0;

        testimonialRatingStars.forEach(star => {
            star.addEventListener('click', () => {
                currentRating = parseInt(star.getAttribute('data-value'));
                ratingValueInput.value = currentRating;
                updateStarDisplay(currentRating);
            });
            star.addEventListener('mouseover', () => {
                const hoverValue = parseInt(star.getAttribute('data-value'));
                updateStarDisplay(hoverValue, true);
            });
            star.addEventListener('mouseout', () => {
                updateStarDisplay(currentRating);
            });
        });

        function updateStarDisplay(rating, isHover = false) {
            testimonialRatingStars.forEach(star => {
                const starValue = parseInt(star.getAttribute('data-value'));
                if (starValue <= rating) {
                    star.classList.add('selected', 'text-yellow-400');
                    star.classList.remove('text-gray-300'); 
                } else {
                    star.classList.remove('selected', 'text-yellow-400');
                    star.classList.add('text-gray-300');
                }
            });
        }
        
        if (testimonialForm) {
            testimonialForm.addEventListener('submit', async (e) => {
                e.preventDefault();
                if (!auth.currentUser) { 
                    if(testimonialFormStatus) testimonialFormStatus.textContent = translations[currentLanguage]?.testimonial_login_required_submit || "Debes iniciar sesión con Google para enviar una opinión.";
                    if(testimonialFormStatus) testimonialFormStatus.className = 'mt-4 text-center text-yellow-500';
                    return;
                }
                if (currentRating === 0) {
                     if(testimonialFormStatus) testimonialFormStatus.textContent = translations[currentLanguage]?.testimonial_form_rating_required || "Por favor, selecciona una puntuación.";
                     if(testimonialFormStatus) testimonialFormStatus.className = 'mt-4 text-center text-red-500';
                    return;
                }

                let nombre = testimonialNombreInput.value; 
                const mensaje = document.getElementById('testimonialMensaje').value;
                
                testimonialLoadingSpinner.classList.remove('hidden');
                submitTestimonialButton.disabled = true;
                if(testimonialFormStatus) testimonialFormStatus.textContent = '';

                try {
                    const testimonialsCollectionPath = `artifacts/${appId}/public/data/testimonials`;
                    await addDoc(collection(db, testimonialsCollectionPath), {
                        name: nombre,
                        rating: currentRating,
                        comment: mensaje,
                        createdAt: serverTimestamp(),
                        userId: auth.currentUser.uid, 
                        isGoogleUser: !auth.currentUser.isAnonymous, 
                        photoURL: auth.currentUser.photoURL || null 
                    });
                    if(testimonialFormStatus) testimonialFormStatus.textContent = translations[currentLanguage]?.testimonial_form_success || "¡Gracias por tu opinión!";
                    if(testimonialFormStatus) testimonialFormStatus.className = 'mt-4 text-center text-green-500';
                    
                    document.getElementById('testimonialMensaje').value = '';
                    currentRating = 0;
                    ratingValueInput.value = '';
                    updateStarDisplay(0);

                } catch (error) {
                    console.error("Error al guardar testimonio: ", error);
                    if(testimonialFormStatus) testimonialFormStatus.textContent = translations[currentLanguage]?.testimonial_form_error || "Error al enviar tu opinión. Inténtalo de nuevo.";
                    if(testimonialFormStatus) testimonialFormStatus.className = 'mt-4 text-center text-red-500';
                } finally {
                    testimonialLoadingSpinner.classList.add('hidden');
                    submitTestimonialButton.disabled = false;
                }
            });
        }

        function displayTestimonial(doc) {
            const data = doc.data();
            const card = document.createElement('div');
            card.className = 'testimonial-card bg-white p-6 rounded-xl shadow-lg border border-gray-200 flex flex-col';
            
            let starsHtml = '<div class="testimonial-stars text-yellow-400 mb-2 flex items-center">';
            for (let i = 1; i <= 5; i++) {
                starsHtml += `<i class="fas fa-star ${i <= data.rating ? '' : 'empty text-gray-300'}"></i>`;
            }
            starsHtml += '</div>';

            const date = data.createdAt?.toDate ? data.createdAt.toDate().toLocaleDateString(currentLanguage) : (translations[currentLanguage]?.date_unavailable || 'Fecha no disponible');

            card.innerHTML = `
                ${starsHtml}
                <p class="text-gray-600 italic mb-4 flex-grow">"${data.comment}"</p>
                <div class="mt-auto">
                    <p class="font-semibold text-navy text-right">- ${data.name}</p>
                    <p class="text-xs text-gray-400 text-right">${date}</p>
                </div>
            `;
            if(testimonialListDiv) testimonialListDiv.appendChild(card);
        }

        function loadTestimonials() {
            console.log("Intentando cargar testimonios (público)...");
            const testimonialsCollectionPath = `artifacts/${appId}/public/data/testimonials`;
            const q = query(collection(db, testimonialsCollectionPath), orderBy("createdAt", "desc"), limit(6)); 

            onSnapshot(q, (querySnapshot) => {
                if(testimonialListDiv) testimonialListDiv.innerHTML = ''; 
                if (querySnapshot.empty) {
                    if(noTestimonialsP && translations[currentLanguage]) {
                        noTestimonialsP.textContent = translations[currentLanguage].testimonials_empty;
                        noTestimonialsP.classList.remove('hidden');
                    }
                } else {
                    if(noTestimonialsP) noTestimonialsP.classList.add('hidden');
                    querySnapshot.forEach((doc) => {
                        displayTestimonial(doc);
                    });
                }
            }, (error) => {
                console.error("Error al cargar testimonios: ", error);
                 if(noTestimonialsP && translations[currentLanguage]) {
                    noTestimonialsP.textContent = translations[currentLanguage]?.testimonials_load_error || "Error al cargar testimonios.";
                    noTestimonialsP.classList.remove('hidden');
                    noTestimonialsP.classList.add('text-red-500');
                }
            });
        }
        
        const allServices = [
            { id: 'frigorificos', type: 'domestico', icon: 'fa-snowflake', title_key: 'service_fridge_title', desc_key: 'service_fridge_desc' },
            { id: 'aires_acondicionados', type: 'domestico industrial', icon: 'fa-wind', title_key: 'service_ac_title', desc_key: 'service_ac_desc' },
            { id: 'lavadoras', type: 'domestico', icon: 'fa-soap', title_key: 'service_washing_machine_title', desc_key: 'service_washing_machine_desc' },
            { id: 'lavavajillas', type: 'domestico', icon: 'fa-glass-water-droplet', title_key: 'service_dishwasher_title', desc_key: 'service_dishwasher_desc' },
            { id: 'hornos', type: 'domestico', icon: 'fa-temperature-high', title_key: 'service_oven_title', desc_key: 'service_oven_desc' },
            { id: 'secadoras', type: 'domestico', icon: 'fa-shirt', title_key: 'service_dryer_title', desc_key: 'service_dryer_desc' },
            { id: 'vitroceramicas', type: 'domestico', icon: 'fa-fire-burner', title_key: 'service_cooktop_title', desc_key: 'service_cooktop_desc' },
            { id: 'calentadores_agua', type: 'domestico', icon: 'fa-tint', title_key: 'service_water_heater_title', desc_key: 'service_water_heater_desc' },
            { id: 'calderas', type: 'domestico', icon: 'fa-fire', title_key: 'service_boiler_title', desc_key: 'service_boiler_desc' },
            { id: 'termotanques', type: 'domestico', icon: 'fa-water', title_key: 'service_thermotank_title', desc_key: 'service_thermotank_desc' },
            { id: 'lavanderia_industrial', type: 'industrial', icon: 'fa-industry', title_key: 'service_industrial_laundry_title', desc_key: 'service_industrial_laundry_desc' },
            { id: 'refrigeracion_industrial', type: 'industrial', icon: 'fa-temperature-arrow-down', title_key: 'service_industrial_fridge_title', desc_key: 'service_industrial_fridge_desc' },
            { id: 'calderas_industriales', type: 'industrial', icon: 'fa-dumpster-fire', title_key: 'service_industrial_boiler_title', desc_key: 'service_industrial_boiler_desc' },
        ];

        const translations = {
            es: {
                company_name_header: "ERB Servicio Técnico",
                nav_home: "Inicio", nav_services: "Servicios", nav_benefits: "Beneficios", nav_brands: "Marcas", nav_about: "Sobre Nosotros", nav_testimonials: "Testimonios", nav_contact: "Contacto",
                nav_home_mobile: "Inicio", nav_services_mobile: "Servicios", nav_benefits_mobile: "Beneficios", nav_brands_mobile: "Marcas", nav_about_mobile: "Sobre Nosotros", nav_testimonials_mobile: "Testimonios", nav_contact_mobile: "Contacto",
                hero_h1: "Reparación de Electrodomésticos: ERB Servicio Técnico",
                hero_subtitle: "Especialistas en reparación y mantenimiento de electrodomésticos de gama blanca, industrial e instalación de aires acondicionados.",
                hero_cta: "Solicita Presupuesto",
                services_title: "Nuestros Servicios",
                services_intro: "Soluciones expertas para todo tipo de electrodomésticos y climatización.",
                filter_all: "Todos", filter_domestic: "Doméstico", filter_industrial: "Industrial",
                service_fridge_title: "Reparación de Frigoríficos y Congeladores", service_fridge_desc: "Soluciones para problemas de enfriamiento, fugas y más en tus equipos de refrigeración domésticos.",
                service_ac_title: "Instalación y Reparación de Aires Acondicionados", service_ac_desc: "Servicio completo para sistemas de climatización domésticos e industriales, garantizando confort.",
                service_washing_machine_title: "Reparación de Lavadoras", service_washing_machine_desc: "Arreglamos problemas de centrifugado, desagüe, y cualquier avería en tu lavadora.",
                service_dishwasher_title: "Reparación de Lavavajillas", service_dishwasher_desc: "Solucionamos fallos de limpieza, fugas o problemas eléctricos en tu lavavajillas.",
                service_oven_title: "Reparación de Hornos", service_oven_desc: "Reparamos hornos que no calientan, problemas con el termostato o fallos electrónicos.",
                service_dryer_title: "Reparación de Secadoras", service_dryer_desc: "Soluciones para secadoras que no secan, hacen ruido o no encienden.",
                service_cooktop_title: "Reparación de Vitrocerámicas", service_cooktop_desc: "Reparamos vitrocerámicas de inducción, eléctricas, con problemas en los fogones o controles.",
                service_water_heater_title: "Reparación de Calentadores de Agua", service_water_heater_desc: "Servicio técnico para calentadores de gas o eléctricos, problemas de encendido o fugas.",
                service_boiler_title: "Reparación de Calderas", service_boiler_desc: "Especialistas en calderas de gas o gasoil, solucionamos averías y realizamos mantenimiento.",
                service_thermotank_title: "Reparación de Termotanques", service_thermotank_desc: "Reparación y mantenimiento de termotanques eléctricos, problemas de temperatura o pérdidas.",
                service_industrial_laundry_title: "Reparación de Maquinaria de Lavandería Industrial", service_industrial_laundry_desc: "Servicio técnico para lavadoras, secadoras y planchadoras industriales.",
                service_industrial_fridge_title: "Reparación de Equipos de Refrigeración Industrial", service_industrial_fridge_desc: "Mantenimiento y reparación de cámaras frigoríficas, congeladores y vitrinas industriales.",
                service_industrial_boiler_title: "Reparación de Calderas Industriales", service_industrial_boiler_desc: "Soluciones para calderas de vapor, agua caliente y otros sistemas industrials.",
                benefits_title: "Por Qué Elegirnos",
                benefit1_title: "Atención Inmediata", benefit1_desc: "Solicita tu inspección llamando a nuestros canales de atención al cliente.",
                benefit2_title: "Sin Coste de Desplazamiento", benefit2_desc: "Reparación en el acto si decides reparar, no cobramos el desplazamiento.",
                benefit3_title: "Garantía de 6 Meses", benefit3_desc: "Disfruta de tu electrodoméstico como nuevo con garantía en la reparación de 6 meses.",
                benefit4_title: "Precios Competitivos", benefit4_desc: "Precios competitivos en todas las reparaciones de electrodomésticos.",
                brands_title: "Trabajamos con las Mejores Marcas",
                about_title: "Sobre Nosotros",
                about_text_p1: "Somos un equipo de técnicos especializados con años de experiencia en la reparación y mantenimiento de electrodomésticos de gama blanca, tanto domésticos como industriales, así como en la instalación de aires acondicionados.",
                about_text_p2: "Nuestro compromiso es ofrecer un servicio rápido, eficiente y con garantía, asegurando la máxima satisfacción de nuestros clientes en Barcelona, Coruña, Valencia y Castellón de la Plana.",
                about_text_p3: "Confía en nosotros para devolverle la vida a tus electrodomésticos.",
                testimonials_title: "Opiniones de Nuestros Clientes",
                testimonial_form_title: "Deja tu Opinión",
                testimonial_form_name: "Tu Nombre",
                testimonial_form_rating: "Tu Puntuación",
                testimonial_form_rating_required: "Por favor, selecciona una puntuación.",
                testimonial_form_message: "Tu Comentario",
                testimonial_form_submit: "Enviar Opinión",
                testimonial_form_success: "¡Gracias por tu opinión! Ha sido enviada.",
                testimonial_form_error: "Error al enviar tu opinión. Inténtalo de nuevo.",
                testimonial_signin_google: "Iniciar sesión con Google para opinar",
                testimonial_sign_out: "Cerrar Sesión",
                testimonial_logged_in_as: "Conectado como:",
                testimonial_signin_error: "Error al iniciar sesión con Google.",
                testimonial_login_to_submit: "Por favor, inicia sesión con Google para dejar una opinión.",
                testimonial_storage_error: "El inicio de sesión no pudo completarse. Es posible que la configuración de privacidad de tu navegador (prevención de rastreo o bloqueo de cookies de terceros) esté interfiriendo. Por favor, ajusta la configuración para este sitio e inténtalo de nuevo.",
                testimonials_empty: "Aún no hay testimonios. ¡Sé el primero en dejar tu opinión iniciando sesión!",
                testimonials_load_error: "Error al cargar testimonios.",
                date_unavailable: "Fecha no disponible",
                contact_title: "Contacta con Nosotros",
                contact_form_title: "Envíanos un Mensaje",
                form_name: "Nombre", form_phone: "Teléfono", form_location: "Ubicación del servicio", form_appliance: "Electrodoméstico a reparar o servicio", form_message: "Descripción del problema", form_submit: "Enviar Mensaje",
                loc_barcelona: "Barcelona", loc_coruna: "La Coruña", loc_valencia: "Valencia", loc_castellon: "Castellón de la Plana",
                contact_info_title: "Otras Formas de Contacto",
                contact_phone_text: "+34 612 548 508", contact_email_text: "serviciotecnico.erb@gmail.com", contact_whatsapp_text: "Chatea con nosotros en WhatsApp",
                contact_areas: "Servicio en: Barcelona, Coruña, Valencia y Castellón de la Plana", contact_map_title: "Nuestra Área de Cobertura",
                footer_copyright: "© 2025 ERB Servicio Técnico de Electrodomésticos | BARCELONA – CORUÑA – VALENCIA – CASTELLÓN de la Plana",
                footer_privacy: "Política de Privacidad", footer_legal: "Aviso Legal", footer_cookies: "Política de Cookies",
                form_sending: "Enviando...", 
                form_success: "¡Mensaje enviado con éxito! En breve nos contactaremos.", 
                form_error: "Error al enviar el mensaje. Por favor, inténtalo de nuevo más tarde.",
                form_success_modal_title: "¡Enviado con Éxito!",
                form_success_modal_text: "Gracias por tu mensaje. En breve nos pondremos en contacto contigo.",
                form_success_modal_close: "Cerrar",
                cookie_banner_text: "Este sitio web utiliza cookies para asegurar la mejor experiencia. Al continuar navegando, aceptas su uso, incluidas cookies para Google Analytics y Google Ads. Consulta nuestra",
                cookie_banner_policy_link: "política de cookies",
                cookie_banner_accept: "Aceptar",
                map_error_title: "Error al cargar el mapa:",
                map_error_text: "El mapa no se puede mostrar en este momento. Si eres el administrador del sitio, asegúrate de que la URL actual esté autorizada en la configuración de la clave API de Google Maps en Google Cloud Console.",
                map_error_url_is: "URL actual para autorizar:",
            },
            ca: { 
                company_name_header: "ERB Servei Tècnic",
                nav_home: "Inici", nav_services: "Serveis", nav_benefits: "Beneficis", nav_brands: "Marques", nav_about: "Sobre Nosaltres", nav_testimonials: "Testimonis", nav_contact: "Contacte",
                nav_home_mobile: "Inici", nav_services_mobile: "Serveis", nav_benefits_mobile: "Beneficis", nav_brands_mobile: "Marques", nav_about_mobile: "Sobre Nosaltres", nav_testimonials_mobile: "Testimonis", nav_contact_mobile: "Contacte",
                hero_h1: "Reparació d'Electrodomèstics: ERB Servei Tècnic",
                hero_subtitle: "Especialistes en reparació i manteniment d'electrodomèstics de gamma blanca, industrial i instal·lació d'aires condicionats.",
                hero_cta: "Sol·licita Pressupost",
                services_title: "Els Nostres Serveis",
                services_intro: "Solucions expertes per a tota mena d'electrodomèstics i climatització.",
                filter_all: "Tots", filter_domestic: "Domèstic", filter_industrial: "Industrial",
                service_fridge_title: "Reparació de Frigorífics i Congeladors", service_fridge_desc: "Solucions per a problemes de refredament, fuites i més en els teus equips de refrigeració domèstics.",
                service_ac_title: "Instal·lació i Reparació d'Aires Condicionats", service_ac_desc: "Servei complet per a sistemes de climatització domèstics i industrials, garantint confort.",
                service_washing_machine_title: "Reparació de Rentadores", service_washing_machine_desc: "Arreglem problemes de centrifugat, desguàs, i qualsevol avaria a la teva rentadora.",
                service_dishwasher_title: "Reparació de Rentavaixelles", service_dishwasher_desc: "Solucionem errades de neteja, fuites o problemes elèctrics al teu rentavaixelles.",
                service_oven_title: "Reparació de Forns", service_oven_desc: "Reparem forns que no escalfen, problemes con el termòstat o errades electròniques.",
                service_dryer_title: "Reparació d'Assecadores", service_dryer_desc: "Solucions per a assecadores que no assequen, fan soroll o no s'engeguen.",
                service_cooktop_title: "Reparació de Vitroceràmiques", service_cooktop_desc: "Reparem vitroceràmiques d'inducció, elèctriques, amb problemes als fogons o controls.",
                service_water_heater_title: "Reparació d'Escalfadors d'Aigua", service_water_heater_desc: "Servei tècnic per a escalfadors de gas o elèctrics, problemes d'encesa o fuites.",
                service_boiler_title: "Reparació de Calderes", service_boiler_desc: "Especialistes en calderes de gas o gasoil, solucionem avaries i realitzem manteniment.",
                service_thermotank_title: "Reparació de Termos Elèctrics", service_thermotank_desc: "Reparació i manteniment de termos elèctrics, problemes de temperatura o pèrdues.",
                service_industrial_laundry_title: "Reparació de Maquinària de Bugaderia Industrial", service_industrial_laundry_desc: "Servei tècnic per a rentadores, assecadores i planxadores industrials.",
                service_industrial_fridge_title: "Reparació d'Equips de Refrigeració Industrial", service_industrial_fridge_desc: "Manteniment i reparació de cambres frigorífiques, congeladors i vitrines industrials.",
                service_industrial_boiler_title: "Reparació de Calderes Industrials", service_industrial_boiler_desc: "Solucions per a calderes de vapor, aigua calenta i altres sistemes industrials.",
                benefits_title: "Per Què Triar-nos",
                benefit1_title: "Atenció Immediata", benefit1_desc: "Sol·licita la teva inspecció trucant als nostres canals d'atenció al client.",
                benefit2_title: "Sense Cost de Desplaçament", benefit2_desc: "Reparació a l'acte si decideixes reparar, no cobrem el desplaçament.",
                benefit3_title: "Garantia de 6 Mesos", benefit3_desc: "Gaudeix del teu electrodomèstic com nou amb garantia en la reparació de 6 mesos.",
                benefit4_title: "Preus Competitius", benefit4_desc: "Preus competitius en totes les reparacions d'electrodomèstics.",
                brands_title: "Treballem amb les Millors Marques",
                about_title: "Sobre Nosaltres",
                about_text_p1: "Som un equip de tècnics especialitzats amb anys d'experiència en la reparació i manteniment d'electrodomèstics de gamma blanca, tant domèstics com industrials, així com en la instal·lació d'aires condicionats.",
                about_text_p2: "El nostre compromís és oferir un servei ràpid, eficient i amb garantia, assegurant la màxima satisfacció dels nostres clients a Barcelona, Corunya, València i Castelló de la Plana.",
                about_text_p3: "Confia en nosaltres per tornar-li la vida als teus electrodomèstics.",
                testimonials_title: "Opinions dels Nostres Clients",
                testimonial_form_title: "Deixa la Teva Opinió",
                testimonial_form_name: "El Teu Nom",
                testimonial_form_rating: "La Teva Puntuació",
                testimonial_form_rating_required: "Si us plau, selecciona una puntuació.",
                testimonial_form_message: "El Teu Comentari",
                testimonial_form_submit: "Enviar Opinió",
                testimonial_form_success: "Gràcies per la teva opinió! S'ha enviat correctament.",
                testimonial_form_error: "Error en enviar la teva opinió. Intenta-ho de nou.",
                testimonial_signin_google: "Iniciar sessió amb Google per opinar",
                testimonial_sign_out: "Tancar Sessió",
                testimonial_logged_in_as: "Connectat com:",
                testimonial_signin_error: "Error en iniciar sessió amb Google.",
                testimonial_login_to_submit: "Si us plau, inicia sessió amb Google per deixar una opinió.",
                testimonial_storage_error: "L'inici de sessió no s'ha pogut completar. És possible que la configuració de privadesa del teu navegador (prevenció de rastreig o bloqueig de galetes de tercers) estigui interferint. Si us plau, ajusta la configuració per a aquest lloc i torna-ho a provar.",
                testimonials_empty: "Encara no hi ha testimonis. Sigues el primer a deixar la teva opinió iniciant sessió!",
                testimonials_load_error: "Error en carregar els testimonis.",
                date_unavailable: "Data no disponible",
                contact_title: "Contacta amb Nosaltres",
                contact_form_title: "Envia'ns un Missatge",
                form_name: "Nom", form_phone: "Telèfon", form_location: "Ubicació del servei", form_appliance: "Electrodomèstic a reparar o servei", form_message: "Descripció del problema", form_submit: "Enviar Missatge",
                loc_barcelona: "Barcelona", loc_coruna: "La Corunya", loc_valencia: "València", loc_castellon: "Castelló de la Plana",
                contact_info_title: "Altres Formes de Contacte",
                contact_phone_text: "+34 612 548 508", contact_email_text: "serviciotecnico.erb@gmail.com", contact_whatsapp_text: "Xateja amb nosaltres a WhatsApp",
                contact_areas: "Servei a: Barcelona, Corunya, València i Castelló de la Plana", contact_map_title: "Les Nostres Àrees de Servei",
                footer_copyright: "© 2025 ERB Servei Tècnic d'Electrodomèstics | BARCELONA – CORUNYA – VALÈNCIA – CASTELLÓ de la Plana",
                footer_privacy: "Política de Privacitat", footer_legal: "Avís Legal", footer_cookies: "Política de Galetes",
                form_sending: "Enviant...", 
                form_success: "Missatge enviat amb èxit! Aviat ens posarem en contacte.",
                form_error: "Error en l'enviament del missatge. Si us plau, intenta-ho de nou més tard.",
                form_success_modal_title: "Enviat amb Èxit!",
                form_success_modal_text: "Gràcies pel teu missatge. Aviat ens posarem en contacte amb tu.",
                form_success_modal_close: "Tancar",
                cookie_banner_text: "Aquest lloc web utilitza galetes per assegurar la millor experiència. En continuar navegant, n'acceptes l'ús, incloses galetes per a Google Analytics i Google Ads. Consulta la nostra",
                cookie_banner_policy_link: "política de galetes",
                cookie_banner_accept: "Acceptar",
                map_error_title: "Error en carregar el mapa:",
                map_error_text: "El mapa no es pot mostrar en aquest moment. Si ets l'administrador del lloc, assegura't que la URL actual estigui autoritzada a la configuració de la clau API de Google Maps a Google Cloud Console.",
                map_error_url_is: "URL actual per autoritzar:",
            },
            va: { 
                company_name_header: "ERB Servei Tècnic",
                nav_home: "Inici", nav_services: "Serveis", nav_benefits: "Beneficis", nav_brands: "Marques", nav_about: "Sobre Nosaltres", nav_testimonials: "Testimonis", nav_contact: "Contacte",
                nav_home_mobile: "Inici", nav_services_mobile: "Serveis", nav_benefits_mobile: "Beneficis", nav_brands_mobile: "Marques", nav_about_mobile: "Sobre Nosaltres", nav_testimonials_mobile: "Testimonis", nav_contact_mobile: "Contacte",
                hero_h1: "Reparació d'Electrodomèstics: ERB Servei Tècnic",
                hero_subtitle: "Especialistes en reparació i manteniment d'aparells electrodomèstics de gamma blanca, industrial i instal·lació d'aires condicionats.",
                hero_cta: "Sol·licita Pressupost",
                services_title: "Els Nostres Serveis",
                services_intro: "Solucions expertes per a tota classe d'aparells electrodomèstics i climatització.",
                filter_all: "Tots", filter_domestic: "Domèstic", filter_industrial: "Industrial",
                service_fridge_title: "Reparació de Frigorífics i Congeladors", service_fridge_desc: "Solucions per a problemes de refredament, fugues i més en els teus equips de refrigeració domèstics.",
                service_ac_title: "Instal·lació i Reparació d'Aires Condicionats", service_ac_desc: "Servei complet per a sistemes de climatització domèstics i industrials, garantint confort.",
                service_washing_machine_title: "Reparació de Rentadores", service_washing_machine_desc: "Arreglem problemes de centrifugat, desguàs, i qualsevol avaria a la teua rentadora.",
                service_dishwasher_title: "Reparació de Rentaplats", service_dishwasher_desc: "Solucionem errades de neteja, fugues o problemes elèctrics al teu rentaplats.",
                service_oven_title: "Reparació de Forns", service_oven_desc: "Reparem forns que no calfen, problemes con el termòstat o errades electròniques.",
                service_dryer_title: "Reparació d'Eixugadores", service_dryer_desc: "Solucions per a eixugadores que no eixuguen, fan soroll o no s'encenen.",
                service_cooktop_title: "Reparació de Vitroceràmiques", service_cooktop_desc: "Reparem vitroceràmiques d'inducció, elèctriques, amb problemes als fogons o controls.",
                service_water_heater_title: "Reparació de Calentadors d'Aigua", service_water_heater_desc: "Servei tècnic per a calentadors de gas o elèctrics, problemes d'encesa o fugues.",
                service_boiler_title: "Reparació de Calderes", service_boiler_desc: "Especialistes en calderes de gas o gasoil, solucionem avaries i realitzem manteniment.",
                service_thermotank_title: "Reparació de Termos Elèctrics", service_thermotank_desc: "Reparació i manteniment de termos elèctrics, problemes de temperatura o pèrdues.",
                service_industrial_laundry_title: "Reparació de Maquinària de Bugaderia Industrial", service_industrial_laundry_desc: "Servei tècnic per a rentadores, eixugadores i planxadores industrials.",
                service_industrial_fridge_title: "Reparació d'Equips de Refrigeració Industrial", service_industrial_fridge_desc: "Manteniment i reparació de cambres frigorífiques, congeladors i vitrines industrials.",
                service_industrial_boiler_title: "Reparació de Calderes Industrials", service_industrial_boiler_desc: "Solucions per a calderes de vapor, aigua calenta i altres sistemes industrials.",
                benefits_title: "Per Què Triar-nos",
                benefit1_title: "Atenció Immediata", benefit1_desc: "Sol·licita la teua inspecció telefonant als nostres canals d'atenció al client.",
                benefit2_title: "Sense Cost de Desplaçament", benefit2_desc: "Reparació a l'acte si decideixes reparar, no cobrem el desplaçament.",
                benefit3_title: "Garantia de 6 Mesos", benefit3_desc: "Gaudeix del teu aparell electrodomèstic com nou con garantia en la reparació de 6 mesos.",
                benefit4_title: "Preus Competitius", benefit4_desc: "Preus competitius en totes les reparacions d'aparells electrodomèstics.",
                brands_title: "Treballem amb les Millors Marques",
                about_title: "Sobre Nosaltres",
                about_text_p1: "Som un equip de tècnics especialitzats amb anys d'experiència en la reparació i manteniment d'aparells electrodomèstics de gamma blanca, tant domèstics com industrials, així com en la instal·lació d'aires condicionats.",
                about_text_p2: "El nostre compromís és oferir un servei ràpid, eficient i amb garantia, assegurant la màxima satisfacció dels nostres clients a Barcelona, Corunya, València i Castelló de la Plana.",
                about_text_p3: "Confia en nosaltres per tornar-li la vida als teus aparells electrodomèstics.",
                testimonials_title: "Opinions dels Nostres Clients",
                testimonial_form_title: "Deixa la Teua Opinió",
                testimonial_form_name: "El Teu Nom",
                testimonial_form_rating: "La Teua Puntuació",
                testimonial_form_rating_required: "Per favor, selecciona una puntuació.",
                testimonial_form_message: "El Teu Comentari",
                testimonial_form_submit: "Enviar Opinió",
                testimonial_form_success: "Gràcies per la teua opinió! S'ha enviat correctament.",
                testimonial_form_error: "Error en enviar la teua opinió. Intenta-ho de nou.",
                testimonial_signin_google: "Iniciar sessió amb Google per opinar",
                testimonial_sign_out: "Tancar Sessió",
                testimonial_logged_in_as: "Connectat com:",
                testimonial_signin_error: "Error en iniciar sessió con Google.",
                testimonial_login_to_submit: "Per favor, inicia sessió amb Google per deixar una opinió.",
                testimonial_storage_error: "L'inici de sessió no s'ha pogut completar. És possible que la configuració de privadesa del teu navegador (prevenció de rastreig o bloqueig de galetes de tercers) estiga interferint. Per favor, ajusta la configuració per a este lloc i torna-ho a provar.",
                testimonials_empty: "Encara no hi ha testimonis. Sigues el primer a deixar la teua opinió iniciant sessió!",
                testimonials_load_error: "Error en carregar els testimonis.",
                date_unavailable: "Data no disponible",
                contact_title: "Contacta amb Nosaltres",
                contact_form_title: "Envia'ns un Missatge",
                form_name: "Nom", form_phone: "Telèfon", form_location: "Ubicació del servei", form_appliance: "Aparell electrodomèstic a reparar o servei", form_message: "Descripció del problema", form_submit: "Enviar Missatge",
                loc_barcelona: "Barcelona", loc_coruna: "La Corunya", loc_valencia: "València", loc_castellon: "Castelló de la Plana",
                contact_info_title: "Altres Formes de Contacte",
                contact_phone_text: "+34 612 548 508", contact_email_text: "serviciotecnico.erb@gmail.com", contact_whatsapp_text: "Xateja amb nosaltres a WhatsApp",
                contact_areas: "Servei a: Barcelona, Corunya, València i Castelló de la Plana", contact_map_title: "La Nostra Àrea de Cobertura",
                footer_copyright: "© 2025 ERB Servei Tècnic d'Electrodomèstics | BARCELONA – CORUNYA – VALÈNCIA – CASTELLÓ de la Plana",
                footer_privacy: "Política de Privacitat", footer_legal: "Avís Legal", footer_cookies: "Política de Galetes",
                form_sending: "Enviant...", 
                form_success: "Missatge enviat amb èxit! En breu ens posarem en contacte.",
                form_error: "Error en l'enviament del missatge. Per favor, intenta-ho de nou més tard.",
                form_success_modal_title: "Enviat amb Èxit!",
                form_success_modal_text: "Gràcies pel teu missatge. En breu ens posarem en contacte con tu.",
                form_success_modal_close: "Tancar",
                cookie_banner_text: "Este lloc web utilitza galetes per a assegurar la millor experiència. En continuar navegant, n'acceptes l'ús, incloses galetes per a Google Analytics i Google Ads. Consulta la nostra",
                cookie_banner_policy_link: "política de galetes",
                cookie_banner_accept: "Acceptar",
                map_error_title: "Error en carregar el mapa:",
                map_error_text: "El mapa no es pot mostrar en este moment. Si eres l'administrador del lloc, assegura't que la URL actual estiga autoritzada en la configuració de la clau API de Google Maps en Google Cloud Console.",
                map_error_url_is: "URL actual per autoritzar:",
            }
        };

        let currentLanguage = 'es';
        window.translations = translations;
        window.currentLanguage = currentLanguage;


        function setLanguage(lang) {
            currentLanguage = lang; 
            window.currentLanguage = lang; 
            document.documentElement.lang = lang;
            document.body.className = document.body.className.replace(/lang-(es|ca|va)/g, '');
            document.body.classList.add('lang-' + lang);

            document.querySelectorAll('[data-lang]').forEach(element => {
                const key = element.getAttribute('data-lang');
                if (translations[lang] && translations[lang][key]) {
                    element.innerHTML = translations[lang][key];
                } else if (translations.es[key]) { 
                    element.innerHTML = translations.es[key];
                }
            });
            
            const currentLangText = document.getElementById('current-lang-text');
            if(currentLangText) currentLangText.textContent = lang.toUpperCase();
            
            localStorage.setItem('preferredLanguage', lang);
            
            const langDropdown = document.getElementById('language-dropdown');
            if (langDropdown) langDropdown.classList.add('hidden');


            const privacyLink = document.getElementById('privacyLink');
            const legalLink = document.getElementById('legalLink');
            const cookiesLink = document.getElementById('cookiesLink');
            const cookieBannerPolicyLink = document.getElementById('cookieBannerPolicyLink');


            if (lang === 'ca') {
                if (privacyLink) privacyLink.href = '/ca/politica-privacitat.html';
                if (legalLink) legalLink.href = '/ca/avis-legal.html';
                if (cookiesLink) cookiesLink.href = '/ca/politica-galetes.html';
                if (cookieBannerPolicyLink) cookieBannerPolicyLink.href = '/ca/politica-galetes.html';
            } else if (lang === 'va') {
                if (privacyLink) privacyLink.href = '/va/politica-privacitat.html';
                if (legalLink) legalLink.href = '/va/avis-legal.html';
                if (cookiesLink) cookiesLink.href = '/va/politica-galetes.html';
                if (cookieBannerPolicyLink) cookieBannerPolicyLink.href = '/va/politica-galetes.html';
            } else { 
                if (privacyLink) privacyLink.href = '/politica-privacidad.html';
                if (legalLink) legalLink.href = '/aviso-legal.html';
                if (cookiesLink) cookiesLink.href = '/politica-cookies.html';
                if (cookieBannerPolicyLink) cookieBannerPolicyLink.href = '/politica-cookies.html';
            }
            populateApplianceSelect(lang);
            const authMsgP = testimonialAuthMessage.querySelector('p');
             if (authMsgP && translations[currentLanguage] && !auth.currentUser) { 
                 authMsgP.textContent = translations[currentLanguage].testimonial_login_to_submit || "Por favor, inicia sesión con Google para dejar una opinión.";
             }
        }
        
        function populateServiceCards(lang) {
            const serviceListContainer = document.getElementById('service-list');
            if (!serviceListContainer) return;
            serviceListContainer.innerHTML = ''; 
            const currentTranslations = translations[lang] || translations.es;

            allServices.forEach(service => {
                const card = document.createElement('div');
                card.className = 'service-card bg-white p-6 rounded-xl shadow-lg border border-gray-200';
                card.setAttribute('data-type', service.type); 

                const iconHtml = `<div class="text-center mb-4"><i class="fas ${service.icon} text-4xl text-navy"></i></div>`;
                const titleHtml = `<h3 class="text-xl font-semibold text-navy mb-3 text-center">${currentTranslations[service.title_key] || service.title_key}</h3>`;
                const descHtml = `<p class="text-gray-600 text-sm mb-3">${currentTranslations[service.desc_key] || service.desc_key}</p>`;
                
                card.innerHTML = iconHtml + titleHtml + descHtml;
                serviceListContainer.appendChild(card);
            });
        }

        function populateApplianceSelect(lang) {
            const applianceSelect = document.getElementById('equipo');
            if (!applianceSelect) return;
            applianceSelect.innerHTML = ''; 
            const currentTranslations = translations[lang] || translations.es;

            allServices.forEach(service => {
                const option = document.createElement('option');
                option.value = service.id;
                option.textContent = currentTranslations[service.title_key] || service.title_key.replace('service_', '').replace('_title', '').replace(/_/g, ' ');
                applianceSelect.appendChild(option);
            });
        }

        function filterServices(filter) {
            const serviceCards = document.querySelectorAll('#service-list .service-card');
            serviceCards.forEach(card => {
                const cardType = card.getAttribute('data-type');
                if (filter === 'all' || cardType.includes(filter)) {
                    card.classList.remove('service-hidden');
                } else {
                    card.classList.add('service-hidden');
                }
            });

            document.querySelectorAll('.filter-btn').forEach(btn => {
                btn.classList.remove('active');
                if (btn.getAttribute('data-filter') === filter) {
                    btn.classList.add('active');
                }
            });
        }

        function handleCookieBanner() {
            const banner = document.getElementById('cookie-banner');
            const acceptBtn = document.getElementById('accept-cookies-btn');

            if (!banner || !acceptBtn) return;

            const cookiesAccepted = localStorage.getItem('erbCookiesAccepted');

            if (!cookiesAccepted) {
                banner.style.display = 'flex';
            }

            acceptBtn.addEventListener('click', () => {
                localStorage.setItem('erbCookiesAccepted', 'true');
                banner.style.display = 'none';
            });
        }


        document.addEventListener('DOMContentLoaded', () => {
            const langButton = document.getElementById('language-selector-btn');
            const langDropdown = document.getElementById('language-dropdown');
            
            if (langButton && langDropdown) {
                langButton.addEventListener('click', () => {
                    langDropdown.classList.toggle('hidden');
                });

                document.addEventListener('click', (event) => {
                    if (langButton && !langButton.contains(event.target) && langDropdown && !langDropdown.contains(event.target)) {
                        langDropdown.classList.add('hidden');
                    }
                });
            }


            document.querySelectorAll('#language-dropdown a').forEach(link => {
                link.addEventListener('click', (e) => {
                    e.preventDefault();
                    const lang = e.target.getAttribute('data-lang-option');
                    setLanguage(lang);
                    populateServiceCards(lang); 
                });
            });
            
            const preferredLanguage = localStorage.getItem('preferredLanguage') || 'es';
            setLanguage(preferredLanguage); 
            populateServiceCards(preferredLanguage); 
            populateApplianceSelect(preferredLanguage); 

            document.querySelectorAll('.filter-btn').forEach(button => {
                button.addEventListener('click', () => {
                    const filter = button.getAttribute('data-filter');
                    filterServices(filter);
                });
            });
            filterServices('all'); 


            document.querySelectorAll('a[href^="#"]').forEach(anchor => {
                anchor.addEventListener('click', function (e) {
                    e.preventDefault();
                    const targetId = this.getAttribute('href');
                    try {
                        const targetElement = document.querySelector(targetId);
                        if (targetElement) {
                            targetElement.scrollIntoView({ behavior: 'smooth' });
                        }
                    } catch(error) {
                        console.warn("Error scrolling to anchor:", targetId, error);
                    }
                    const mobileMenu = document.getElementById('mobile-menu');
                    if (mobileMenu && mobileMenu.classList.contains('open')) {
                        mobileMenu.classList.remove('open');
                    }
                });
            });

            const mobileMenuButton = document.getElementById('mobile-menu-button');
            const closeMobileMenuButton = document.getElementById('close-mobile-menu-button');
            const mobileMenu = document.getElementById('mobile-menu');

            if (mobileMenuButton && mobileMenu) {
                mobileMenuButton.addEventListener('click', () => { mobileMenu.classList.add('open'); });
            }
            if (closeMobileMenuButton && mobileMenu) {
                closeMobileMenuButton.addEventListener('click', () => { mobileMenu.classList.remove('open'); });
            }
            

            handleCookieBanner();

            const contactForm = document.getElementById('contactForm');
            const loadingSpinner = document.getElementById('loading-spinner');
            const successModal = document.getElementById('success-message-modal');
            const closeSuccessModalBtn = document.getElementById('close-success-modal-btn');
            const formStatusDiv = document.getElementById('form-status');
            const submitButton = document.getElementById('submit-contact-form');

            if (contactForm && loadingSpinner && successModal && closeSuccessModalBtn && formStatusDiv && submitButton) {
                contactForm.addEventListener('submit', function(event) {
                    event.preventDefault(); 

                    loadingSpinner.classList.remove('hidden');
                    submitButton.disabled = true;
                    submitButton.classList.add('opacity-50', 'cursor-not-allowed');
                    formStatusDiv.textContent = ''; 

                    const formData = new FormData(contactForm);
                    const formAction = contactForm.getAttribute('action');

                    fetch(formAction, {
                        method: 'POST',
                        body: formData,
                        headers: {
                            'Accept': 'application/json'
                        }
                    })
                    .then(response => response.json())
                    .then(data => {
                        loadingSpinner.classList.add('hidden');
                        submitButton.disabled = false;
                        submitButton.classList.remove('opacity-50', 'cursor-not-allowed');

                        if (data.success || (data.ok && data.ok === true) ) { 
                            contactForm.reset(); 
                            const modalTitle = successModal.querySelector('[data-lang="form_success_modal_title"]');
                            const modalText = successModal.querySelector('[data-lang="form_success_modal_text"]');
                            const modalCloseBtn = successModal.querySelector('[data-lang="form_success_modal_close"]');

                            if (translations[currentLanguage] && translations[currentLanguage]['form_success_modal_title']) {
                                modalTitle.textContent = translations[currentLanguage]['form_success_modal_title'];
                                modalText.textContent = translations[currentLanguage]['form_success_modal_text'];
                                modalCloseBtn.textContent = translations[currentLanguage]['form_success_modal_close'];
                            } else { 
                                modalTitle.textContent = translations.es['form_success_modal_title'];
                                modalText.textContent = translations.es['form_success_modal_text'];
                                modalCloseBtn.textContent = translations.es['form_success_modal_close'];
                            }
                            successModal.classList.remove('hidden');
                        } else {
                            formStatusDiv.textContent = translations[currentLanguage]?.form_error || translations.es.form_error;
                            formStatusDiv.classList.remove('text-green-400'); 
                            formStatusDiv.classList.add('text-red-400');
                            console.error('Formsubmit.co reportó un error o formato de respuesta inesperado:', data);
                        }
                    })
                    .catch(error => {
                        loadingSpinner.classList.add('hidden');
                        submitButton.disabled = false;
                        submitButton.classList.remove('opacity-50', 'cursor-not-allowed');
                        formStatusDiv.textContent = translations[currentLanguage]?.form_error || translations.es.form_error;
                        formStatusDiv.classList.remove('text-green-400');
                        formStatusDiv.classList.add('text-red-400');
                        console.error('Error al enviar el formulario:', error);
                    });
                });
                
                if(closeSuccessModalBtn) {
                    closeSuccessModalBtn.addEventListener('click', () => {
                        successModal.classList.add('hidden');
                    });
                }
            } else {
                console.error("No se encontraron todos los elementos necesarios para el formulario de contacto mejorado.");
            }
        });
    </script>
    
    <script>
        window.gm_authFailure = function() {
            const mapErrorMessageDiv = document.getElementById('map-error-message');
            const mapCurrentUrlSpan = document.getElementById('map-current-url');
            if (mapErrorMessageDiv) {
                mapErrorMessageDiv.classList.remove('hidden');
                if (mapCurrentUrlSpan) {
                    mapCurrentUrlSpan.textContent = window.location.href;
                }
                const errorTitle = mapErrorMessageDiv.querySelector('[data-lang="map_error_title"]');
                const errorText = mapErrorMessageDiv.querySelector('[data-lang="map_error_text"]');
                const errorUrlIs = mapErrorMessageDiv.querySelector('[data-lang="map_error_url_is"]');
                if (window.translations && window.currentLanguage) { 
                    if (errorTitle) errorTitle.textContent = window.translations[window.currentLanguage]?.map_error_title || window.translations.es.map_error_title;
                    if (errorText) errorText.textContent = window.translations[window.currentLanguage]?.map_error_text || window.translations.es.map_error_text;
                    if (errorUrlIs) errorUrlIs.textContent = window.translations[window.currentLanguage]?.map_error_url_is || window.translations.es.map_error_url_is;
                }
            }
            console.error("Google Maps API authentication failure. Check RefererNotAllowedMapError or other API key issues in Google Cloud Console.");
        };

        function initMap() {
            const valencia = { lat: 39.4699, lng: -0.3763 }; 
            const sagunto = { lat: 39.6815, lng: -0.2776 }; 

            const mapElement = document.getElementById("map");
            const mapErrorMessageDiv = document.getElementById('map-error-message');
            const mapCurrentUrlSpan = document.getElementById('map-current-url');

            if (!mapElement) {
                console.error("Elemento del mapa no encontrado");
                return;
            }
            
            try {
                if (typeof google === 'undefined' || typeof google.maps === 'undefined' || typeof google.maps.Map === 'undefined') {
                    console.error("Google Maps API no cargada o incompleta.");
                    if (mapErrorMessageDiv) mapErrorMessageDiv.classList.remove('hidden');
                    if (mapCurrentUrlSpan) mapCurrentUrlSpan.textContent = window.location.href;
                    return;
                }

                const map = new google.maps.Map(mapElement, {
                    zoom: 10, 
                    center: valencia,
                    mapTypeId: 'roadmap', 
                    styles: [ 
                        { featureType: "water", elementType: "geometry", stylers: [{ color: "#e9e9e9" }, { lightness: 17 }] },
                        { featureType: "landscape", elementType: "geometry", stylers: [{ color: "#f5f5f5" }, { lightness: 20 }] },
                        { featureType: "road.highway", elementType: "geometry.fill", stylers: [{ color: "#ffffff" }, { lightness: 17 }] },
                        { featureType: "road.highway", elementType: "geometry.stroke", stylers: [{ color: "#ffffff" }, { lightness: 29 }, { weight: 0.2 }] },
                        { featureType: "road.arterial", elementType: "geometry", stylers: [{ color: "#ffffff" }, { lightness: 18 }] },
                        { featureType: "road.local", elementType: "geometry", stylers: [{ color: "#ffffff" }, { lightness: 16 }] },
                        { featureType: "poi", elementType: "geometry", stylers: [{ color: "#f5f5f5" }, { lightness: 21 }] },
                        { featureType: "poi.park", elementType: "geometry", stylers: [{ color: "#dedede" }, { lightness: 21 }] },
                        { elementType: "labels.text.stroke", stylers: [{ visibility: "on" }, { color: "#ffffff" }, { lightness: 16 }] },
                        { elementType: "labels.text.fill", stylers: [{ saturation: 36 }, { color: "#333333" }, { lightness: 40 }] },
                        { elementType: "labels.icon", stylers: [{ visibility: "off" }] },
                        { featureType: "transit", elementType: "geometry", stylers: [{ color: "#f2f2f2" }, { lightness: 19 }] },
                        { featureType: "administrative", elementType: "geometry.fill", stylers: [{ color: "#fefefe" }, { lightness: 20 }] },
                        { featureType: "administrative", elementType: "geometry.stroke", stylers: [{ color: "#fefefe" }, { lightness: 17 }, { weight: 1.2 }] }
                    ]
                });
                
                if (google.maps.geometry && google.maps.geometry.spherical) {
                     const radiusInMeters = google.maps.geometry.spherical.computeDistanceBetween(
                        new google.maps.LatLng(valencia),
                        new google.maps.LatLng(sagunto) 
                    );

                    new google.maps.Circle({
                        strokeColor: "#001f3f", 
                        strokeOpacity: 0.8,
                        strokeWeight: 2,
                        fillColor: "#007bff", 
                        fillOpacity: 0.25, 
                        map: map,
                        center: valencia,
                        radius: radiusInMeters, 
                    });
                } else {
                    console.warn("Librería 'geometry' de Google Maps no disponible para calcular el radio del círculo.");
                }

                new google.maps.Marker({
                    position: valencia,
                    map: map,
                    title: "Valencia (Centro de Cobertura)",
                    icon: { 
                        path: google.maps.SymbolPath.CIRCLE,
                        scale: 6,
                        fillColor: "#001f3f",
                        fillOpacity: 1,
                        strokeWeight: 0
                    }
                });
                if (mapErrorMessageDiv) mapErrorMessageDiv.classList.add('hidden');

            } catch (e) {
                console.error("Error inicializando Google Maps:", e);
                 if (mapErrorMessageDiv) mapErrorMessageDiv.classList.remove('hidden');
                 if (mapCurrentUrlSpan) mapCurrentUrlSpan.textContent = window.location.href;
            }
        }
        window.initMap = initMap;
    </script>
    <script async src="https://maps.googleapis.com/maps/api/js?key=AIzaSyDz_erEiiEvZlRfOhnRCt-Ooz5yM9rBrgk&libraries=geometry&callback=initMap&onerror=gm_authFailure"></script>

</body>
</html>
```

**Cambios Clave Realizados en el Script de Firebase:**

1.  **`setPersistence(auth, browserSessionPersistence)`:**
    * Antes de intentar `getRedirectResult` o `signInWithRedirect`, ahora se llama a `setPersistence` para intentar usar `sessionStorage` en lugar de `localStorage`. Esto a veces es menos propenso a ser bloqueado por configuraciones de privacidad estrictas.
2.  **Manejo de Errores de Persistencia/Redirección Mejorado:**
    * Se ha añadido un manejo de errores más específico en el bloque `.catch()` después de `getRedirectResult`. Si detecta un error relacionado con el almacenamiento, mostrará un mensaje más útil al usuario (usando la nueva clave de traducción `testimonial_storage_error`).
3.  **Llamada a `setPersistence` antes de `signInWithRedirect`:**
    * Al hacer clic en el botón de inicio de sesión con Google, también se intenta establecer la persistencia a `session` antes de llamar a `signInWithRedirect`.

**Nueva Clave de Traducción Necesaria:**

Asegúrate de añadir esta nueva clave a tus objetos de traducción (especialmente para `es`, `ca`, y `va`):

* **`testimonial_storage_error`**:
    * `es`: "El inicio de sesión no pudo completarse. Es posible que la configuración de privacidad de tu navegador (prevención de rastreo o bloqueo de cookies de terceros) esté interfiriendo. Por favor, ajusta la configuración para este sitio e inténtalo de nuevo."
    * `ca`: "L'inici de sessió no s'ha pogut completar. És possible que la configuració de privadesa del teu navegador (prevenció de rastreig o bloqueig de galetes de tercers) estigui interferint. Si us plau, ajusta la configuració per a aquest lloc i torna-ho a provar."
    * `va`: "L'inici de sessió no s'ha pogut completar. És possible que la configuració de privadesa del teu navegador (prevenció de rastreig o bloqueig de galetes de tercers) estiga interferint. Per favor, ajusta la configuració per a este lloc i torna-ho a provar."

**Qué hacer ahora:**

1.  **Actualiza tu código** con esta nueva versión.
2.  **Añade la nueva clave de traducción** `testimonial_storage_error` a tus objetos `translations` para todos los idiomas.
3.  **Prueba de nuevo el inicio de sesión con Google.**
4.  **Si sigue fallando, revisa la consola del navegador.** El nuevo mensaje de error podría darte más pistas o confirmar si es un problema de almacenamiento/privacidad del navegador.

Si el problema persiste y la consola sigue indicando un bloqueo de almacenamiento o un error en `setPersistence` o `getRedirectResult` relacionado con el entorno, la solución definitiva seguirá siendo **ajustar la configuración de privacidad de tu navegador para `erbserviciotecnico.com` y los dominios de Google/Firebase**, permitiendo las cookies y el almacenamiento necesarios para el flujo de autenticación. Este cambio en el código es un intento de mitigar el problema, pero no puede sobrepasar las restricciones impuestas por el navegad
      gtag('config', 'G-TQC24XCERF');
    </script>

    <style>
        body {
            font-family: 'Inter', sans-serif; 
        }
        .hero-bg {
            background-image: linear-gradient(rgba(0, 0, 0, 0.6), rgba(0, 0, 0, 0.6)), url('/imagen-hero.jpg.jpeg'); 
            background-size: cover;
            background-position: center;
            min-height: 100vh; 
        }
        
        @media (max-width: 768px) {
            .hero-bg {
                background-image: linear-gradient(rgba(0, 0, 0, 0.6), rgba(0, 0, 0, 0.6)), url('/imagen-hero-movil.jpg'); 
            }
        }

        .navy-blue {
            background-color: #001f3f; 
        }
        .text-navy {
            color: #001f3f;
        }
        .border-navy {
            border-color: #001f3f;
        }
        .btn-primary {
            background-color: #001f3f;
            color: white;
            transition: background-color 0.3s ease;
        }
        .btn-primary:hover {
            background-color: #003366; 
        }
        .btn-google {
            background-color: #DB4437;
            color: white;
            transition: background-color 0.3s ease;
        }
        .btn-google:hover {
            background-color: #C33D2E;
        }
        .section-title {
            border-bottom: 3px solid #001f3f;
            padding-bottom: 0.5rem;
            display: inline-block;
        }
        .service-card, .benefit-card, .testimonial-card {
            transition: transform 0.3s ease, box-shadow 0.3s ease;
        }
        .service-card:hover, .benefit-card:hover, .testimonial-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.1), 0 4px 6px -2px rgba(0, 0, 0, 0.05);
        }
        #mobile-menu {
            transform: translateX(-100%);
            transition: transform 0.3s ease-in-out;
        }
        #mobile-menu.open {
            transform: translateX(0);
        }
        .brand-logo img {
            height: 50px; 
            width: auto;
            margin: 0.5rem;
            filter: grayscale(100%);
            transition: filter 0.3s ease;
        }
        .brand-logo img:hover {
            filter: grayscale(0%);
        }
        .filter-btn {
            transition: background-color 0.3s ease, color 0.3s ease;
        }
        .filter-btn.active {
            background-color: #001f3f;
            color: white;
        }
        .service-hidden {
            display: none !important;
        }
        #map {
            height: 350px;
            width: 100%;
            border-radius: 0.5rem;
            overflow: hidden;
            box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.1), 0 4px 6px -2px rgba(0, 0, 0, 0.05);
        }
        #cookie-banner {
            position: fixed;
            bottom: 0;
            left: 0;
            right: 0;
            background-color: #1a202c; /* bg-gray-800 */
            color: white;
            padding: 1rem; /* p-4 */
            box-shadow: 0 -2px 10px rgba(0,0,0,0.2);
            z-index: 1000;
            display: none; 
        }
        #cookie-banner a {
            color: #63b3ed; /* text-blue-400 */
            text-decoration: underline;
        }
        #cookie-banner a:hover {
            color: #90cdf4; /* text-blue-300 */
        }

        #loading-spinner.hidden, #success-message-modal.hidden, #testimonial-loading-spinner.hidden, #testimonial-auth-message.hidden {
            display: none;
        }
        #google-signin-btn.hidden, #signout-btn.hidden, #user-info.hidden {
            display: none;
        }
        #testimonialForm.hidden {
            display: none;
        }

        /* Estilos para estrellas de calificación */
        .star-rating .fa-star {
            color: #ddd; /* Color de estrella vacía */
            cursor: pointer;
            transition: color 0.2s ease-in-out;
        }
        .star-rating .fa-star.selected,
        .star-rating .fa-star:hover,
        .star-rating .fa-star:hover ~ .fa-star {
            color: #f5b301; /* Color de estrella llena/hover */
        }
        .star-rating:hover .fa-star.selected:hover ~ .fa-star {
            color: #ddd; /* Mantener seleccionadas al hacer hover sobre otras */
        }
        .testimonial-stars .fa-star {
             color: #f5b301;
        }
        .testimonial-stars .fa-star.empty {
            color: #ddd;
        }

    </style>
</head>
<body class="bg-white text-gray-800">

    <script type="application/ld+json">
    {
      "@context": "https://schema.org",
      "@type": "LocalBusiness",
      "name": "ERB Servicio Técnico",
      "image": "https://erbserviciotecnico.com/logo.png", 
      "@id": "https://erbserviciotecnico.com/", 
      "url": "https://erbserviciotecnico.com/",
      "telephone": "+34612548508",
      "priceRange": "$$", 
      "description": "Especialistas en reparación de electrodomésticos de gama blanca, domésticos e industriales, y servicio de instalación de aires acondicionados en Barcelona, Coruña, Valencia y Castellón.",
      "address": {
        "@type": "PostalAddress",
        "addressCountry": "ES" 
      },
      "areaServed": [
        { "@type": "City", "name": "Barcelona" },
        { "@type": "City", "name": "Coruña" },
        { "@type": "City", "name": "Valencia" },
        { "@type": "City", "name": "Castellón de la Plana" }
      ],
      "hasOfferCatalog": {
        "@type": "OfferCatalog",
        "name": "Servicios Técnicos",
        "itemListElement": [
          { "@type": "Offer", "itemOffered": { "@type": "Service", "name": "Reparación de electrodomésticos gama blanca", "serviceType": "Reparación de electrodomésticos" } },
          { "@type": "Offer", "itemOffered": { "@type": "Service", "name": "Reparación de electrodomésticos industriales", "serviceType": "Reparación de electrodomésticos industriales" } },
          { "@type": "Offer", "itemOffered": { "@type": "Service", "name": "Instalación de aires acondicionados", "serviceType": "Instalación de aire acondicionado" } }
        ]
      },
      "aggregateRating": { 
        "@type": "AggregateRating",
        "ratingValue": "4.8", 
        "reviewCount": "25" 
      }
    }
    </script>

    <header class="navy-blue text-white shadow-lg sticky top-0 z-50">
        <div class="container mx-auto px-6 py-4 flex justify-between items-center">
            <a href="#inicio" class="text-2xl font-bold flex items-center">
                <img src="/logo.png" alt="ERB Servicio Técnico Logo" class="h-8 mr-2" onerror="this.onerror=null;this.src='https://placehold.co/100x30/001f3f/ffffff?text=ERB';"> <span data-lang="company_name_header">ERB Servicio Técnico</span>
            </a>
            <nav class="hidden md:flex space-x-4">
                <a href="#inicio" class="hover:text-gray-300 px-3 py-2 rounded-md text-sm font-medium" data-lang="nav_home">Inicio</a>
                <a href="#servicios" class="hover:text-gray-300 px-3 py-2 rounded-md text-sm font-medium" data-lang="nav_services">Servicios</a>
                <a href="#beneficios" class="hover:text-gray-300 px-3 py-2 rounded-md text-sm font-medium" data-lang="nav_benefits">Beneficios</a>
                <a href="#marcas" class="hover:text-gray-300 px-3 py-2 rounded-md text-sm font-medium" data-lang="nav_brands">Marcas</a>
                <a href="#nosotros" class="hover:text-gray-300 px-3 py-2 rounded-md text-sm font-medium" data-lang="nav_about">Sobre Nosotros</a>
                <a href="#testimonios" class="hover:text-gray-300 px-3 py-2 rounded-md text-sm font-medium" data-lang="nav_testimonials">Testimonios</a>
                <a href="#contacto" class="hover:text-gray-300 px-3 py-2 rounded-md text-sm font-medium" data-lang="nav_contact">Contacto</a>
            </nav>
            <div class="flex items-center">
                <div class="relative mr-4">
                    <button id="language-selector-btn" class="flex items-center focus:outline-none">
                        <i class="fas fa-globe mr-1"></i>
                        <span id="current-lang-text">ES</span>
                        <i class="fas fa-chevron-down ml-1 text-xs"></i>
                    </button>
                    <div id="language-dropdown" class="absolute right-0 mt-2 py-2 w-28 navy-blue rounded-md shadow-xl z-20 hidden">
                        <a href="#" class="block px-4 py-2 text-sm text-white hover:bg-blue-800" data-lang-option="es">Español</a>
                        <a href="#" class="block px-4 py-2 text-sm text-white hover:bg-blue-800" data-lang-option="ca">Català</a>
                        <a href="#" class="block px-4 py-2 text-sm text-white hover:bg-blue-800" data-lang-option="va">Valencià</a>
                    </div>
                </div>
                <button id="mobile-menu-button" class="md:hidden focus:outline-none">
                    <i class="fas fa-bars text-2xl"></i>
                </button>
            </div>
        </div>
    </header>

    <div id="mobile-menu" class="fixed inset-0 navy-blue text-white z-40 p-6 md:hidden">
        <div class="flex justify-end mb-8">
            <button id="close-mobile-menu-button" class="focus:outline-none">
                <i class="fas fa-times text-3xl"></i>
            </button>
        </div>
        <nav class="flex flex-col space-y-4 text-center">
            <a href="#inicio" class="hover:text-gray-300 text-lg py-2" data-lang="nav_home_mobile">Inicio</a>
            <a href="#servicios" class="hover:text-gray-300 text-lg py-2" data-lang="nav_services_mobile">Servicios</a>
            <a href="#beneficios" class="hover:text-gray-300 text-lg py-2" data-lang="nav_benefits_mobile">Beneficios</a>
            <a href="#marcas" class="hover:text-gray-300 text-lg py-2" data-lang="nav_brands_mobile">Marcas</a>
            <a href="#nosotros" class="hover:text-gray-300 text-lg py-2" data-lang="nav_about_mobile">Sobre Nosotros</a>
            <a href="#testimonios" class="hover:text-gray-300 text-lg py-2" data-lang="nav_testimonials_mobile">Testimonios</a>
            <a href="#contacto" class="hover:text-gray-300 text-lg py-2" data-lang="nav_contact_mobile">Contacto</a>
        </nav>
    </div>

    <section id="inicio" class="hero-bg text-white min-h-screen flex items-center">
        <div class="container mx-auto px-6 text-center">
            <h1 class="text-4xl md:text-5xl font-bold mb-6" data-lang="hero_h1">Reparación de Electrodomésticos: ERB Servicio Técnico</h1>
            <p class="text-lg md:text-xl mb-8 max-w-3xl mx-auto" data-lang="hero_subtitle">Especialistas en reparación y mantenimiento de electrodomésticos de gama blanca, industrial e instalación de aires acondicionados.</p>
            <a href="#contacto" class="btn-primary hover:bg-blue-700 text-white font-bold py-3 px-8 rounded-lg text-lg" data-lang="hero_cta">Solicita Presupuesto</a>
        </div>
    </section>

    <section id="servicios" class="py-16 md:py-24 bg-gray-50">
        <div class="container mx-auto px-6">
            <h2 class="text-3xl md:text-4xl font-bold text-center mb-4 text-navy" data-lang="services_title">Nuestros Servicios</h2>
            <p class="text-center text-gray-600 mb-8 max-w-xl mx-auto" data-lang="services_intro">Soluciones expertas para todo tipo de electrodomésticos y climatización.</p>
            
            <div class="flex justify-center space-x-2 md:space-x-4 mb-10">
                <button class="filter-btn active px-4 py-2 md:px-6 md:py-3 rounded-lg border border-navy text-navy hover:bg-navy-blue hover:text-white" data-filter="all" data-lang="filter_all">Todos</button>
                <button class="filter-btn px-4 py-2 md:px-6 md:py-3 rounded-lg border border-navy text-navy hover:bg-navy-blue hover:text-white" data-filter="domestico" data-lang="filter_domestic">Doméstico</button>
                <button class="filter-btn px-4 py-2 md:px-6 md:py-3 rounded-lg border border-navy text-navy hover:bg-navy-blue hover:text-white" data-filter="industrial" data-lang="filter_industrial">Industrial</button>
            </div>

            <div id="service-list" class="grid md:grid-cols-2 lg:grid-cols-3 gap-8">
                </div>
        </div>
    </section>
    
    <section id="beneficios" class="py-16 md:py-24 bg-white">
        <div class="container mx-auto px-6">
            <h2 class="text-3xl md:text-4xl font-bold text-center mb-12 section-title text-navy" data-lang="benefits_title">Por Qué Elegirnos</h2>
            <div class="grid md:grid-cols-2 lg:grid-cols-4 gap-8">
                <div class="benefit-card text-center p-6 bg-gray-50 rounded-xl shadow">
                    <div class="text-3xl text-navy mb-4"><i class="fas fa-phone-volume"></i></div>
                    <h3 class="text-xl font-semibold text-navy mb-2" data-lang="benefit1_title">Atención Inmediata</h3>
                    <p class="text-gray-600 text-sm" data-lang="benefit1_desc">Solicita tu inspección llamando a nuestros canales de atención al cliente.</p>
                </div>
                <div class="benefit-card text-center p-6 bg-gray-50 rounded-xl shadow">
                    <div class="text-3xl text-navy mb-4"><i class="fas fa-shipping-fast"></i></div>
                    <h3 class="text-xl font-semibold text-navy mb-2" data-lang="benefit2_title">Sin Coste de Desplazamiento</h3>
                    <p class="text-gray-600 text-sm" data-lang="benefit2_desc">Reparación en el acto si decides reparar, no cobramos el desplazamiento.</p>
                </div>
                <div class="benefit-card text-center p-6 bg-gray-50 rounded-xl shadow">
                    <div class="text-3xl text-navy mb-4"><i class="fas fa-shield-alt"></i></div>
                    <h3 class="text-xl font-semibold text-navy mb-2" data-lang="benefit3_title">Garantía de 6 Meses</h3>
                    <p class="text-gray-600 text-sm" data-lang="benefit3_desc">Disfruta de tu electrodoméstico como nuevo con garantía en la reparación de 6 meses.</p>
                </div>
                <div class="benefit-card text-center p-6 bg-gray-50 rounded-xl shadow">
                    <div class="text-3xl text-navy mb-4"><i class="fas fa-euro-sign"></i></div>
                    <h3 class="text-xl font-semibold text-navy mb-2" data-lang="benefit4_title">Precios Competitivos</h3>
                    <p class="text-gray-600 text-sm" data-lang="benefit4_desc">Precios competitivos en todas las reparaciones de electrodomésticos.</p>
                </div>
            </div>
        </div>
    </section>

    <section id="marcas" class="py-16 md:py-24 bg-gray-100">
        <div class="container mx-auto px-6">
            <h2 class="text-3xl md:text-4xl font-bold text-center mb-12 section-title text-navy" data-lang="brands_title">Trabajamos con las Mejores Marcas</h2>
            <div class="flex flex-wrap justify-center items-center">
                <div class="brand-logo p-2"><img src="/samsung-logo-wordmark-rgb.png" alt="Reparación electrodomésticos Samsung" onerror="this.onerror=null;this.src='https://placehold.co/150x50/ffffff/000000?text=Samsung';"></div>
                <div class="brand-logo p-2"><img src="/lg-logo-1.png" alt="Reparación electrodomésticos LG" onerror="this.onerror=null;this.src='https://placehold.co/150x50/ffffff/000000?text=LG';"></div>
                <div class="brand-logo p-2"><img src="/balay.png" alt="Reparación electrodomésticos Balay" onerror="this.onerror=null;this.src='https://placehold.co/150x50/ffffff/000000?text=Balay';"></div>
                <div class="brand-logo p-2"><img src="/siemens-Photoroom.png" alt="Reparación electrodomésticos Siemens" onerror="this.onerror=null;this.src='https://placehold.co/150x50/ffffff/000000?text=Siemens';"></div>
                <div class="brand-logo p-2"><img src="/Whirlpool_Corporation_Logo_(as_of_2017).svg.png" alt="Reparación electrodomésticos Whirlpool" onerror="this.onerror=null;this.src='https://placehold.co/150x50/ffffff/000000?text=Whirlpool';"></div>
                <div class="brand-logo p-2"><img src="/neckar.png" alt="Reparación electrodomésticos Neckar" onerror="this.onerror=null;this.src='https://placehold.co/150x50/ffffff/000000?text=Neckar';"></div>
                <div class="brand-logo p-2"><img src="/bosch.png" alt="Reparación electrodomésticos Bosch" onerror="this.onerror=null;this.src='https://placehold.co/150x50/ffffff/000000?text=Bosch';"></div>
                <div class="brand-logo p-2"><img src="/Haier_logo.svg.png" alt="Reparación electrodomésticos Haier" onerror="this.onerror=null;this.src='https://placehold.co/150x50/ffffff/000000?text=Haier';"></div>
                <div class="brand-logo p-2"><img src="/mitsubishi-Photoroom.png" alt="Reparación aires acondicionados Mitsubishi Electric" onerror="this.onerror=null;this.src='https://placehold.co/150x50/ffffff/000000?text=Mitsubishi';"></div>
                <div class="brand-logo p-2"><img src="/saunier-Photoroom.png" alt="Reparación calderas Saunier Duval" onerror="this.onerror=null;this.src='https://placehold.co/150x50/ffffff/000000?text=Saunier+Duval';"></div>
                <div class="brand-logo p-2"><img src="/ariston-Photoroom.png" alt="Reparación termos Ariston" onerror="this.onerror=null;this.src='https://placehold.co/150x50/ffffff/000000?text=Ariston';"></div>
                <div class="brand-logo p-2"><img src="/vaillant-Photoroom.png" alt="Reparación calderas Vaillant" onerror="this.onerror=null;this.src='https://placehold.co/150x50/ffffff/000000?text=Vaillant';"></div>
                <div class="brand-logo p-2"><img src="/junkers.png" alt="Reparación calentadores Junkers" onerror="this.onerror=null;this.src='https://placehold.co/150x50/ffffff/000000?text=Junkers';"></div>
            </div>
        </div>
    </section>

    <section id="nosotros" class="py-16 md:py-24 bg-white">
        <div class="container mx-auto px-6">
            <div class="text-center">
                <h2 class="text-3xl md:text-4xl font-bold mb-12 section-title text-navy" data-lang="about_title">Sobre Nosotros</h2>
            </div>
            <div class="grid md:grid-cols-2 gap-12 items-center">
                <div>
                    <img src="https://placehold.co/600x400/001f3f/ffffff?text=Equipo+ERB" alt="Equipo de ERB Servicio Técnico" class="rounded-lg shadow-xl w-full h-auto object-cover">
                </div>
                <div class="text-gray-700">
                    <p class="mb-4" data-lang="about_text_p1">Somos un equipo de técnicos especializados con años de experiencia en la reparación y mantenimiento de electrodomésticos de gama blanca, tanto domésticos como industriales, así como en la instalación de aires acondicionados.</p>
                    <p class="mb-4" data-lang="about_text_p2">Nuestro compromiso es ofrecer un servicio rápido, eficiente y con garantía, asegurando la máxima satisfacción de nuestros clientes en Barcelona, Coruña, Valencia y Castellón de la Plana.</p>
                    <p data-lang="about_text_p3">Confía en nosotros para devolverle la vida a tus electrodomésticos.</p>
                </div>
            </div>
        </div>
    </section>

    <section id="testimonios" class="py-16 md:py-24 bg-gray-50">
        <div class="container mx-auto px-6">
            <h2 class="text-3xl md:text-4xl font-bold text-center mb-12 section-title text-navy" data-lang="testimonials_title">Opiniones de Nuestros Clientes</h2>
            
            <div class="max-w-2xl mx-auto bg-white p-8 rounded-xl shadow-lg mb-16">
                <h3 class="text-2xl font-semibold text-navy mb-6" data-lang="testimonial_form_title">Deja tu Opinión</h3>
                
                <div id="auth-container" class="mb-6 text-center">
                    <div id="user-info" class="hidden mb-4">
                        <p><span data-lang="testimonial_logged_in_as">Conectado como:</span> <span id="user-display-name" class="font-semibold"></span></p>
                        <button id="signout-btn" class="mt-2 text-sm text-red-600 hover:underline" data-lang="testimonial_sign_out">Cerrar Sesión</button>
                    </div>
                    <button id="google-signin-btn" class="btn-google hover:bg-red-700 text-white font-bold py-2 px-4 rounded-lg inline-flex items-center">
                        <i class="fab fa-google mr-2"></i> <span data-lang="testimonial_signin_google">Iniciar sesión con Google para opinar</span>
                    </button>
                </div>

                <div id="testimonial-auth-message" class="text-center p-4 mb-4 bg-yellow-100 text-yellow-700 rounded-md">
                    <p data-lang="testimonial_login_to_submit">Por favor, inicia sesión con Google para dejar una opinión.</p>
                </div>

                <form id="testimonialForm" class="space-y-6 hidden">
                    <div>
                        <label for="testimonialNombre" class="block text-sm font-medium text-gray-700" data-lang="testimonial_form_name">Tu Nombre</label>
                        <input type="text" name="testimonialNombre" id="testimonialNombre" required class="mt-1 block w-full px-4 py-3 rounded-md shadow-sm border-gray-300 focus:ring-navy focus:border-navy bg-gray-100" readonly>
                    </div>
                    <div>
                        <label class="block text-sm font-medium text-gray-700" data-lang="testimonial_form_rating">Tu Puntuación</label>
                        <div id="testimonialRating" class="star-rating flex space-x-1 mt-1 text-2xl">
                            <i class="fas fa-star" data-value="1"></i>
                            <i class="fas fa-star" data-value="2"></i>
                            <i class="fas fa-star" data-value="3"></i>
                            <i class="fas fa-star" data-value="4"></i>
                            <i class="fas fa-star" data-value="5"></i>
                        </div>
                        <input type="hidden" name="ratingValue" id="ratingValue" required>
                    </div>
                    <div>
                        <label for="testimonialMensaje" class="block text-sm font-medium text-gray-700" data-lang="testimonial_form_message">Tu Comentario</label>
                        <textarea name="testimonialMensaje" id="testimonialMensaje" rows="4" required class="mt-1 block w-full px-4 py-3 rounded-md shadow-sm border-gray-300 focus:ring-navy focus:border-navy"></textarea>
                    </div>
                    <div>
                        <button type="submit" id="submit-testimonial-form" class="w-full btn-primary text-white font-bold py-3 px-6 rounded-lg text-lg transition duration-300" data-lang="testimonial_form_submit">Enviar Opinión</button>
                    </div>
                </form>
                <div id="testimonial-form-status" class="mt-4 text-center"></div>
                 <div id="testimonial-loading-spinner" class="hidden flex items-center justify-center mt-4">
                    <div class="animate-spin rounded-full h-8 w-8 border-t-2 border-b-2 border-navy"></div>
                    <p class="ml-2 text-navy" data-lang="form_sending">Enviando...</p>
                </div>
            </div>

            <div id="testimonial-list" class="grid md:grid-cols-2 lg:grid-cols-3 gap-8">
                </div>
            <p id="no-testimonials" class="text-center text-gray-600 mt-8 hidden" data-lang="testimonials_empty">Aún no hay testimonios. ¡Sé el primero en dejar tu opinión iniciando sesión!</p>
        </div>
    </section>


    <section id="contacto" class="py-16 md:py-24 navy-blue text-white">
        <div class="container mx-auto px-6">
            <h2 class="text-3xl md:text-4xl font-bold text-center mb-12" data-lang="contact_title">Contacta con Nosotros</h2>
            <div class="grid md:grid-cols-2 gap-10 items-start">
                <div>
                    <h3 class="text-2xl font-semibold mb-6" data-lang="contact_form_title">Envíanos un Mensaje</h3>
                    <form id="contactForm" action="https://formsubmit.co/serviciotecnico.erb@gmail.com" method="POST" class="space-y-6">
                        <input type="hidden" name="_subject" value="Nuevo mensaje desde la web ERB Servicio Técnico">
                        <input type="hidden" name="_captcha" value="false"> 
                        <input type="hidden" name="_template" value="table"> 
                        
                        <div>
                            <label for="nombre" class="block text-sm font-medium" data-lang="form_name">Nombre</label>
                            <input type="text" name="nombre" id="nombre" required class="mt-1 block w-full px-4 py-3 rounded-md shadow-sm bg-white text-gray-800 focus:ring-blue-500 focus:border-blue-500 border-gray-300">
                        </div>
                        <div>
                            <label for="telefono" class="block text-sm font-medium" data-lang="form_phone">Teléfono</label>
                            <input type="tel" name="telefono" id="telefono" required class="mt-1 block w-full px-4 py-3 rounded-md shadow-sm bg-white text-gray-800 focus:ring-blue-500 focus:border-blue-500 border-gray-300">
                        </div>
                        <div>
                            <label for="ubicacion" class="block text-sm font-medium" data-lang="form_location">Ubicación del servicio</label>
                            <select name="ubicacion" id="ubicacion" required class="mt-1 block w-full px-4 py-3 rounded-md shadow-sm bg-white text-gray-800 focus:ring-blue-500 focus:border-blue-500 border-gray-300">
                                <option value="barcelona" data-lang="loc_barcelona">Barcelona</option>
                                <option value="la_coruna" data-lang="loc_coruna">La Coruña</option>
                                <option value="valencia" data-lang="loc_valencia">Valencia</option>
                                <option value="castellon" data-lang="loc_castellon">Castellón de la Plana</option>
                            </select>
                        </div>
                        <div>
                            <label for="equipo" class="block text-sm font-medium" data-lang="form_appliance">Electrodoméstico a reparar o servicio</label>
                            <select name="equipo" id="equipo" required class="mt-1 block w-full px-4 py-3 rounded-md shadow-sm bg-white text-gray-800 focus:ring-blue-500 focus:border-blue-500 border-gray-300">
                                </select>
                        </div>
                        <div>
                            <label for="mensaje" class="block text-sm font-medium" data-lang="form_message">Descripción del problema</label>
                            <textarea name="mensaje" id="mensaje" rows="4" required class="mt-1 block w-full px-4 py-3 rounded-md shadow-sm bg-white text-gray-800 focus:ring-blue-500 focus:border-blue-500 border-gray-300"></textarea>
                        </div>
                        <div>
                            <button type="submit" id="submit-contact-form" class="w-full bg-white hover:bg-gray-200 text-navy font-bold py-3 px-6 rounded-lg text-lg transition duration-300" data-lang="form_submit">Enviar Mensaje</button>
                        </div>
                    </form>
                    <div id="form-status" class="mt-4 text-center text-white"></div> 
                </div>

                <div class="space-y-8">
                    <div>
                        <h3 class="text-2xl font-semibold mb-4" data-lang="contact_info_title">Otras Formas de Contacto</h3>
                        <p class="flex items-center mb-3">
                            <i class="fas fa-phone mr-3 text-xl"></i>
                            <a href="tel:+34612548508" class="hover:underline" data-lang="contact_phone_text">+34 612 548 508</a>
                        </p>
                        <p class="flex items-center mb-3">
                            <i class="fas fa-envelope mr-3 text-xl"></i>
                            <a href="mailto:serviciotecnico.erb@gmail.com" class="hover:underline" data-lang="contact_email_text">serviciotecnico.erb@gmail.com</a> </p>
                        <p class="flex items-center mb-6">
                            <img src="/123.png" alt="WhatsApp ERB" class="w-6 h-6 mr-2" onerror="this.onerror=null;this.src='https://placehold.co/24x24/ffffff/000000?text=WA';"> <a href="https://wa.me/34612548508" target="_blank" class="hover:underline" data-lang="contact_whatsapp_text">Chatea con nosotros en WhatsApp</a>
                        </p>
                         <p class="flex items-start">
                            <i class="fas fa-map-marker-alt mr-3 text-xl mt-1"></i>
                            <span data-lang="contact_areas">Servicio en: Barcelona, Coruña, Valencia y Castellón de la Plana</span>
                        </p>
                    </div>
                    <div>
                        <h3 class="text-2xl font-semibold mb-4" data-lang="contact_map_title">Nuestra Área de Cobertura</h3>
                        <div id="map">
                             <div id="map-error-message" class="p-4 bg-red-100 text-red-700 rounded-md hidden">
                                <strong data-lang="map_error_title">Error al cargar el mapa:</strong>
                                <p data-lang="map_error_text">El mapa no se puede mostrar en este momento. Si eres el administrador del sitio, asegúrate de que la URL actual esté autorizada en la configuración de la clave API de Google Maps en Google Cloud Console.</p>
                                <p data-lang="map_error_url_is">URL actual para autorizar:</p>
                                <code id="map-current-url" class="text-xs bg-red-200 p-1 rounded"></code>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <div id="loading-spinner" class="hidden fixed inset-0 bg-black bg-opacity-75 flex items-center justify-center z-[100]">
        <div class="animate-spin rounded-full h-20 w-20 border-t-4 border-b-4 border-white"></div>
    </div>

    <div id="success-message-modal" class="hidden fixed inset-0 bg-black bg-opacity-75 flex items-center justify-center z-[100] p-4">
        <div class="bg-white p-8 md:p-10 rounded-xl shadow-2xl text-center max-w-md w-full">
            <div class="mb-5">
                <svg class="mx-auto h-16 w-16 text-green-500" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z" />
                </svg>
            </div>
            <h3 class="text-2xl md:text-3xl font-bold text-gray-800 mb-3" data-lang="form_success_modal_title">¡Enviado con Éxito!</h3>
            <p class="text-gray-600 mb-6" data-lang="form_success_modal_text">Gracias por tu mensaje. En breve nos pondremos en contacto contigo.</p>
            <button id="close-success-modal-btn" class="bg-navy-blue text-white hover:bg-blue-700 font-semibold py-3 px-8 rounded-lg text-lg transition duration-300" data-lang="form_success_modal_close">Cerrar</button>
        </div>
    </div>


    <footer class="bg-gray-900 text-gray-300 py-12">
        <div class="container mx-auto px-6 text-center">
            <p id="footer-copyright-text" data-lang="footer_copyright">© 2025 ERB Servicio Técnico de Electrodomésticos | BARCELONA – CORUÑA – VALENCIA – CASTELLÓN de la Plana</p>
            <div class="mt-4 space-x-4 text-sm">
                <a href="/politica-privacidad.html" class="hover:text-white" data-lang="footer_privacy" id="privacyLink">Política de Privacidad</a>
                <a href="/aviso-legal.html" class="hover:text-white" data-lang="footer_legal" id="legalLink">Aviso Legal</a>
                <a href="/politica-cookies.html" class="hover:text-white" data-lang="footer_cookies" id="cookiesLink">Política de Cookies</a>
            </div>
        </div>
    </footer>

    <div id="cookie-banner" class="items-center justify-between flex-wrap md:flex">
        <p class="text-sm mb-2 md:mb-0 md:mr-4">
            <span data-lang="cookie_banner_text">Este sitio web utiliza cookies para asegurar la mejor experiencia. Al continuar navegando, aceptas su uso, incluidas cookies para Google Analytics y Google Ads. Consulta nuestra</span>
            <a href="/politica-cookies.html" id="cookieBannerPolicyLink" class="font-semibold" data-lang="cookie_banner_policy_link">política de cookies</a>.
        </p>
        <button id="accept-cookies-btn" class="bg-blue-500 hover:bg-blue-600 text-white font-bold py-2 px-4 rounded-lg text-sm" data-lang="cookie_banner_accept">
            Aceptar
        </button>
    </div>

    <script type="module">
        import { initializeApp } from "https://www.gstatic.com/firebasejs/11.8.1/firebase-app.js";
        import { getAuth, onAuthStateChanged, GoogleAuthProvider, signInWithRedirect, signOut, getRedirectResult, browserSessionPersistence, setPersistence } from "https://www.gstatic.com/firebasejs/11.8.1/firebase-auth.js";
        import { getFirestore, collection, addDoc, query, onSnapshot, serverTimestamp, orderBy, limit } from "https://www.gstatic.com/firebasejs/11.8.1/firebase-firestore.js";

        const firebaseConfig = {
          apiKey: "AIzaSyCkuxUilQ75CH4Lx96loCsTASsF1u0WwSc",
          authDomain: "xddddd-23011.firebaseapp.com",
          projectId: "xddddd-23011",
          storageBucket: "xddddd-23011.appspot.com", 
          messagingSenderId: "723576872564",
          appId: "1:723576872564:web:a7c3f486442d7619967b21"
        };
        
        const appId = firebaseConfig.appId; 
        console.log("Firebase App ID en uso para Firestore paths:", appId);

        const app = initializeApp(firebaseConfig);
        const auth = getAuth(app);
        const db = getFirestore(app);
        
        let currentFirebaseUser = null; 

        const googleSignInBtn = document.getElementById('google-signin-btn');
        const signOutBtn = document.getElementById('signout-btn');
        const userInfoDiv = document.getElementById('user-info');
        const userDisplayNameSpan = document.getElementById('user-display-name');
        const testimonialNombreInput = document.getElementById('testimonialNombre');
        const testimonialForm = document.getElementById('testimonialForm');
        const testimonialFormStatus = document.getElementById('testimonial-form-status');
        const testimonialAuthMessage = document.getElementById('testimonial-auth-message'); 
        const testimonialListDiv = document.getElementById('testimonial-list'); 
        const noTestimonialsP = document.getElementById('no-testimonials'); 

        // Intentar establecer la persistencia a 'session'
        setPersistence(auth, browserSessionPersistence)
          .then(() => {
            console.log("Persistencia de autenticación establecida a 'session'.");
            // Una vez establecida la persistencia, verificar el resultado de la redirección.
            return getRedirectResult(auth);
          })
          .then((result) => {
            if (result && result.user) {
              console.log("Usuario obtenido de getRedirectResult:", result.user);
            }
            loadTestimonials(); // Cargar testimonios después de procesar redirect y persistencia
          })
          .catch((error) => {
            console.error("Error al establecer persistencia o en getRedirectResult:", error);
            // Mostrar un mensaje más específico si es un error de almacenamiento conocido
            if (error.code && (error.code.includes('storage') || error.code.includes('auth/operation-not-supported-in-this-environment'))) {
                 if (testimonialFormStatus) {
                    testimonialFormStatus.innerHTML = (translations[currentLanguage]?.testimonial_storage_error || "El inicio de sesión no pudo completarse. Es posible que la configuración de privacidad de tu navegador (prevención de rastreo o bloqueo de cookies de terceros) esté interfiriendo. Por favor, ajusta la configuración para este sitio e inténtalo de nuevo.");
                    testimonialFormStatus.className = 'mt-4 text-center text-red-500 p-3 bg-red-100 rounded-md';
                }
            } else if (testimonialFormStatus) {
                testimonialFormStatus.textContent = translations[currentLanguage]?.testimonial_signin_error || "Error al procesar inicio de sesión con Google.";
                testimonialFormStatus.className = 'mt-4 text-center text-red-500';
            }
            loadTestimonials(); // Intentar cargar testimonios de todas formas
          });


        function updateAuthUI(user) {
            currentFirebaseUser = user;
            if (user) { 
                googleSignInBtn.classList.add('hidden');
                userInfoDiv.classList.remove('hidden');
                signOutBtn.classList.remove('hidden');
                testimonialAuthMessage.classList.add('hidden'); 
                testimonialForm.classList.remove('hidden'); 

                userDisplayNameSpan.textContent = user.displayName || 'Usuario de Google';
                testimonialNombreInput.value = user.displayName || '';
                testimonialNombreInput.readOnly = true;
                testimonialNombreInput.classList.add('bg-gray-100');
            } else { 
                googleSignInBtn.classList.remove('hidden');
                userInfoDiv.classList.add('hidden');
                signOutBtn.classList.add('hidden');
                testimonialAuthMessage.classList.remove('hidden'); 
                const authMsgP = testimonialAuthMessage.querySelector('p');
                if (authMsgP && translations[currentLanguage]) {
                    authMsgP.textContent = translations[currentLanguage].testimonial_login_to_submit || "Por favor, inicia sesión con Google para dejar una opinión.";
                }
                testimonialForm.classList.add('hidden'); 

                userDisplayNameSpan.textContent = '';
                testimonialNombreInput.value = ''; 
                testimonialNombreInput.readOnly = false;
                testimonialNombreInput.classList.remove('bg-gray-100');
            }
        }
        
        onAuthStateChanged(auth, (user) => {
            console.log("onAuthStateChanged disparado. Usuario:", user);
            updateAuthUI(user);
        });
        
        if (googleSignInBtn) {
            googleSignInBtn.addEventListener('click', () => {
                // Asegurarse de que la persistencia esté configurada antes de redirigir
                setPersistence(auth, browserSessionPersistence)
                .then(() => {
                    const provider = new GoogleAuthProvider();
                    return signInWithRedirect(auth, provider);
                })
                .catch((error) => {
                     console.error("Error al iniciar redirección con Google (posiblemente error de persistencia):", error);
                     if (testimonialFormStatus) {
                        testimonialFormStatus.textContent = translations[currentLanguage]?.testimonial_signin_error || "Error al iniciar sesión con Google. Revisa la configuración de tu navegador.";
                        testimonialFormStatus.className = 'mt-4 text-center text-red-500 p-3 bg-red-100 rounded-md';
                    }
                });
            });
        }

        if (signOutBtn) {
            signOutBtn.addEventListener('click', async () => {
                try {
                    await signOut(auth);
                } catch (error) {
                    console.error("Error al cerrar sesión:", error);
                }
            });
        }
        
        // ... (resto del código de testimonios: estrellas, envío de formulario, displayTestimonial, loadTestimonials)
        // ... (allServices, translations, setLanguage, etc.)
        // Asegúrate de que las definiciones de estas variables y funciones estén presentes.
        // El código de loadTestimonials y displayTestimonial, y la lógica de las estrellas
        // y el envío del formulario de testimonios se mantienen como en la versión anterior.
        // Solo se han modificado las partes de inicialización de Auth y manejo de UI de Auth.

        const testimonialRatingStars = document.querySelectorAll('#testimonialRating .fa-star');
        const ratingValueInput = document.getElementById('ratingValue');
        const testimonialLoadingSpinner = document.getElementById('testimonial-loading-spinner');
        const submitTestimonialButton = document.getElementById('submit-testimonial-form');

        let currentRating = 0;

        testimonialRatingStars.forEach(star => {
            star.addEventListener('click', () => {
                currentRating = parseInt(star.getAttribute('data-value'));
                ratingValueInput.value = currentRating;
                updateStarDisplay(currentRating);
            });
            star.addEventListener('mouseover', () => {
                const hoverValue = parseInt(star.getAttribute('data-value'));
                updateStarDisplay(hoverValue, true);
            });
            star.addEventListener('mouseout', () => {
                updateStarDisplay(currentRating);
            });
        });

        function updateStarDisplay(rating, isHover = false) {
            testimonialRatingStars.forEach(star => {
                const starValue = parseInt(star.getAttribute('data-value'));
                if (starValue <= rating) {
                    star.classList.add('selected', 'text-yellow-400');
                    star.classList.remove('text-gray-300'); 
                } else {
                    star.classList.remove('selected', 'text-yellow-400');
                    star.classList.add('text-gray-300');
                }
            });
        }
        
        if (testimonialForm) {
            testimonialForm.addEventListener('submit', async (e) => {
                e.preventDefault();
                if (!auth.currentUser) { 
                    if(testimonialFormStatus) testimonialFormStatus.textContent = translations[currentLanguage]?.testimonial_login_required_submit || "Debes iniciar sesión con Google para enviar una opinión.";
                    if(testimonialFormStatus) testimonialFormStatus.className = 'mt-4 text-center text-yellow-500';
                    return;
                }
                if (currentRating === 0) {
                     if(testimonialFormStatus) testimonialFormStatus.textContent = translations[currentLanguage]?.testimonial_form_rating_required || "Por favor, selecciona una puntuación.";
                     if(testimonialFormStatus) testimonialFormStatus.className = 'mt-4 text-center text-red-500';
                    return;
                }

                let nombre = testimonialNombreInput.value; 
                const mensaje = document.getElementById('testimonialMensaje').value;
                
                testimonialLoadingSpinner.classList.remove('hidden');
                submitTestimonialButton.disabled = true;
                if(testimonialFormStatus) testimonialFormStatus.textContent = '';

                try {
                    const testimonialsCollectionPath = `artifacts/${appId}/public/data/testimonials`;
                    await addDoc(collection(db, testimonialsCollectionPath), {
                        name: nombre,
                        rating: currentRating,
                        comment: mensaje,
                        createdAt: serverTimestamp(),
                        userId: auth.currentUser.uid, 
                        isGoogleUser: !auth.currentUser.isAnonymous, 
                        photoURL: auth.currentUser.photoURL || null 
                    });
                    if(testimonialFormStatus) testimonialFormStatus.textContent = translations[currentLanguage]?.testimonial_form_success || "¡Gracias por tu opinión!";
                    if(testimonialFormStatus) testimonialFormStatus.className = 'mt-4 text-center text-green-500';
                    
                    document.getElementById('testimonialMensaje').value = '';
                    currentRating = 0;
                    ratingValueInput.value = '';
                    updateStarDisplay(0);

                } catch (error) {
                    console.error("Error al guardar testimonio: ", error);
                    if(testimonialFormStatus) testimonialFormStatus.textContent = translations[currentLanguage]?.testimonial_form_error || "Error al enviar tu opinión. Inténtalo de nuevo.";
                    if(testimonialFormStatus) testimonialFormStatus.className = 'mt-4 text-center text-red-500';
                } finally {
                    testimonialLoadingSpinner.classList.add('hidden');
                    submitTestimonialButton.disabled = false;
                }
            });
        }

        function displayTestimonial(doc) {
            const data = doc.data();
            const card = document.createElement('div');
            card.className = 'testimonial-card bg-white p-6 rounded-xl shadow-lg border border-gray-200 flex flex-col';
            
            let starsHtml = '<div class="testimonial-stars text-yellow-400 mb-2 flex items-center">';
            for (let i = 1; i <= 5; i++) {
                starsHtml += `<i class="fas fa-star ${i <= data.rating ? '' : 'empty text-gray-300'}"></i>`;
            }
            starsHtml += '</div>';

            const date = data.createdAt?.toDate ? data.createdAt.toDate().toLocaleDateString(currentLanguage) : (translations[currentLanguage]?.date_unavailable || 'Fecha no disponible');

            card.innerHTML = `
                ${starsHtml}
                <p class="text-gray-600 italic mb-4 flex-grow">"${data.comment}"</p>
                <div class="mt-auto">
                    <p class="font-semibold text-navy text-right">- ${data.name}</p>
                    <p class="text-xs text-gray-400 text-right">${date}</p>
                </div>
            `;
            if(testimonialListDiv) testimonialListDiv.appendChild(card);
        }

        function loadTestimonials() {
            console.log("Intentando cargar testimonios (público)...");
            const testimonialsCollectionPath = `artifacts/${appId}/public/data/testimonials`;
            const q = query(collection(db, testimonialsCollectionPath), orderBy("createdAt", "desc"), limit(6)); 

            onSnapshot(q, (querySnapshot) => {
                if(testimonialListDiv) testimonialListDiv.innerHTML = ''; 
                if (querySnapshot.empty) {
                    if(noTestimonialsP && translations[currentLanguage]) {
                        noTestimonialsP.textContent = translations[currentLanguage].testimonials_empty;
                        noTestimonialsP.classList.remove('hidden');
                    }
                } else {
                    if(noTestimonialsP) noTestimonialsP.classList.add('hidden');
                    querySnapshot.forEach((doc) => {
                        displayTestimonial(doc);
                    });
                }
            }, (error) => {
                console.error("Error al cargar testimonios: ", error);
                 if(noTestimonialsP && translations[currentLanguage]) {
                    noTestimonialsP.textContent = translations[currentLanguage]?.testimonials_load_error || "Error al cargar testimonios.";
                    noTestimonialsP.classList.remove('hidden');
                    noTestimonialsP.classList.add('text-red-500');
                }
            });
        }
        
        const allServices = [
            { id: 'frigorificos', type: 'domestico', icon: 'fa-snowflake', title_key: 'service_fridge_title', desc_key: 'service_fridge_desc' },
            { id: 'aires_acondicionados', type: 'domestico industrial', icon: 'fa-wind', title_key: 'service_ac_title', desc_key: 'service_ac_desc' },
            { id: 'lavadoras', type: 'domestico', icon: 'fa-soap', title_key: 'service_washing_machine_title', desc_key: 'service_washing_machine_desc' },
            { id: 'lavavajillas', type: 'domestico', icon: 'fa-glass-water-droplet', title_key: 'service_dishwasher_title', desc_key: 'service_dishwasher_desc' },
            { id: 'hornos', type: 'domestico', icon: 'fa-temperature-high', title_key: 'service_oven_title', desc_key: 'service_oven_desc' },
            { id: 'secadoras', type: 'domestico', icon: 'fa-shirt', title_key: 'service_dryer_title', desc_key: 'service_dryer_desc' },
            { id: 'vitroceramicas', type: 'domestico', icon: 'fa-fire-burner', title_key: 'service_cooktop_title', desc_key: 'service_cooktop_desc' },
            { id: 'calentadores_agua', type: 'domestico', icon: 'fa-tint', title_key: 'service_water_heater_title', desc_key: 'service_water_heater_desc' },
            { id: 'calderas', type: 'domestico', icon: 'fa-fire', title_key: 'service_boiler_title', desc_key: 'service_boiler_desc' },
            { id: 'termotanques', type: 'domestico', icon: 'fa-water', title_key: 'service_thermotank_title', desc_key: 'service_thermotank_desc' },
            { id: 'lavanderia_industrial', type: 'industrial', icon: 'fa-industry', title_key: 'service_industrial_laundry_title', desc_key: 'service_industrial_laundry_desc' },
            { id: 'refrigeracion_industrial', type: 'industrial', icon: 'fa-temperature-arrow-down', title_key: 'service_industrial_fridge_title', desc_key: 'service_industrial_fridge_desc' },
            { id: 'calderas_industriales', type: 'industrial', icon: 'fa-dumpster-fire', title_key: 'service_industrial_boiler_title', desc_key: 'service_industrial_boiler_desc' },
        ];

        const translations = {
            es: {
                company_name_header: "ERB Servicio Técnico",
                nav_home: "Inicio", nav_services: "Servicios", nav_benefits: "Beneficios", nav_brands: "Marcas", nav_about: "Sobre Nosotros", nav_testimonials: "Testimonios", nav_contact: "Contacto",
                nav_home_mobile: "Inicio", nav_services_mobile: "Servicios", nav_benefits_mobile: "Beneficios", nav_brands_mobile: "Marcas", nav_about_mobile: "Sobre Nosotros", nav_testimonials_mobile: "Testimonios", nav_contact_mobile: "Contacto",
                hero_h1: "Reparación de Electrodomésticos: ERB Servicio Técnico",
                hero_subtitle: "Especialistas en reparación y mantenimiento de electrodomésticos de gama blanca, industrial e instalación de aires acondicionados.",
                hero_cta: "Solicita Presupuesto",
                services_title: "Nuestros Servicios",
                services_intro: "Soluciones expertas para todo tipo de electrodomésticos y climatización.",
                filter_all: "Todos", filter_domestic: "Doméstico", filter_industrial: "Industrial",
                service_fridge_title: "Reparación de Frigoríficos y Congeladores", service_fridge_desc: "Soluciones para problemas de enfriamiento, fugas y más en tus equipos de refrigeración domésticos.",
                service_ac_title: "Instalación y Reparación de Aires Acondicionados", service_ac_desc: "Servicio completo para sistemas de climatización domésticos e industriales, garantizando confort.",
                service_washing_machine_title: "Reparación de Lavadoras", service_washing_machine_desc: "Arreglamos problemas de centrifugado, desagüe, y cualquier avería en tu lavadora.",
                service_dishwasher_title: "Reparación de Lavavajillas", service_dishwasher_desc: "Solucionamos fallos de limpieza, fugas o problemas eléctricos en tu lavavajillas.",
                service_oven_title: "Reparación de Hornos", service_oven_desc: "Reparamos hornos que no calientan, problemas con el termostato o fallos electrónicos.",
                service_dryer_title: "Reparación de Secadoras", service_dryer_desc: "Soluciones para secadoras que no secan, hacen ruido o no encienden.",
                service_cooktop_title: "Reparación de Vitrocerámicas", service_cooktop_desc: "Reparamos vitrocerámicas de inducción, eléctricas, con problemas en los fogones o controles.",
                service_water_heater_title: "Reparación de Calentadores de Agua", service_water_heater_desc: "Servicio técnico para calentadores de gas o eléctricos, problemas de encendido o fugas.",
                service_boiler_title: "Reparación de Calderas", service_boiler_desc: "Especialistas en calderas de gas o gasoil, solucionamos averías y realizamos mantenimiento.",
                service_thermotank_title: "Reparación de Termotanques", service_thermotank_desc: "Reparación y mantenimiento de termotanques eléctricos, problemas de temperatura o pérdidas.",
                service_industrial_laundry_title: "Reparación de Maquinaria de Lavandería Industrial", service_industrial_laundry_desc: "Servicio técnico para lavadoras, secadoras y planchadoras industriales.",
                service_industrial_fridge_title: "Reparación de Equipos de Refrigeración Industrial", service_industrial_fridge_desc: "Mantenimiento y reparación de cámaras frigoríficas, congeladores y vitrinas industriales.",
                service_industrial_boiler_title: "Reparación de Calderas Industriales", service_industrial_boiler_desc: "Soluciones para calderas de vapor, agua caliente y otros sistemas industrials.",
                benefits_title: "Por Qué Elegirnos",
                benefit1_title: "Atención Inmediata", benefit1_desc: "Solicita tu inspección llamando a nuestros canales de atención al cliente.",
                benefit2_title: "Sin Coste de Desplazamiento", benefit2_desc: "Reparación en el acto si decides reparar, no cobramos el desplazamiento.",
                benefit3_title: "Garantía de 6 Meses", benefit3_desc: "Disfruta de tu electrodoméstico como nuevo con garantía en la reparación de 6 meses.",
                benefit4_title: "Precios Competitivos", benefit4_desc: "Precios competitivos en todas las reparaciones de electrodomésticos.",
                brands_title: "Trabajamos con las Mejores Marcas",
                about_title: "Sobre Nosotros",
                about_text_p1: "Somos un equipo de técnicos especializados con años de experiencia en la reparación y mantenimiento de electrodomésticos de gama blanca, tanto domésticos como industriales, así como en la instalación de aires acondicionados.",
                about_text_p2: "Nuestro compromiso es ofrecer un servicio rápido, eficiente y con garantía, asegurando la máxima satisfacción de nuestros clientes en Barcelona, Coruña, Valencia y Castellón de la Plana.",
                about_text_p3: "Confía en nosotros para devolverle la vida a tus electrodomésticos.",
                testimonials_title: "Opiniones de Nuestros Clientes",
                testimonial_form_title: "Deja tu Opinión",
                testimonial_form_name: "Tu Nombre",
                testimonial_form_rating: "Tu Puntuación",
                testimonial_form_rating_required: "Por favor, selecciona una puntuación.",
                testimonial_form_message: "Tu Comentario",
                testimonial_form_submit: "Enviar Opinión",
                testimonial_form_success: "¡Gracias por tu opinión! Ha sido enviada.",
                testimonial_form_error: "Error al enviar tu opinión. Inténtalo de nuevo.",
                testimonial_signin_google: "Iniciar sesión con Google para opinar",
                testimonial_sign_out: "Cerrar Sesión",
                testimonial_logged_in_as: "Conectado como:",
                testimonial_signin_error: "Error al iniciar sesión con Google.",
                testimonial_login_to_submit: "Por favor, inicia sesión con Google para dejar una opinión.",
                testimonial_storage_error: "El inicio de sesión no pudo completarse. Es posible que la configuración de privacidad de tu navegador (prevención de rastreo o bloqueo de cookies de terceros) esté interfiriendo. Por favor, ajusta la configuración para este sitio e inténtalo de nuevo.",
                testimonials_empty: "Aún no hay testimonios. ¡Sé el primero en dejar tu opinión iniciando sesión!",
                testimonials_load_error: "Error al cargar testimonios.",
                date_unavailable: "Fecha no disponible",
                contact_title: "Contacta con Nosotros",
                contact_form_title: "Envíanos un Mensaje",
                form_name: "Nombre", form_phone: "Teléfono", form_location: "Ubicación del servicio", form_appliance: "Electrodoméstico a reparar o servicio", form_message: "Descripción del problema", form_submit: "Enviar Mensaje",
                loc_barcelona: "Barcelona", loc_coruna: "La Coruña", loc_valencia: "Valencia", loc_castellon: "Castellón de la Plana",
                contact_info_title: "Otras Formas de Contacto",
                contact_phone_text: "+34 612 548 508", contact_email_text: "serviciotecnico.erb@gmail.com", contact_whatsapp_text: "Chatea con nosotros en WhatsApp",
                contact_areas: "Servicio en: Barcelona, Coruña, Valencia y Castellón de la Plana", contact_map_title: "Nuestra Área de Cobertura",
                footer_copyright: "© 2025 ERB Servicio Técnico de Electrodomésticos | BARCELONA – CORUÑA – VALENCIA – CASTELLÓN de la Plana",
                footer_privacy: "Política de Privacidad", footer_legal: "Aviso Legal", footer_cookies: "Política de Cookies",
                form_sending: "Enviando...", 
                form_success: "¡Mensaje enviado con éxito! En breve nos contactaremos.", 
                form_error: "Error al enviar el mensaje. Por favor, inténtalo de nuevo más tarde.",
                form_success_modal_title: "¡Enviado con Éxito!",
                form_success_modal_text: "Gracias por tu mensaje. En breve nos pondremos en contacto contigo.",
                form_success_modal_close: "Cerrar",
                cookie_banner_text: "Este sitio web utiliza cookies para asegurar la mejor experiencia. Al continuar navegando, aceptas su uso, incluidas cookies para Google Analytics y Google Ads. Consulta nuestra",
                cookie_banner_policy_link: "política de cookies",
                cookie_banner_accept: "Aceptar",
                map_error_title: "Error al cargar el mapa:",
                map_error_text: "El mapa no se puede mostrar en este momento. Si eres el administrador del sitio, asegúrate de que la URL actual esté autorizada en la configuración de la clave API de Google Maps en Google Cloud Console.",
                map_error_url_is: "URL actual para autorizar:",
            },
            ca: { 
                company_name_header: "ERB Servei Tècnic",
                nav_home: "Inici", nav_services: "Serveis", nav_benefits: "Beneficis", nav_brands: "Marques", nav_about: "Sobre Nosaltres", nav_testimonials: "Testimonis", nav_contact: "Contacte",
                nav_home_mobile: "Inici", nav_services_mobile: "Serveis", nav_benefits_mobile: "Beneficis", nav_brands_mobile: "Marques", nav_about_mobile: "Sobre Nosaltres", nav_testimonials_mobile: "Testimonis", nav_contact_mobile: "Contacte",
                hero_h1: "Reparació d'Electrodomèstics: ERB Servei Tècnic",
                hero_subtitle: "Especialistes en reparació i manteniment d'electrodomèstics de gamma blanca, industrial i instal·lació d'aires condicionats.",
                hero_cta: "Sol·licita Pressupost",
                services_title: "Els Nostres Serveis",
                services_intro: "Solucions expertes per a tota mena d'electrodomèstics i climatització.",
                filter_all: "Tots", filter_domestic: "Domèstic", filter_industrial: "Industrial",
                service_fridge_title: "Reparació de Frigorífics i Congeladors", service_fridge_desc: "Solucions per a problemes de refredament, fuites i més en els teus equips de refrigeració domèstics.",
                service_ac_title: "Instal·lació i Reparació d'Aires Condicionats", service_ac_desc: "Servei complet per a sistemes de climatització domèstics i industrials, garantint confort.",
                service_washing_machine_title: "Reparació de Rentadores", service_washing_machine_desc: "Arreglem problemes de centrifugat, desguàs, i qualsevol avaria a la teva rentadora.",
                service_dishwasher_title: "Reparació de Rentavaixelles", service_dishwasher_desc: "Solucionem errades de neteja, fuites o problemes elèctrics al teu rentavaixelles.",
                service_oven_title: "Reparació de Forns", service_oven_desc: "Reparem forns que no escalfen, problemes con el termòstat o errades electròniques.",
                service_dryer_title: "Reparació d'Assecadores", service_dryer_desc: "Solucions per a assecadores que no assequen, fan soroll o no s'engeguen.",
                service_cooktop_title: "Reparació de Vitroceràmiques", service_cooktop_desc: "Reparem vitroceràmiques d'inducció, elèctriques, amb problemes als fogons o controls.",
                service_water_heater_title: "Reparació d'Escalfadors d'Aigua", service_water_heater_desc: "Servei tècnic per a escalfadors de gas o elèctrics, problemes d'encesa o fuites.",
                service_boiler_title: "Reparació de Calderes", service_boiler_desc: "Especialistes en calderes de gas o gasoil, solucionem avaries i realitzem manteniment.",
                service_thermotank_title: "Reparació de Termos Elèctrics", service_thermotank_desc: "Reparació i manteniment de termos elèctrics, problemes de temperatura o pèrdues.",
                service_industrial_laundry_title: "Reparació de Maquinària de Bugaderia Industrial", service_industrial_laundry_desc: "Servei tècnic per a rentadores, assecadores i planxadores industrials.",
                service_industrial_fridge_title: "Reparació d'Equips de Refrigeració Industrial", service_industrial_fridge_desc: "Manteniment i reparació de cambres frigorífiques, congeladors i vitrines industrials.",
                service_industrial_boiler_title: "Reparació de Calderes Industrials", service_industrial_boiler_desc: "Solucions per a calderes de vapor, aigua calenta i altres sistemes industrials.",
                benefits_title: "Per Què Triar-nos",
                benefit1_title: "Atenció Immediata", benefit1_desc: "Sol·licita la teva inspecció trucant als nostres canals d'atenció al client.",
                benefit2_title: "Sense Cost de Desplaçament", benefit2_desc: "Reparació a l'acte si decideixes reparar, no cobrem el desplaçament.",
                benefit3_title: "Garantia de 6 Mesos", benefit3_desc: "Gaudeix del teu electrodomèstic com nou amb garantia en la reparació de 6 mesos.",
                benefit4_title: "Preus Competitius", benefit4_desc: "Preus competitius en totes les reparacions d'electrodomèstics.",
                brands_title: "Treballem amb les Millors Marques",
                about_title: "Sobre Nosaltres",
                about_text_p1: "Som un equip de tècnics especialitzats amb anys d'experiència en la reparació i manteniment d'electrodomèstics de gamma blanca, tant domèstics com industrials, així com en la instal·lació d'aires condicionats.",
                about_text_p2: "El nostre compromís és oferir un servei ràpid, eficient i amb garantia, assegurant la màxima satisfacció dels nostres clients a Barcelona, Corunya, València i Castelló de la Plana.",
                about_text_p3: "Confia en nosaltres per tornar-li la vida als teus electrodomèstics.",
                testimonials_title: "Opinions dels Nostres Clients",
                testimonial_form_title: "Deixa la Teva Opinió",
                testimonial_form_name: "El Teu Nom",
                testimonial_form_rating: "La Teva Puntuació",
                testimonial_form_rating_required: "Si us plau, selecciona una puntuació.",
                testimonial_form_message: "El Teu Comentari",
                testimonial_form_submit: "Enviar Opinió",
                testimonial_form_success: "Gràcies per la teva opinió! S'ha enviat correctament.",
                testimonial_form_error: "Error en enviar la teva opinió. Intenta-ho de nou.",
                testimonial_signin_google: "Iniciar sessió amb Google per opinar",
                testimonial_sign_out: "Tancar Sessió",
                testimonial_logged_in_as: "Connectat com:",
                testimonial_signin_error: "Error en iniciar sessió amb Google.",
                testimonial_login_to_submit: "Si us plau, inicia sessió amb Google per deixar una opinió.",
                testimonial_storage_error: "L'inici de sessió no s'ha pogut completar. És possible que la configuració de privadesa del teu navegador (prevenció de rastreig o bloqueig de galetes de tercers) estigui interferint. Si us plau, ajusta la configuració per a aquest lloc i torna-ho a provar.",
                testimonials_empty: "Encara no hi ha testimonis. Sigues el primer a deixar la teva opinió iniciant sessió!",
                testimonials_load_error: "Error en carregar els testimonis.",
                date_unavailable: "Data no disponible",
                contact_title: "Contacta amb Nosaltres",
                contact_form_title: "Envia'ns un Missatge",
                form_name: "Nom", form_phone: "Telèfon", form_location: "Ubicació del servei", form_appliance: "Electrodomèstic a reparar o servei", form_message: "Descripció del problema", form_submit: "Enviar Missatge",
                loc_barcelona: "Barcelona", loc_coruna: "La Corunya", loc_valencia: "València", loc_castellon: "Castelló de la Plana",
                contact_info_title: "Altres Formes de Contacte",
                contact_phone_text: "+34 612 548 508", contact_email_text: "serviciotecnico.erb@gmail.com", contact_whatsapp_text: "Xateja amb nosaltres a WhatsApp",
                contact_areas: "Servei a: Barcelona, Corunya, València i Castelló de la Plana", contact_map_title: "Les Nostres Àrees de Servei",
                footer_copyright: "© 2025 ERB Servei Tècnic d'Electrodomèstics | BARCELONA – CORUNYA – VALÈNCIA – CASTELLÓ de la Plana",
                footer_privacy: "Política de Privacitat", footer_legal: "Avís Legal", footer_cookies: "Política de Galetes",
                form_sending: "Enviant...", 
                form_success: "Missatge enviat amb èxit! Aviat ens posarem en contacte.",
                form_error: "Error en l'enviament del missatge. Si us plau, intenta-ho de nou més tard.",
                form_success_modal_title: "Enviat amb Èxit!",
                form_success_modal_text: "Gràcies pel teu missatge. Aviat ens posarem en contacte amb tu.",
                form_success_modal_close: "Tancar",
                cookie_banner_text: "Aquest lloc web utilitza galetes per assegurar la millor experiència. En continuar navegant, n'acceptes l'ús, incloses galetes per a Google Analytics i Google Ads. Consulta la nostra",
                cookie_banner_policy_link: "política de galetes",
                cookie_banner_accept: "Acceptar",
                map_error_title: "Error en carregar el mapa:",
                map_error_text: "El mapa no es pot mostrar en aquest moment. Si ets l'administrador del lloc, assegura't que la URL actual estigui autoritzada a la configuració de la clau API de Google Maps a Google Cloud Console.",
                map_error_url_is: "URL actual per autoritzar:",
            },
            va: { 
                company_name_header: "ERB Servei Tècnic",
                nav_home: "Inici", nav_services: "Serveis", nav_benefits: "Beneficis", nav_brands: "Marques", nav_about: "Sobre Nosaltres", nav_testimonials: "Testimonis", nav_contact: "Contacte",
                nav_home_mobile: "Inici", nav_services_mobile: "Serveis", nav_benefits_mobile: "Beneficis", nav_brands_mobile: "Marques", nav_about_mobile: "Sobre Nosaltres", nav_testimonials_mobile: "Testimonis", nav_contact_mobile: "Contacte",
                hero_h1: "Reparació d'Electrodomèstics: ERB Servei Tècnic",
                hero_subtitle: "Especialistes en reparació i manteniment d'aparells electrodomèstics de gamma blanca, industrial i instal·lació d'aires condicionats.",
                hero_cta: "Sol·licita Pressupost",
                services_title: "Els Nostres Serveis",
                services_intro: "Solucions expertes per a tota classe d'aparells electrodomèstics i climatització.",
                filter_all: "Tots", filter_domestic: "Domèstic", filter_industrial: "Industrial",
                service_fridge_title: "Reparació de Frigorífics i Congeladors", service_fridge_desc: "Solucions per a problemes de refredament, fugues i més en els teus equips de refrigeració domèstics.",
                service_ac_title: "Instal·lació i Reparació d'Aires Condicionats", service_ac_desc: "Servei complet per a sistemes de climatització domèstics i industrials, garantint confort.",
                service_washing_machine_title: "Reparació de Rentadores", service_washing_machine_desc: "Arreglem problemes de centrifugat, desguàs, i qualsevol avaria a la teua rentadora.",
                service_dishwasher_title: "Reparació de Rentaplats", service_dishwasher_desc: "Solucionem errades de neteja, fugues o problemes elèctrics al teu rentaplats.",
                service_oven_title: "Reparació de Forns", service_oven_desc: "Reparem forns que no calfen, problemes con el termòstat o errades electròniques.",
                service_dryer_title: "Reparació d'Eixugadores", service_dryer_desc: "Solucions per a eixugadores que no eixuguen, fan soroll o no s'encenen.",
                service_cooktop_title: "Reparació de Vitroceràmiques", service_cooktop_desc: "Reparem vitroceràmiques d'inducció, elèctriques, amb problemes als fogons o controls.",
                service_water_heater_title: "Reparació de Calentadors d'Aigua", service_water_heater_desc: "Servei tècnic per a calentadors de gas o elèctrics, problemes d'encesa o fugues.",
                service_boiler_title: "Reparació de Calderes", service_boiler_desc: "Especialistes en calderes de gas o gasoil, solucionem avaries i realitzem manteniment.",
                service_thermotank_title: "Reparació de Termos Elèctrics", service_thermotank_desc: "Reparació i manteniment de termos elèctrics, problemes de temperatura o pèrdues.",
                service_industrial_laundry_title: "Reparació de Maquinària de Bugaderia Industrial", service_industrial_laundry_desc: "Servei tècnic per a rentadores, eixugadores i planxadores industrials.",
                service_industrial_fridge_title: "Reparació d'Equips de Refrigeració Industrial", service_industrial_fridge_desc: "Manteniment i reparació de cambres frigorífiques, congeladors i vitrines industrials.",
                service_industrial_boiler_title: "Reparació de Calderes Industrials", service_industrial_boiler_desc: "Solucions per a calderes de vapor, aigua calenta i altres sistemes industrials.",
                benefits_title: "Per Què Triar-nos",
                benefit1_title: "Atenció Immediata", benefit1_desc: "Sol·licita la teua inspecció telefonant als nostres canals d'atenció al client.",
                benefit2_title: "Sense Cost de Desplaçament", benefit2_desc: "Reparació a l'acte si decideixes reparar, no cobrem el desplaçament.",
                benefit3_title: "Garantia de 6 Mesos", benefit3_desc: "Gaudeix del teu aparell electrodomèstic com nou con garantia en la reparació de 6 mesos.",
                benefit4_title: "Preus Competitius", benefit4_desc: "Preus competitius en totes les reparacions d'aparells electrodomèstics.",
                brands_title: "Treballem amb les Millors Marques",
                about_title: "Sobre Nosaltres",
                about_text_p1: "Som un equip de tècnics especialitzats amb anys d'experiència en la reparació i manteniment d'aparells electrodomèstics de gamma blanca, tant domèstics com industrials, així com en la instal·lació d'aires condicionats.",
                about_text_p2: "El nostre compromís és oferir un servei ràpid, eficient i amb garantia, assegurant la màxima satisfacció dels nostres clients a Barcelona, Corunya, València i Castelló de la Plana.",
                about_text_p3: "Confia en nosaltres per tornar-li la vida als teus aparells electrodomèstics.",
                testimonials_title: "Opinions dels Nostres Clients",
                testimonial_form_title: "Deixa la Teua Opinió",
                testimonial_form_name: "El Teu Nom",
                testimonial_form_rating: "La Teua Puntuació",
                testimonial_form_rating_required: "Per favor, selecciona una puntuació.",
                testimonial_form_message: "El Teu Comentari",
                testimonial_form_submit: "Enviar Opinió",
                testimonial_form_success: "Gràcies per la teua opinió! S'ha enviat correctament.",
                testimonial_form_error: "Error en enviar la teua opinió. Intenta-ho de nou.",
                testimonial_signin_google: "Iniciar sessió amb Google per opinar",
                testimonial_sign_out: "Tancar Sessió",
                testimonial_logged_in_as: "Connectat com:",
                testimonial_signin_error: "Error en iniciar sessió con Google.",
                testimonial_login_to_submit: "Per favor, inicia sessió amb Google per deixar una opinió.",
                testimonial_storage_error: "L'inici de sessió no s'ha pogut completar. És possible que la configuració de privadesa del teu navegador (prevenció de rastreig o bloqueig de galetes de tercers) estiga interferint. Per favor, ajusta la configuració per a este lloc i torna-ho a provar.",
                testimonials_empty: "Encara no hi ha testimonis. Sigues el primer a deixar la teua opinió iniciant sessió!",
                testimonials_load_error: "Error en carregar els testimonis.",
                date_unavailable: "Data no disponible",
                contact_title: "Contacta amb Nosaltres",
                contact_form_title: "Envia'ns un Missatge",
                form_name: "Nom", form_phone: "Telèfon", form_location: "Ubicació del servei", form_appliance: "Aparell electrodomèstic a reparar o servei", form_message: "Descripció del problema", form_submit: "Enviar Missatge",
                loc_barcelona: "Barcelona", loc_coruna: "La Corunya", loc_valencia: "València", loc_castellon: "Castelló de la Plana",
                contact_info_title: "Altres Formes de Contacte",
                contact_phone_text: "+34 612 548 508", contact_email_text: "serviciotecnico.erb@gmail.com", contact_whatsapp_text: "Xateja amb nosaltres a WhatsApp",
                contact_areas: "Servei a: Barcelona, Corunya, València i Castelló de la Plana", contact_map_title: "La Nostra Àrea de Cobertura",
                footer_copyright: "© 2025 ERB Servei Tècnic d'Electrodomèstics | BARCELONA – CORUNYA – VALÈNCIA – CASTELLÓ de la Plana",
                footer_privacy: "Política de Privacitat", footer_legal: "Avís Legal", footer_cookies: "Política de Galetes",
                form_sending: "Enviant...", 
                form_success: "Missatge enviat amb èxit! En breu ens posarem en contacte.",
                form_error: "Error en l'enviament del missatge. Per favor, intenta-ho de nou més tard.",
                form_success_modal_title: "Enviat amb Èxit!",
                form_success_modal_text: "Gràcies pel teu missatge. En breu ens posarem en contacte con tu.",
                form_success_modal_close: "Tancar",
                cookie_banner_text: "Este lloc web utilitza galetes per a assegurar la millor experiència. En continuar navegant, n'acceptes l'ús, incloses galetes per a Google Analytics i Google Ads. Consulta la nostra",
                cookie_banner_policy_link: "política de galetes",
                cookie_banner_accept: "Acceptar",
                map_error_title: "Error en carregar el mapa:",
                map_error_text: "El mapa no es pot mostrar en este moment. Si eres l'administrador del lloc, assegura't que la URL actual estiga autoritzada en la configuració de la clau API de Google Maps en Google Cloud Console.",
                map_error_url_is: "URL actual per autoritzar:",
            }
        };

        let currentLanguage = 'es';
        window.translations = translations;
        window.currentLanguage = currentLanguage;


        function setLanguage(lang) {
            currentLanguage = lang; 
            window.currentLanguage = lang; 
            document.documentElement.lang = lang;
            document.body.className = document.body.className.replace(/lang-(es|ca|va)/g, '');
            document.body.classList.add('lang-' + lang);

            document.querySelectorAll('[data-lang]').forEach(element => {
                const key = element.getAttribute('data-lang');
                if (translations[lang] && translations[lang][key]) {
                    element.innerHTML = translations[lang][key];
                } else if (translations.es[key]) { 
                    element.innerHTML = translations.es[key];
                }
            });
            
            const currentLangText = document.getElementById('current-lang-text');
            if(currentLangText) currentLangText.textContent = lang.toUpperCase();
            
            localStorage.setItem('preferredLanguage', lang);
            
            const langDropdown = document.getElementById('language-dropdown');
            if (langDropdown) langDropdown.classList.add('hidden');


            const privacyLink = document.getElementById('privacyLink');
            const legalLink = document.getElementById('legalLink');
            const cookiesLink = document.getElementById('cookiesLink');
            const cookieBannerPolicyLink = document.getElementById('cookieBannerPolicyLink');


            if (lang === 'ca') {
                if (privacyLink) privacyLink.href = '/ca/politica-privacitat.html';
                if (legalLink) legalLink.href = '/ca/avis-legal.html';
                if (cookiesLink) cookiesLink.href = '/ca/politica-galetes.html';
                if (cookieBannerPolicyLink) cookieBannerPolicyLink.href = '/ca/politica-galetes.html';
            } else if (lang === 'va') {
                if (privacyLink) privacyLink.href = '/va/politica-privacitat.html';
                if (legalLink) legalLink.href = '/va/avis-legal.html';
                if (cookiesLink) cookiesLink.href = '/va/politica-galetes.html';
                if (cookieBannerPolicyLink) cookieBannerPolicyLink.href = '/va/politica-galetes.html';
            } else { 
                if (privacyLink) privacyLink.href = '/politica-privacidad.html';
                if (legalLink) legalLink.href = '/aviso-legal.html';
                if (cookiesLink) cookiesLink.href = '/politica-cookies.html';
                if (cookieBannerPolicyLink) cookieBannerPolicyLink.href = '/politica-cookies.html';
            }
            populateApplianceSelect(lang);
            const authMsgP = testimonialAuthMessage.querySelector('p');
             if (authMsgP && translations[currentLanguage] && !auth.currentUser) { 
                 authMsgP.textContent = translations[currentLanguage].testimonial_login_to_submit || "Por favor, inicia sesión con Google para dejar una opinión.";
             }
        }
        
        function populateServiceCards(lang) {
            const serviceListContainer = document.getElementById('service-list');
            if (!serviceListContainer) return;
            serviceListContainer.innerHTML = ''; 
            const currentTranslations = translations[lang] || translations.es;

            allServices.forEach(service => {
                const card = document.createElement('div');
                card.className = 'service-card bg-white p-6 rounded-xl shadow-lg border border-gray-200';
                card.setAttribute('data-type', service.type); 

                const iconHtml = `<div class="text-center mb-4"><i class="fas ${service.icon} text-4xl text-navy"></i></div>`;
                const titleHtml = `<h3 class="text-xl font-semibold text-navy mb-3 text-center">${currentTranslations[service.title_key] || service.title_key}</h3>`;
                const descHtml = `<p class="text-gray-600 text-sm mb-3">${currentTranslations[service.desc_key] || service.desc_key}</p>`;
                
                card.innerHTML = iconHtml + titleHtml + descHtml;
                serviceListContainer.appendChild(card);
            });
        }

        function populateApplianceSelect(lang) {
            const applianceSelect = document.getElementById('equipo');
            if (!applianceSelect) return;
            applianceSelect.innerHTML = ''; 
            const currentTranslations = translations[lang] || translations.es;

            allServices.forEach(service => {
                const option = document.createElement('option');
                option.value = service.id;
                option.textContent = currentTranslations[service.title_key] || service.title_key.replace('service_', '').replace('_title', '').replace(/_/g, ' ');
                applianceSelect.appendChild(option);
            });
        }

        function filterServices(filter) {
            const serviceCards = document.querySelectorAll('#service-list .service-card');
            serviceCards.forEach(card => {
                const cardType = card.getAttribute('data-type');
                if (filter === 'all' || cardType.includes(filter)) {
                    card.classList.remove('service-hidden');
                } else {
                    card.classList.add('service-hidden');
                }
            });

            document.querySelectorAll('.filter-btn').forEach(btn => {
                btn.classList.remove('active');
                if (btn.getAttribute('data-filter') === filter) {
                    btn.classList.add('active');
                }
            });
        }

        function handleCookieBanner() {
            const banner = document.getElementById('cookie-banner');
            const acceptBtn = document.getElementById('accept-cookies-btn');

            if (!banner || !acceptBtn) return;

            const cookiesAccepted = localStorage.getItem('erbCookiesAccepted');

            if (!cookiesAccepted) {
                banner.style.display = 'flex';
            }

            acceptBtn.addEventListener('click', () => {
                localStorage.setItem('erbCookiesAccepted', 'true');
                banner.style.display = 'none';
            });
        }


        document.addEventListener('DOMContentLoaded', () => {
            const langButton = document.getElementById('language-selector-btn');
            const langDropdown = document.getElementById('language-dropdown');
            
            if (langButton && langDropdown) {
                langButton.addEventListener('click', () => {
                    langDropdown.classList.toggle('hidden');
                });

                document.addEventListener('click', (event) => {
                    if (langButton && !langButton.contains(event.target) && langDropdown && !langDropdown.contains(event.target)) {
                        langDropdown.classList.add('hidden');
                    }
                });
            }


            document.querySelectorAll('#language-dropdown a').forEach(link => {
                link.addEventListener('click', (e) => {
                    e.preventDefault();
                    const lang = e.target.getAttribute('data-lang-option');
                    setLanguage(lang);
                    populateServiceCards(lang); 
                });
            });
            
            const preferredLanguage = localStorage.getItem('preferredLanguage') || 'es';
            setLanguage(preferredLanguage); 
            populateServiceCards(preferredLanguage); 
            populateApplianceSelect(preferredLanguage); 

            document.querySelectorAll('.filter-btn').forEach(button => {
                button.addEventListener('click', () => {
                    const filter = button.getAttribute('data-filter');
                    filterServices(filter);
                });
            });
            filterServices('all'); 


            document.querySelectorAll('a[href^="#"]').forEach(anchor => {
                anchor.addEventListener('click', function (e) {
                    e.preventDefault();
                    const targetId = this.getAttribute('href');
                    try {
                        const targetElement = document.querySelector(targetId);
                        if (targetElement) {
                            targetElement.scrollIntoView({ behavior: 'smooth' });
                        }
                    } catch(error) {
                        console.warn("Error scrolling to anchor:", targetId, error);
                    }
                    const mobileMenu = document.getElementById('mobile-menu');
                    if (mobileMenu && mobileMenu.classList.contains('open')) {
                        mobileMenu.classList.remove('open');
                    }
                });
            });

            const mobileMenuButton = document.getElementById('mobile-menu-button');
            const closeMobileMenuButton = document.getElementById('close-mobile-menu-button');
            const mobileMenu = document.getElementById('mobile-menu');

            if (mobileMenuButton && mobileMenu) {
                mobileMenuButton.addEventListener('click', () => { mobileMenu.classList.add('open'); });
            }
            if (closeMobileMenuButton && mobileMenu) {
                closeMobileMenuButton.addEventListener('click', () => { mobileMenu.classList.remove('open'); });
            }
            

            handleCookieBanner();

            const contactForm = document.getElementById('contactForm');
            const loadingSpinner = document.getElementById('loading-spinner');
            const successModal = document.getElementById('success-message-modal');
            const closeSuccessModalBtn = document.getElementById('close-success-modal-btn');
            const formStatusDiv = document.getElementById('form-status');
            const submitButton = document.getElementById('submit-contact-form');

            if (contactForm && loadingSpinner && successModal && closeSuccessModalBtn && formStatusDiv && submitButton) {
                contactForm.addEventListener('submit', function(event) {
                    event.preventDefault(); 

                    loadingSpinner.classList.remove('hidden');
                    submitButton.disabled = true;
                    submitButton.classList.add('opacity-50', 'cursor-not-allowed');
                    formStatusDiv.textContent = ''; 

                    const formData = new FormData(contactForm);
                    const formAction = contactForm.getAttribute('action');

                    fetch(formAction, {
                        method: 'POST',
                        body: formData,
                        headers: {
                            'Accept': 'application/json'
                        }
                    })
                    .then(response => response.json())
                    .then(data => {
                        loadingSpinner.classList.add('hidden');
                        submitButton.disabled = false;
                        submitButton.classList.remove('opacity-50', 'cursor-not-allowed');

                        if (data.success || (data.ok && data.ok === true) ) { 
                            contactForm.reset(); 
                            const modalTitle = successModal.querySelector('[data-lang="form_success_modal_title"]');
                            const modalText = successModal.querySelector('[data-lang="form_success_modal_text"]');
                            const modalCloseBtn = successModal.querySelector('[data-lang="form_success_modal_close"]');

                            if (translations[currentLanguage] && translations[currentLanguage]['form_success_modal_title']) {
                                modalTitle.textContent = translations[currentLanguage]['form_success_modal_title'];
                                modalText.textContent = translations[currentLanguage]['form_success_modal_text'];
                                modalCloseBtn.textContent = translations[currentLanguage]['form_success_modal_close'];
                            } else { 
                                modalTitle.textContent = translations.es['form_success_modal_title'];
                                modalText.textContent = translations.es['form_success_modal_text'];
                                modalCloseBtn.textContent = translations.es['form_success_modal_close'];
                            }
                            successModal.classList.remove('hidden');
                        } else {
                            formStatusDiv.textContent = translations[currentLanguage]?.form_error || translations.es.form_error;
                            formStatusDiv.classList.remove('text-green-400'); 
                            formStatusDiv.classList.add('text-red-400');
                            console.error('Formsubmit.co reportó un error o formato de respuesta inesperado:', data);
                        }
                    })
                    .catch(error => {
                        loadingSpinner.classList.add('hidden');
                        submitButton.disabled = false;
                        submitButton.classList.remove('opacity-50', 'cursor-not-allowed');
                        formStatusDiv.textContent = translations[currentLanguage]?.form_error || translations.es.form_error;
                        formStatusDiv.classList.remove('text-green-400');
                        formStatusDiv.classList.add('text-red-400');
                        console.error('Error al enviar el formulario:', error);
                    });
                });
                
                if(closeSuccessModalBtn) {
                    closeSuccessModalBtn.addEventListener('click', () => {
                        successModal.classList.add('hidden');
                    });
                }
            } else {
                console.error("No se encontraron todos los elementos necesarios para el formulario de contacto mejorado.");
            }
        });
    </script>
    
    <script>
        window.gm_authFailure = function() {
            const mapErrorMessageDiv = document.getElementById('map-error-message');
            const mapCurrentUrlSpan = document.getElementById('map-current-url');
            if (mapErrorMessageDiv) {
                mapErrorMessageDiv.classList.remove('hidden');
                if (mapCurrentUrlSpan) {
                    mapCurrentUrlSpan.textContent = window.location.href;
                }
                const errorTitle = mapErrorMessageDiv.querySelector('[data-lang="map_error_title"]');
                const errorText = mapErrorMessageDiv.querySelector('[data-lang="map_error_text"]');
                const errorUrlIs = mapErrorMessageDiv.querySelector('[data-lang="map_error_url_is"]');
                if (window.translations && window.currentLanguage) { 
                    if (errorTitle) errorTitle.textContent = window.translations[window.currentLanguage]?.map_error_title || window.translations.es.map_error_title;
                    if (errorText) errorText.textContent = window.translations[window.currentLanguage]?.map_error_text || window.translations.es.map_error_text;
                    if (errorUrlIs) errorUrlIs.textContent = window.translations[window.currentLanguage]?.map_error_url_is || window.translations.es.map_error_url_is;
                }
            }
            console.error("Google Maps API authentication failure. Check RefererNotAllowedMapError or other API key issues in Google Cloud Console.");
        };

        function initMap() {
            const valencia = { lat: 39.4699, lng: -0.3763 }; 
            const sagunto = { lat: 39.6815, lng: -0.2776 }; 

            const mapElement = document.getElementById("map");
            const mapErrorMessageDiv = document.getElementById('map-error-message');
            const mapCurrentUrlSpan = document.getElementById('map-current-url');

            if (!mapElement) {
                console.error("Elemento del mapa no encontrado");
                return;
            }
            
            try {
                if (typeof google === 'undefined' || typeof google.maps === 'undefined' || typeof google.maps.Map === 'undefined') {
                    console.error("Google Maps API no cargada o incompleta.");
                    if (mapErrorMessageDiv) mapErrorMessageDiv.classList.remove('hidden');
                    if (mapCurrentUrlSpan) mapCurrentUrlSpan.textContent = window.location.href;
                    return;
                }

                const map = new google.maps.Map(mapElement, {
                    zoom: 10, 
                    center: valencia,
                    mapTypeId: 'roadmap', 
                    styles: [ 
                        { featureType: "water", elementType: "geometry", stylers: [{ color: "#e9e9e9" }, { lightness: 17 }] },
                        { featureType: "landscape", elementType: "geometry", stylers: [{ color: "#f5f5f5" }, { lightness: 20 }] },
                        { featureType: "road.highway", elementType: "geometry.fill", stylers: [{ color: "#ffffff" }, { lightness: 17 }] },
                        { featureType: "road.highway", elementType: "geometry.stroke", stylers: [{ color: "#ffffff" }, { lightness: 29 }, { weight: 0.2 }] },
                        { featureType: "road.arterial", elementType: "geometry", stylers: [{ color: "#ffffff" }, { lightness: 18 }] },
                        { featureType: "road.local", elementType: "geometry", stylers: [{ color: "#ffffff" }, { lightness: 16 }] },
                        { featureType: "poi", elementType: "geometry", stylers: [{ color: "#f5f5f5" }, { lightness: 21 }] },
                        { featureType: "poi.park", elementType: "geometry", stylers: [{ color: "#dedede" }, { lightness: 21 }] },
                        { elementType: "labels.text.stroke", stylers: [{ visibility: "on" }, { color: "#ffffff" }, { lightness: 16 }] },
                        { elementType: "labels.text.fill", stylers: [{ saturation: 36 }, { color: "#333333" }, { lightness: 40 }] },
                        { elementType: "labels.icon", stylers: [{ visibility: "off" }] },
                        { featureType: "transit", elementType: "geometry", stylers: [{ color: "#f2f2f2" }, { lightness: 19 }] },
                        { featureType: "administrative", elementType: "geometry.fill", stylers: [{ color: "#fefefe" }, { lightness: 20 }] },
                        { featureType: "administrative", elementType: "geometry.stroke", stylers: [{ color: "#fefefe" }, { lightness: 17 }, { weight: 1.2 }] }
                    ]
                });
                
                if (google.maps.geometry && google.maps.geometry.spherical) {
                     const radiusInMeters = google.maps.geometry.spherical.computeDistanceBetween(
                        new google.maps.LatLng(valencia),
                        new google.maps.LatLng(sagunto) 
                    );

                    new google.maps.Circle({
                        strokeColor: "#001f3f", 
                        strokeOpacity: 0.8,
                        strokeWeight: 2,
                        fillColor: "#007bff", 
                        fillOpacity: 0.25, 
                        map: map,
                        center: valencia,
                        radius: radiusInMeters, 
                    });
                } else {
                    console.warn("Librería 'geometry' de Google Maps no disponible para calcular el radio del círculo.");
                }

                new google.maps.Marker({
                    position: valencia,
                    map: map,
                    title: "Valencia (Centro de Cobertura)",
                    icon: { 
                        path: google.maps.SymbolPath.CIRCLE,
                        scale: 6,
                        fillColor: "#001f3f",
                        fillOpacity: 1,
                        strokeWeight: 0
                    }
                });
                if (mapErrorMessageDiv) mapErrorMessageDiv.classList.add('hidden');

            } catch (e) {
                console.error("Error inicializando Google Maps:", e);
                 if (mapErrorMessageDiv) mapErrorMessageDiv.classList.remove('hidden');
                 if (mapCurrentUrlSpan) mapCurrentUrlSpan.textContent = window.location.href;
            }
        }
        window.initMap = initMap;
    </script>
    <script async src="https://maps.googleapis.com/maps/api/js?key=AIzaSyDz_erEiiEvZlRfOhnRCt-Ooz5yM9rBrgk&libraries=geometry&callback=initMap&onerror=gm_authFailure"></script>

</body>
</html>
```

**Cambios Clave Realizados en el Script de Firebase:**

1.  **`setPersistence(auth, browserSessionPersistence)`:**
    * Antes de intentar `getRedirectResult` o `signInWithRedirect`, ahora se llama a `setPersistence` para intentar usar `sessionStorage` en lugar de `localStorage`. Esto a veces es menos propenso a ser bloqueado por configuraciones de privacidad estrictas.
2.  **Manejo de Errores de Persistencia/Redirección Mejorado:**
    * Se ha añadido un manejo de errores más específico en el bloque `.catch()` después de `getRedirectResult`. Si detecta un error relacionado con el almacenamiento, mostrará un mensaje más útil al usuario (usando la nueva clave de traducción `testimonial_storage_error`).
3.  **Llamada a `setPersistence` antes de `signInWithRedirect`:**
    * Al hacer clic en el botón de inicio de sesión con Google, también se intenta establecer la persistencia a `session` antes de llamar a `signInWithRedirect`.

**Nueva Clave de Traducción Necesaria:**

Asegúrate de añadir esta nueva clave a tus objetos de traducción (especialmente para `es`, `ca`, y `va`):

* **`testimonial_storage_error`**:
    * `es`: "El inicio de sesión no pudo completarse. Es posible que la configuración de privacidad de tu navegador (prevención de rastreo o bloqueo de cookies de terceros) esté interfiriendo. Por favor, ajusta la configuración para este sitio e inténtalo de nuevo."
    * `ca`: "L'inici de sessió no s'ha pogut completar. És possible que la configuració de privadesa del teu navegador (prevenció de rastreig o bloqueig de galetes de tercers) estigui interferint. Si us plau, ajusta la configuració per a aquest lloc i torna-ho a provar."
    * `va`: "L'inici de sessió no s'ha pogut completar. És possible que la configuració de privadesa del teu navegador (prevenció de rastreig o bloqueig de galetes de tercers) estiga interferint. Per favor, ajusta la configuració per a este lloc i torna-ho a provar."

**Qué hacer ahora:**

1.  **Actualiza tu código** con esta nueva versión.
2.  **Añade la nueva clave de traducción** `testimonial_storage_error` a tus objetos `translations` para todos los idiomas.
3.  **Prueba de nuevo el inicio de sesión con Google.**
4.  **Si sigue fallando, revisa la consola del navegador.** El nuevo mensaje de error podría darte más pistas o confirmar si es un problema de almacenamiento/privacidad del navegador.

Si el problema persiste y la consola sigue indicando un bloqueo de almacenamiento o un error en `setPersistence` o `getRedirectResult` relacionado con el entorno, la solución definitiva seguirá siendo **ajustar la configuración de privacidad de tu navegador para `erbserviciotecnico.com` y los dominios de Google/Firebase**, permitiendo las cookies y el almacenamiento necesarios para el flujo de autenticación. Este cambio en el código es un intento de mitigar el problema, pero no puede sobrepasar las restricciones impuestas por el navegad
