<!DOCTYPE html>
<html lang="es" class="scroll-smooth">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Reparación Electrodomésticos | ERB Servicio Técnico Gama Blanca</title>
    <meta name="description" content="Servicio técnico experto en reparación de electrodomésticos de gama blanca, industrial e instalación de aires acondicionados. ¡Soluciones rápidas y con garantía!">
    <link rel="canonical" href="https://erbserviciotecnico.com/">
    <link rel="icon" href="/favicon.ico">

    <script src="https://cdn.tailwindcss.com"></script>
    
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        navy: { DEFAULT: '#001f3f', light: '#003366', dark: '#00152b' },
                        gold: '#f5b301'
                    },
                    fontFamily: { sans: ['Inter', 'sans-serif'] },
                    animation: {
                        'blob': 'blob 7s infinite',
                        'fade-in-up': 'fadeInUp 0.8s cubic-bezier(0.16, 1, 0.3, 1) forwards',
                        'zoom-slow': 'zoomSlow 20s linear infinite alternate',
                    },
                    keyframes: {
                        blob: {
                            '0%': { transform: 'translate(0px, 0px) scale(1)' },
                            '33%': { transform: 'translate(30px, -50px) scale(1.1)' },
                            '66%': { transform: 'translate(-20px, 20px) scale(0.9)' },
                            '100%': { transform: 'translate(0px, 0px) scale(1)' },
                        },
                        fadeInUp: {
                            '0%': { opacity: '0', transform: 'translateY(20px)', filter: 'blur(5px)' },
                            '100%': { opacity: '1', transform: 'translateY(0)', filter: 'blur(0)' },
                        },
                        zoomSlow: {
                            '0%': { transform: 'scale(1)' },
                            '100%': { transform: 'scale(1.1)' },
                        }
                    }
                }
            }
        }
    </script>

    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">

    <script async src="https://www.googletagmanager.com/gtag/js?id=G-TQC24XCERF"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());
      gtag('config', 'G-TQC24XCERF');
    </script>

    <style>
        body { font-family: 'Inter', sans-serif; overflow-x: hidden; }
        .hero-container { position: relative; overflow: hidden; }
        .hero-bg {
            background-image: linear-gradient(to bottom, rgba(0, 31, 63, 0.85), rgba(0, 31, 63, 0.6)), url('/imagen-hero.jpg.jpeg'); 
            background-size: cover; background-position: center; height: 100%; width: 100%; position: absolute; top: 0; left: 0; z-index: 0;
            animation: zoomSlow 20s linear infinite alternate;
        }
        @media (max-width: 768px) { .hero-bg { background-image: linear-gradient(to bottom, rgba(0, 31, 63, 0.85), rgba(0, 31, 63, 0.6)), url('/imagen-hero-movil.jpg'); } }
        
        /* Animaciones High-End */
        .reveal-element { opacity: 0; transform: translateY(30px); filter: blur(5px); transition: all 1s cubic-bezier(0.16, 1, 0.3, 1); }
        .reveal-element.visible { opacity: 1; transform: translateY(0); filter: blur(0); }
        .delay-100 { transition-delay: 100ms; } .delay-200 { transition-delay: 200ms; } .delay-300 { transition-delay: 300ms; }
        
        .btn-premium { position: relative; overflow: hidden; transition: all 0.4s cubic-bezier(0.25, 0.46, 0.45, 0.94); }
        .btn-premium:hover { transform: translateY(-3px); box-shadow: 0 10px 20px -5px rgba(0, 31, 63, 0.4); }
        .hover-lift { transition: transform 0.4s cubic-bezier(0.16, 1, 0.3, 1), box-shadow 0.4s ease; }
        .hover-lift:hover { transform: translateY(-8px) scale(1.01); box-shadow: 0 25px 30px -5px rgba(0, 0, 0, 0.1); }
        
        .section-title { position: relative; display: inline-block; margin-bottom: 1rem; }
        .section-title::after { content: ''; position: absolute; bottom: -10px; left: 50%; transform: translateX(-50%); width: 0; height: 3px; background-color: #001f3f; transition: width 0.6s ease-out; border-radius: 2px; }
        .section-title.visible::after { width: 60px; }

        .star-rating .fa-star { color: #cbd5e1; cursor: pointer; transition: color 0.3s ease, transform 0.3s; }
        .star-rating .fa-star:hover { transform: scale(1.3) rotate(15deg); }
        .star-rating .fa-star.selected { color: #f5b301; }
        
        .hidden { display: none !important; }
    </style>
</head>
<body class="bg-slate-50 text-gray-800 antialiased selection:bg-navy selection:text-white">

    <script type="application/ld+json">
    {
      "@context": "https://schema.org",
      "@type": "LocalBusiness",
      "name": "ERB Servicio Técnico",
      "image": "https://erbserviciotecnico.com/logo.png", 
      "@id": "https://erbserviciotecnico.com/", 
      "url": "https://erbserviciotecnico.com/",
      "telephone": "+34612548508",
      "priceRange": "$$", 
      "address": { "@type": "PostalAddress", "addressCountry": "ES" },
      "areaServed": ["Barcelona", "Coruña", "Valencia", "Castellón de la Plana"],
      "aggregateRating": { "@type": "AggregateRating", "ratingValue": "4.8", "reviewCount": "25" }
    }
    </script>

    <header class="bg-navy/90 backdrop-blur-lg text-white shadow-xl sticky top-0 z-50 transition-all duration-500 border-b border-white/5">
        <div class="container mx-auto px-6 py-4 flex justify-between items-center">
            <a href="#inicio" class="text-2xl font-bold flex items-center group relative z-10">
                <img src="/logo.png" alt="ERB Logo" class="h-10 mr-3 group-hover:opacity-90 transition-opacity drop-shadow-md" onerror="this.onerror=null;this.src='https://placehold.co/100x30/001f3f/ffffff?text=ERB';"> 
                <span data-lang="company_name_header" class="tracking-tight group-hover:text-blue-200 transition-colors">ERB Servicio Técnico</span>
            </a>
            <nav class="hidden lg:flex space-x-2">
                <a href="#inicio" class="relative px-4 py-2 rounded-full text-sm font-medium transition-colors hover:text-white/100 text-white/80 group overflow-hidden"><span class="relative z-10" data-lang="nav_home">Inicio</span><span class="absolute inset-0 bg-white/10 transform scale-x-0 group-hover:scale-x-100 transition-transform origin-left duration-300 rounded-full"></span></a>
                <a href="#servicios" class="relative px-4 py-2 rounded-full text-sm font-medium transition-colors hover:text-white/100 text-white/80 group overflow-hidden"><span class="relative z-10" data-lang="nav_services">Servicios</span><span class="absolute inset-0 bg-white/10 transform scale-x-0 group-hover:scale-x-100 transition-transform origin-left duration-300 rounded-full"></span></a>
                <a href="#beneficios" class="relative px-4 py-2 rounded-full text-sm font-medium transition-colors hover:text-white/100 text-white/80 group overflow-hidden"><span class="relative z-10" data-lang="nav_benefits">Beneficios</span><span class="absolute inset-0 bg-white/10 transform scale-x-0 group-hover:scale-x-100 transition-transform origin-left duration-300 rounded-full"></span></a>
                <a href="#marcas" class="relative px-4 py-2 rounded-full text-sm font-medium transition-colors hover:text-white/100 text-white/80 group overflow-hidden"><span class="relative z-10" data-lang="nav_brands">Marcas</span><span class="absolute inset-0 bg-white/10 transform scale-x-0 group-hover:scale-x-100 transition-transform origin-left duration-300 rounded-full"></span></a>
                <a href="#testimonios" class="relative px-4 py-2 rounded-full text-sm font-medium transition-colors hover:text-white/100 text-white/80 group overflow-hidden"><span class="relative z-10" data-lang="nav_testimonials">Testimonios</span><span class="absolute inset-0 bg-white/10 transform scale-x-0 group-hover:scale-x-100 transition-transform origin-left duration-300 rounded-full"></span></a>
                <a href="#contacto" class="btn-premium bg-white text-navy px-6 py-2 rounded-full text-sm font-bold shadow-lg transform hover:scale-105" data-lang="nav_contact">Contacto</a>
            </nav>
            <div class="flex items-center lg:hidden">
                <div class="relative mr-4">
                    <button id="language-selector-btn" class="flex items-center focus:outline-none bg-white/10 px-3 py-1 rounded-full hover:bg-white/20 transition-colors backdrop-blur-sm">
                        <i class="fas fa-globe mr-2"></i><span id="current-lang-text" class="font-medium">ES</span><i class="fas fa-chevron-down ml-2 text-xs opacity-75"></i>
                    </button>
                    <div id="language-dropdown" class="absolute right-0 mt-2 py-2 w-32 bg-white rounded-xl shadow-2xl z-20 hidden border border-gray-100 overflow-hidden animate-fade-in-up">
                        <a href="#" class="block px-4 py-2 text-sm hover:bg-gray-50 text-gray-800 hover:text-navy transition-colors" data-lang-option="es">Español</a>
                        <a href="#" class="block px-4 py-2 text-sm hover:bg-gray-50 text-gray-800 hover:text-navy transition-colors" data-lang-option="ca">Català</a>
                        <a href="#" class="block px-4 py-2 text-sm hover:bg-gray-50 text-gray-800 hover:text-navy transition-colors" data-lang-option="va">Valencià</a>
                    </div>
                </div>
                <button id="mobile-menu-button" class="focus:outline-none p-2 rounded-lg hover:bg-white/10 transition-colors"><i class="fas fa-bars text-2xl"></i></button>
            </div>
            <div class="hidden lg:block relative ml-4">
                 <button id="language-selector-btn-desktop" class="flex items-center focus:outline-none text-white/70 hover:text-white transition-colors duration-300"><i class="fas fa-globe mr-1"></i><span class="text-sm font-medium">ES</span></button>
            </div>
        </div>
    </header>

    <div id="mobile-menu" class="fixed inset-0 bg-navy/98 backdrop-blur-xl z-50 p-6 lg:hidden flex flex-col transform translate-x-full transition-transform duration-500 cubic-bezier(0.16, 1, 0.3, 1)">
        <div class="flex justify-end mb-8"><button id="close-mobile-menu-button" class="focus:outline-none p-2 rounded-full bg-white/10 hover:bg-white/20 text-white transition-colors"><i class="fas fa-times text-2xl"></i></button></div>
        <nav class="flex flex-col space-y-8 text-center text-white flex-grow justify-center">
            <a href="#inicio" class="text-3xl font-light hover:text-blue-300 transition-colors transform hover:scale-105 duration-300" data-lang="nav_home_mobile">Inicio</a>
            <a href="#servicios" class="text-3xl font-light hover:text-blue-300 transition-colors transform hover:scale-105 duration-300" data-lang="nav_services_mobile">Servicios</a>
            <a href="#beneficios" class="text-3xl font-light hover:text-blue-300 transition-colors transform hover:scale-105 duration-300" data-lang="nav_benefits_mobile">Beneficios</a>
            <a href="#contacto" class="text-2xl font-bold bg-white text-navy py-4 px-10 rounded-full mx-auto inline-block shadow-xl shadow-blue-900/20 mt-6 btn-premium" data-lang="nav_contact_mobile">Contacto</a>
        </nav>
    </div>

    <section id="inicio" class="hero-container text-white min-h-screen flex items-center justify-center relative">
        <div class="hero-bg"></div>
        <div class="container mx-auto px-6 text-center relative z-10 pt-20">
            <span class="inline-block uppercase tracking-[0.2em] text-sm font-semibold mb-6 text-blue-300 animate-[fadeInUp_1s_ease-out_forwards]">Servicio Técnico Oficial</span>
            <h1 class="text-5xl md:text-7xl lg:text-8xl font-bold mb-8 leading-tight drop-shadow-2xl opacity-0 animate-[fadeInUp_1s_ease-out_0.2s_forwards]" data-lang="hero_h1">Reparación de<br>Electrodomésticos</h1>
            <p class="text-xl md:text-2xl mb-12 max-w-3xl mx-auto text-blue-50/90 font-light opacity-0 animate-[fadeInUp_1s_ease-out_0.4s_forwards]" data-lang="hero_subtitle">Especialistas en gama blanca, industrial y climatización. Rapidez, confianza y garantía absoluta.</p>
            <div class="flex flex-col sm:flex-row justify-center gap-6 opacity-0 animate-[fadeInUp_1s_ease-out_0.6s_forwards]">
                <a href="#contacto" class="btn-premium bg-blue-600 hover:bg-blue-700 text-white font-bold py-5 px-12 rounded-full text-lg shadow-2xl hover:shadow-blue-500/40" data-lang="hero_cta">Solicita Presupuesto</a>
                <a href="tel:+34612548508" class="btn-premium bg-white/10 backdrop-blur-md hover:bg-white/20 text-white font-semibold py-5 px-12 rounded-full text-lg border border-white/20 flex items-center justify-center gap-3"><i class="fas fa-phone animate-pulse"></i> <span>Llamar Ahora</span></a>
            </div>
        </div>
        <div class="absolute bottom-10 left-1/2 transform -translate-x-1/2 animate-bounce text-white/50 cursor-pointer hover:text-white transition-colors" onclick="document.getElementById('servicios').scrollIntoView({behavior: 'smooth'})"><i class="fas fa-chevron-down text-3xl"></i></div>
    </section>

    <section id="servicios" class="py-32 bg-slate-50 relative">
        <div class="container mx-auto px-6">
            <div class="text-center mb-20 reveal-element">
                <h2 class="text-4xl md:text-5xl font-bold text-navy section-title" data-lang="services_title">Nuestros Servicios</h2>
                <p class="text-gray-600 max-w-2xl mx-auto text-lg mt-4" data-lang="services_intro">Soluciones técnicas avanzadas para extender la vida útil de sus equipos.</p>
            </div>
            <div class="flex justify-center flex-wrap gap-4 mb-20 reveal-element delay-100">
                <button class="filter-btn active px-8 py-3 rounded-full border border-navy/10 bg-white text-navy font-medium hover:bg-navy hover:text-white transition-all shadow-sm hover:shadow-md" data-filter="all" data-lang="filter_all">Todos</button>
                <button class="filter-btn px-8 py-3 rounded-full border border-navy/10 bg-white text-navy font-medium hover:bg-navy hover:text-white transition-all shadow-sm hover:shadow-md" data-filter="domestico" data-lang="filter_domestic">Doméstico</button>
                <button class="filter-btn px-8 py-3 rounded-full border border-navy/10 bg-white text-navy font-medium hover:bg-navy hover:text-white transition-all shadow-sm hover:shadow-md" data-filter="industrial" data-lang="filter_industrial">Industrial</button>
            </div>
            <div id="service-list" class="grid md:grid-cols-2 lg:grid-cols-3 gap-8"></div>
        </div>
    </section>
    
    <section id="beneficios" class="py-32 bg-white relative overflow-hidden">
        <div class="absolute top-0 left-0 w-96 h-96 bg-blue-100 rounded-full mix-blend-multiply filter blur-3xl opacity-50 animate-blob"></div>
        <div class="absolute top-0 right-0 w-96 h-96 bg-yellow-100 rounded-full mix-blend-multiply filter blur-3xl opacity-50 animate-blob animation-delay-2000"></div>
        <div class="container mx-auto px-6 relative z-10">
            <div class="text-center mb-20 reveal-element"><h2 class="text-4xl md:text-5xl font-bold text-navy section-title" data-lang="benefits_title">Por Qué Elegirnos</h2></div>
            <div class="grid md:grid-cols-2 lg:grid-cols-4 gap-8">
                <div class="benefit-card reveal-element delay-100 p-8 bg-white/80 backdrop-blur-sm rounded-3xl shadow-xl border border-white/50 hover-lift text-center group">
                    <div class="w-20 h-20 mx-auto mb-8 bg-gradient-to-br from-blue-50 to-blue-100 text-navy rounded-2xl flex items-center justify-center text-3xl group-hover:scale-110 transition-all duration-500 shadow-inner"><i class="fas fa-phone-volume"></i></div>
                    <h3 class="text-xl font-bold text-navy mb-4" data-lang="benefit1_title">Atención Inmediata</h3>
                    <p class="text-gray-600 leading-relaxed" data-lang="benefit1_desc">Respuesta rápida a través de nuestros canales oficiales.</p>
                </div>
                <div class="benefit-card reveal-element delay-200 p-8 bg-white/80 backdrop-blur-sm rounded-3xl shadow-xl border border-white/50 hover-lift text-center group">
                    <div class="w-20 h-20 mx-auto mb-8 bg-gradient-to-br from-blue-50 to-blue-100 text-navy rounded-2xl flex items-center justify-center text-3xl group-hover:scale-110 transition-all duration-500 shadow-inner"><i class="fas fa-shipping-fast"></i></div>
                    <h3 class="text-xl font-bold text-navy mb-4" data-lang="benefit2_title">Desplazamiento Gratis</h3>
                    <p class="text-gray-600 leading-relaxed" data-lang="benefit2_desc">Al aceptar el presupuesto de reparación en el acto.</p>
                </div>
                <div class="benefit-card reveal-element delay-300 p-8 bg-white/80 backdrop-blur-sm rounded-3xl shadow-xl border border-white/50 hover-lift text-center group">
                    <div class="w-20 h-20 mx-auto mb-8 bg-gradient-to-br from-blue-50 to-blue-100 text-navy rounded-2xl flex items-center justify-center text-3xl group-hover:scale-110 transition-all duration-500 shadow-inner"><i class="fas fa-shield-alt"></i></div>
                    <h3 class="text-xl font-bold text-navy mb-4" data-lang="benefit3_title">6 Meses de Garantía</h3>
                    <p class="text-gray-600 leading-relaxed" data-lang="benefit3_desc">Tranquilidad total con nuestra garantía extendida.</p>
                </div>
                <div class="benefit-card reveal-element delay-400 p-8 bg-white/80 backdrop-blur-sm rounded-3xl shadow-xl border border-white/50 hover-lift text-center group">
                    <div class="w-20 h-20 mx-auto mb-8 bg-gradient-to-br from-blue-50 to-blue-100 text-navy rounded-2xl flex items-center justify-center text-3xl group-hover:scale-110 transition-all duration-500 shadow-inner"><i class="fas fa-euro-sign"></i></div>
                    <h3 class="text-xl font-bold text-navy mb-4" data-lang="benefit4_title">Precios Justos</h3>
                    <p class="text-gray-600 leading-relaxed" data-lang="benefit4_desc">Tarifas competitivas y transparentes desde el primer momento.</p>
                </div>
            </div>
        </div>
    </section>

    <section id="marcas" class="py-24 bg-gray-50 border-t border-gray-200">
        <div class="container mx-auto px-6 reveal-element">
            <h2 class="text-3xl font-bold text-center mb-16 text-navy" data-lang="brands_title">Expertos en las Mejores Marcas</h2>
            <div class="flex flex-wrap justify-center items-center gap-12 opacity-80">
                <div class="brand-logo p-6 bg-white rounded-2xl shadow-sm hover:shadow-xl transition-all duration-500 hover:-translate-y-2 cursor-pointer grayscale hover:grayscale-0"><img src="/samsung-logo-wordmark-rgb.png" class="h-10 md:h-12 w-auto" alt="Samsung" onerror="this.onerror=null;this.src='https://placehold.co/120x40/ffffff/000000?text=Samsung';"></div>
                <div class="brand-logo p-6 bg-white rounded-2xl shadow-sm hover:shadow-xl transition-all duration-500 hover:-translate-y-2 cursor-pointer grayscale hover:grayscale-0"><img src="/lg-logo-1.png" class="h-10 md:h-12 w-auto" alt="LG" onerror="this.onerror=null;this.src='https://placehold.co/120x40/ffffff/000000?text=LG';"></div>
                <div class="brand-logo p-6 bg-white rounded-2xl shadow-sm hover:shadow-xl transition-all duration-500 hover:-translate-y-2 cursor-pointer grayscale hover:grayscale-0"><img src="/balay.png" class="h-10 md:h-12 w-auto" alt="Balay" onerror="this.onerror=null;this.src='https://placehold.co/120x40/ffffff/000000?text=Balay';"></div>
                <div class="brand-logo p-6 bg-white rounded-2xl shadow-sm hover:shadow-xl transition-all duration-500 hover:-translate-y-2 cursor-pointer grayscale hover:grayscale-0"><img src="/bosch.png" class="h-10 md:h-12 w-auto" alt="Bosch" onerror="this.onerror=null;this.src='https://placehold.co/120x40/ffffff/000000?text=Bosch';"></div>
                <div class="brand-logo p-6 bg-white rounded-2xl shadow-sm hover:shadow-xl transition-all duration-500 hover:-translate-y-2 cursor-pointer grayscale hover:grayscale-0"><img src="/siemens-Photoroom.png" class="h-10 md:h-12 w-auto" alt="Siemens" onerror="this.onerror=null;this.src='https://placehold.co/120x40/ffffff/000000?text=Siemens';"></div>
            </div>
        </div>
    </section>

    <section id="testimonios" class="py-32 bg-white">
        <div class="container mx-auto px-6">
            <div class="text-center mb-20 reveal-element">
                <h2 class="text-4xl md:text-5xl font-bold text-navy section-title" data-lang="testimonials_title">Opiniones de Clientes</h2>
            </div>
            
            <div class="max-w-3xl mx-auto bg-slate-50 p-10 md:p-12 rounded-[2rem] shadow-2xl border border-gray-100 mb-24 relative overflow-hidden reveal-element">
                <div class="relative z-10">
                    <h3 class="text-3xl font-bold text-navy mb-8 text-center" data-lang="testimonial_form_title">Comparte tu Experiencia</h3>
                    
                    <div id="auth-container" class="mb-10 text-center">
                        <div id="user-info" class="hidden mb-6 p-4 bg-blue-50/80 rounded-2xl inline-block border border-blue-100">
                            <p class="text-navy font-medium"><span data-lang="testimonial_logged_in_as">Conectado como:</span> <span id="user-display-name" class="font-bold text-blue-800"></span></p>
                            <button id="signout-btn" class="mt-2 text-xs text-red-500 hover:text-red-700 font-bold uppercase tracking-wider transition-colors" data-lang="testimonial_sign_out">Cerrar Sesión</button>
                        </div>
                        <button id="google-signin-btn" class="group bg-white hover:bg-gray-50 text-gray-700 font-bold py-4 px-8 rounded-full border border-gray-200 shadow-md inline-flex items-center transition-all transform hover:scale-105 hover:shadow-lg">
                            <img src="https://www.gstatic.com/firebasejs/ui/2.0.0/images/auth/google.svg" class="w-6 h-6 mr-3 group-hover:rotate-12 transition-transform" alt="Google">
                            <span data-lang="testimonial_signin_google">Iniciar sesión con Google</span>
                        </button>
                    </div>

                    <form id="testimonialForm" class="space-y-8">
                        <div class="grid md:grid-cols-2 gap-8">
                            <div class="group">
                                <label for="testimonialNombre" class="block text-sm font-bold text-gray-700 mb-2 ml-1" data-lang="testimonial_form_name">Nombre</label>
                                <input type="text" id="testimonialNombre" class="w-full px-6 py-4 rounded-2xl bg-white border border-gray-200 focus:border-navy focus:ring-4 focus:ring-navy/10 outline-none transition-all shadow-sm group-hover:border-gray-300" required>
                            </div>
                            <div>
                                <label class="block text-sm font-bold text-gray-700 mb-2 ml-1" data-lang="testimonial_form_rating">Calificación</label>
                                <div class="star-rating flex items-center justify-between text-2xl bg-white px-6 py-3.5 rounded-2xl border border-gray-200 shadow-sm" id="ratingStars">
                                    <i class="fas fa-star" data-rating="1"></i>
                                    <i class="fas fa-star" data-rating="2"></i>
                                    <i class="fas fa-star" data-rating="3"></i>
                                    <i class="fas fa-star" data-rating="4"></i>
                                    <i class="fas fa-star" data-rating="5"></i>
                                </div>
                                <input type="hidden" id="ratingValue" required>
                                <p id="ratingError" class="text-red-500 text-xs mt-2 hidden ml-1 font-semibold animate-pulse" data-lang="testimonial_form_rating_required">Selecciona una estrella.</p>
                            </div>
                        </div>
                        <div class="group">
                            <label for="testimonialMensaje" class="block text-sm font-bold text-gray-700 mb-2 ml-1" data-lang="testimonial_form_message">Tu Opinión</label>
                            <textarea id="testimonialMensaje" rows="4" class="w-full px-6 py-4 rounded-2xl bg-white border border-gray-200 focus:border-navy focus:ring-4 focus:ring-navy/10 outline-none transition-all shadow-sm resize-none group-hover:border-gray-300" required></textarea>
                        </div>
                        <div class="text-center pt-2">
                            <button type="submit" id="submitTestimonial" class="btn-premium bg-navy hover:bg-blue-900 text-white font-bold py-4 px-12 rounded-full shadow-xl hover:shadow-2xl w-full md:w-auto text-lg" data-lang="testimonial_form_submit"><i class="fas fa-paper-plane mr-2"></i> Enviar Opinión</button>
                        </div>
                        <div id="testimonial-loading-spinner" class="hidden text-center mt-6"><i class="fas fa-circle-notch fa-spin text-navy text-3xl"></i></div>
                        <div id="testimonialFormStatus" class="mt-4 text-center font-bold text-lg"></div>
                    </form>
                </div>
            </div>
            <div id="testimonials-container" class="grid md:grid-cols-2 lg:grid-cols-3 gap-8"></div>
        </div>
    </section>

    <section id="contacto" class="py-32 bg-gradient-to-b from-slate-50 to-slate-200">
        <div class="container mx-auto px-6">
            <div class="text-center mb-20 reveal-element">
                <h2 class="text-4xl md:text-5xl font-bold text-navy section-title" data-lang="contact_title">Contacta con Nosotros</h2>
                <p class="text-gray-600 max-w-xl mx-auto text-lg mt-4">Estamos listos para resolver tu avería hoy mismo.</p>
            </div>
            <div class="grid lg:grid-cols-2 gap-16 items-start">
                <div class="bg-white p-10 md:p-12 rounded-[2.5rem] shadow-2xl border border-white/50 relative overflow-hidden reveal-element delay-100 hover-lift">
                    <div class="absolute top-0 left-0 w-full h-2 bg-gradient-to-r from-navy to-blue-600"></div>
                    <form id="contact-form" action="https://formspree.io/f/mnnjjzpl" method="POST" class="space-y-8">
                        <div class="grid md:grid-cols-2 gap-8">
                            <div><label for="nombre" class="block text-sm font-bold text-gray-700 mb-2 ml-1" data-lang="form_name">Nombre Completo</label><input type="text" name="nombre" id="nombre" required class="w-full px-6 py-4 rounded-2xl bg-gray-50 border border-gray-100 focus:bg-white focus:border-navy focus:ring-4 focus:ring-navy/10 outline-none transition-all duration-300"></div>
                            <div><label for="telefono" class="block text-sm font-bold text-gray-700 mb-2 ml-1" data-lang="form_phone">Teléfono</label><input type="tel" name="telefono" id="telefono" required class="w-full px-6 py-4 rounded-2xl bg-gray-50 border border-gray-100 focus:bg-white focus:border-navy focus:ring-4 focus:ring-navy/10 outline-none transition-all duration-300"></div>
                        </div>
                        <div>
                            <label for="ubicacion" class="block text-sm font-bold text-gray-700 mb-2 ml-1" data-lang="form_location">¿Dónde te encuentras?</label>
                            <div class="relative"><select name="ubicacion" id="ubicacion" class="w-full px-6 py-4 rounded-2xl bg-gray-50 border border-gray-100 focus:bg-white focus:border-navy focus:ring-4 focus:ring-navy/10 outline-none transition-all duration-300 appearance-none cursor-pointer"><option value="barcelona" data-lang="loc_barcelona">Barcelona</option><option value="la_coruna" data-lang="loc_coruna">La Coruña</option><option value="valencia" data-lang="loc_valencia">Valencia</option><option value="castellon" data-lang="loc_castellon">Castellón de la Plana</option></select><div class="absolute inset-y-0 right-0 flex items-center px-6 pointer-events-none text-navy"><i class="fas fa-chevron-down"></i></div></div>
                        </div>
                        <div>
                            <label for="equipo" class="block text-sm font-bold text-gray-700 mb-2 ml-1" data-lang="form_appliance">Tipo de Servicio</label>
                            <div class="relative"><select name="equipo" id="equipo" required class="w-full px-6 py-4 rounded-2xl bg-gray-50 border border-gray-100 focus:bg-white focus:border-navy focus:ring-4 focus:ring-navy/10 outline-none transition-all duration-300 appearance-none cursor-pointer"></select><div class="absolute inset-y-0 right-0 flex items-center px-6 pointer-events-none text-navy"><i class="fas fa-chevron-down"></i></div></div>
                        </div>
                        <div><label for="mensaje" class="block text-sm font-bold text-gray-700 mb-2 ml-1" data-lang="form_message">Descripción del Problema</label><textarea name="mensaje" id="mensaje" rows="4" required class="w-full px-6 py-4 rounded-2xl bg-gray-50 border border-gray-100 focus:bg-white focus:border-navy focus:ring-4 focus:ring-navy/10 outline-none transition-all duration-300 resize-none"></textarea></div>
                        <button type="submit" class="btn-premium w-full bg-navy hover:bg-blue-900 text-white font-bold py-5 px-8 rounded-full shadow-xl hover:shadow-2xl transition-all transform text-lg"><span data-lang="form_submit">Solicitar Reparación</span></button>
                    </form>
                </div>
                <div class="space-y-8 reveal-element delay-200">
                    <div class="bg-white p-10 rounded-[2.5rem] shadow-xl border border-gray-100 hover-lift group">
                        <h3 class="text-2xl font-bold text-navy mb-8 pl-2 border-l-4 border-gold" data-lang="contact_info_title">Información de Contacto</h3>
                        <ul class="space-y-8">
                            <li class="flex items-center group-hover:translate-x-2 transition-transform duration-300"><div class="w-14 h-14 rounded-2xl bg-blue-50 flex items-center justify-center text-navy mr-6 shadow-sm"><i class="fas fa-phone-alt text-xl"></i></div><span class="text-xl font-medium text-gray-700" data-lang="contact_phone_text">+34 612 548 508</span></li>
                            <li class="flex items-center group-hover:translate-x-2 transition-transform duration-300 delay-75"><div class="w-14 h-14 rounded-2xl bg-blue-50 flex items-center justify-center text-navy mr-6 shadow-sm"><i class="fas fa-envelope text-xl"></i></div><span class="text-xl font-medium text-gray-700 break-all" data-lang="contact_email_text">serviciotecnico.erb@gmail.com</span></li>
                            <li class="flex items-center group-hover:translate-x-2 transition-transform duration-300 delay-100"><div class="w-14 h-14 rounded-2xl bg-green-50 flex items-center justify-center text-green-600 mr-6 shadow-sm"><i class="fab fa-whatsapp text-3xl"></i></div><a href="https://wa.me/34612548508" target="_blank" class="text-xl font-bold text-green-600 hover:text-green-700 transition-colors" data-lang="contact_whatsapp_text">WhatsApp Directo</a></li>
                        </ul>
                    </div>
                    <div class="bg-white p-3 rounded-[2.5rem] shadow-xl border border-gray-100 overflow-hidden hover-lift">
                        <div id="map-container" class="relative rounded-[2rem] overflow-hidden">
                            <div id="map" class="h-96 w-full filter grayscale hover:grayscale-0 transition-all duration-700"></div>
                            <div id="map-error-message" class="hidden absolute inset-0 bg-gray-50 flex flex-col justify-center items-center text-center p-4"><i class="fas fa-map-marked-alt text-5xl text-gray-300 mb-4"></i><p class="text-gray-500 font-semibold" data-lang="map_error_title">Mapa no disponible</p></div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <footer class="bg-navy-dark text-gray-400 py-20 border-t border-gray-800 relative overflow-hidden" style="background-color: #00152b;">
        <div class="absolute inset-0 bg-[url('/pattern.png')] opacity-5"></div>
        <div class="container mx-auto px-6 text-center relative z-10">
            <img src="/logo.png" alt="ERB Logo" class="h-16 mx-auto mb-10 opacity-60 hover:opacity-100 transition-all duration-500 filter grayscale hover:grayscale-0">
            <p id="footer-copyright-text" class="mb-8 text-sm tracking-wide" data-lang="footer_copyright">© 2025 ERB Servicio Técnico de Electrodomésticos</p>
            <div class="flex flex-wrap justify-center gap-8 text-sm font-medium">
                <a href="/politica-privacidad.html" class="hover:text-white transition-colors hover:underline underline-offset-4" data-lang="footer_privacy">Política de Privacidad</a>
                <a href="/aviso-legal.html" class="hover:text-white transition-colors hover:underline underline-offset-4" data-lang="footer_legal">Aviso Legal</a>
                <a href="/politica-cookies.html" class="hover:text-white transition-colors hover:underline underline-offset-4" data-lang="footer_cookies">Política de Cookies</a>
            </div>
        </div>
    </footer>

    <div id="success-message-modal" class="fixed inset-0 bg-navy/80 z-[100] flex items-center justify-center hidden backdrop-blur-md opacity-0 transition-opacity duration-300">
        <div class="bg-white p-12 rounded-[2.5rem] shadow-2xl max-w-md text-center transform scale-90 transition-transform duration-300">
            <div class="w-24 h-24 bg-green-100 rounded-full flex items-center justify-center mx-auto mb-8 text-green-500 text-5xl animate-bounce"><i class="fas fa-check"></i></div>
            <h3 class="text-3xl font-bold text-navy mb-4" data-lang="form_success_modal_title">¡Mensaje Enviado!</h3>
            <p class="text-gray-600 mb-10 leading-relaxed text-lg" data-lang="form_success_modal_text">Gracias por contactarnos. Un técnico se pondrá en contacto contigo muy pronto.</p>
            <button id="close-success-modal-btn" class="btn-premium bg-navy hover:bg-blue-900 text-white font-bold py-4 px-12 rounded-full transition-all shadow-xl text-lg">Cerrar</button>
        </div>
    </div>

    <script type="module">
        // Importaciones de Firebase (Standard v9)
        import { initializeApp } from "https://www.gstatic.com/firebasejs/10.8.0/firebase-app.js";
        import { getAuth, onAuthStateChanged, GoogleAuthProvider, signInWithPopup, signOut, signInAnonymously } from "https://www.gstatic.com/firebasejs/10.8.0/firebase-auth.js";
        import { getFirestore, collection, addDoc, query, where, orderBy, limit, getDocs, serverTimestamp } from "https://www.gstatic.com/firebasejs/10.8.0/firebase-firestore.js";

        // ==========================================
        //  ¡¡PEGAR TUS CLAVES DE FIREBASE ACÁ ABAJO!!
        // ==========================================
        const firebaseConfig = {
            // apiKey: "AIzaSy...",
            // authDomain: "tu-proyecto.firebaseapp.com",
            // projectId: "tu-proyecto",
            // storageBucket: "tu-proyecto.appspot.com",
            // messagingSenderId: "123456789",
            // appId: "1:123456789:web:abcdef"
        };
        // ==========================================

        // ID de la App para la ruta de la base de datos (según tu código original)
        // Si no lo tenés, dejá esto como está, pero asegurate de que coincida con tu config.
        const appId = firebaseConfig.projectId || "erb-servicio-tecnico-default"; 

        // Inicialización segura
        let app, auth, db;
        try {
            // Verificamos si pusiste las claves antes de iniciar
            if (Object.keys(firebaseConfig).length > 0) {
                app = initializeApp(firebaseConfig);
                auth = getAuth(app);
                db = getFirestore(app);
                console.log("Firebase iniciado correctamente.");
            } else {
                console.warn("Faltan las claves en firebaseConfig. La base de datos no funcionará hasta que las pegues.");
            }
        } catch (e) {
            console.error("Error iniciando Firebase:", e);
        }

        // Datos de traducciones y servicios (Igual que antes)
        const translations = {
            es: {
                nav_home: "Inicio", nav_services: "Servicios", nav_benefits: "Beneficios", nav_brands: "Marcas", nav_about: "Sobre Nosotros", nav_testimonials: "Testimonios", nav_contact: "Contacto",
                hero_h1: "Reparación de Electrodomésticos", hero_subtitle: "Especialistas en gama blanca, industrial y climatización. Rapidez, confianza y garantía.", hero_cta: "Solicita Presupuesto",
                services_title: "Nuestros Servicios", services_intro: "Soluciones expertas para todo tipo de electrodomésticos y climatización.",
                filter_all: "Todos", filter_domestic: "Doméstico", filter_industrial: "Industrial",
                benefits_title: "Por Qué Elegirnos", benefit1_title: "Atención Inmediata", benefit1_desc: "Solicita tu inspección llamando a nuestros canales.", benefit2_title: "Sin Coste de Desplazamiento", benefit2_desc: "Reparación en el acto si decides reparar.", benefit3_title: "Garantía de 6 Meses", benefit3_desc: "Garantía en la reparación.", benefit4_title: "Precios Competitivos", benefit4_desc: "Tarifas justas.",
                testimonials_title: "Opiniones de Clientes", testimonial_form_title: "Deja tu Opinión", testimonial_logged_in_as: "Conectado como:", testimonial_sign_out: "Cerrar Sesión", testimonial_signin_google: "Iniciar sesión con Google", testimonial_form_name: "Nombre", testimonial_form_rating: "Calificación", testimonial_form_rating_required: "Selecciona una estrella", testimonial_form_message: "Tu Opinión", testimonial_form_submit: "Enviar Opinión", testimonial_form_success: "¡Gracias por tu opinión!", testimonial_form_error: "Error al enviar.",
                contact_title: "Contacta con Nosotros", form_name: "Nombre Completo", form_phone: "Teléfono", form_location: "¿Dónde te encuentras?", form_appliance: "Electrodoméstico", form_message: "Descripción", form_submit: "Solicitar Reparación", form_sending: "Enviando...",
                contact_info_title: "Información de Contacto", contact_phone_text: "+34 612 548 508", contact_email_text: "serviciotecnico.erb@gmail.com", contact_whatsapp_text: "WhatsApp Directo",
                footer_copyright: "© 2025 ERB Servicio Técnico.", footer_privacy: "Política de Privacidad", footer_legal: "Aviso Legal", footer_cookies: "Política de Cookies",
                form_success_modal_title: "¡Mensaje Enviado!", form_success_modal_text: "Gracias por tu mensaje.", form_success_modal_close: "Cerrar",
                service_ac_title: "Aire Acondicionado", service_ac_desc: "Instalación y reparación.", service_washing_machine_title: "Lavadoras", service_washing_machine_desc: "Reparación de centrifugado y fugas.", service_dishwasher_title: "Lavavajillas", service_dishwasher_desc: "Problemas de limpieza y desagüe.", service_oven_title: "Hornos", service_oven_desc: "Fallos de temperatura.", service_dryer_title: "Secadoras", service_dryer_desc: "No seca o hace ruido.", service_cooktop_title: "Vitrocerámicas", service_cooktop_desc: "Inducción y eléctrica.", service_water_heater_title: "Calentadores", service_water_heater_desc: "Gas y eléctricos.", service_boiler_title: "Calderas", service_boiler_desc: "Mantenimiento y averías.", service_thermotank_title: "Termos", service_thermotank_desc: "Eléctricos.",
                service_industrial_laundry_title: "Lavandería Industrial", service_industrial_laundry_desc: "Maquinaria pesada.", service_industrial_fridge_title: "Frío Industrial", service_industrial_fridge_desc: "Cámaras y vitrinas.", service_industrial_boiler_title: "Calderas Industriales", service_industrial_boiler_desc: "Sistemas grandes.",
                loc_barcelona: "Barcelona", loc_coruna: "La Coruña", loc_valencia: "Valencia", loc_castellon: "Castellón",
                map_error_title: "Mapa no disponible", map_error_text: "Error al cargar"
            },
            ca: { /* Mantiene estructura para catalán */ },
            va: { /* Mantiene estructura para valenciano */ }
        };

        const services = [
            { id: 'aire-acondicionado', type: 'domestico', icon: 'fa-wind', title_key: 'service_ac_title', desc_key: 'service_ac_desc' },
            { id: 'lavadoras', type: 'domestico', icon: 'fa-soap', title_key: 'service_washing_machine_title', desc_key: 'service_washing_machine_desc' },
            { id: 'lavavajillas', type: 'domestico', icon: 'fa-glass-water-droplet', title_key: 'service_dishwasher_title', desc_key: 'service_dishwasher_desc' },
            { id: 'hornos', type: 'domestico', icon: 'fa-temperature-high', title_key: 'service_oven_title', desc_key: 'service_oven_desc' },
            { id: 'secadoras', type: 'domestico', icon: 'fa-shirt', title_key: 'service_dryer_title', desc_key: 'service_dryer_desc' },
            { id: 'vitroceramicas', type: 'domestico', icon: 'fa-fire-burner', title_key: 'service_cooktop_title', desc_key: 'service_cooktop_desc' },
            { id: 'calentadores', type: 'domestico', icon: 'fa-fire', title_key: 'service_water_heater_title', desc_key: 'service_water_heater_desc' },
            { id: 'calderas', type: 'domestico', icon: 'fa-hot-tub-person', title_key: 'service_boiler_title', desc_key: 'service_boiler_desc' },
            { id: 'termos', type: 'domestico', icon: 'fa-temperature-arrow-up', title_key: 'service_thermotank_title', desc_key: 'service_thermotank_desc' },
            { id: 'lavanderia-industrial', type: 'industrial', icon: 'fa-industry', title_key: 'service_industrial_laundry_title', desc_key: 'service_industrial_laundry_desc' },
            { id: 'frio-industrial', type: 'industrial', icon: 'fa-snowflake', title_key: 'service_industrial_fridge_title', desc_key: 'service_industrial_fridge_desc' },
            { id: 'calderas-industriales', type: 'industrial', icon: 'fa-fire-flame-curved', title_key: 'service_industrial_boiler_title', desc_key: 'service_industrial_boiler_desc' }
        ];

        // --- FUNCIONES DE LÓGICA DE NEGOCIO ---

        // Función 5: Actualizar UI de Autenticación
        function updateAuthUI(user) {
            const googleSignInBtn = document.getElementById('google-signin-btn');
            const userInfoDiv = document.getElementById('user-info');
            const userDisplayNameSpan = document.getElementById('user-display-name');
            const signOutBtn = document.getElementById('signout-btn');
            const testimonialNombreInput = document.getElementById('testimonialNombre');

            if (user && !user.isAnonymous) {
                googleSignInBtn.classList.add('hidden');
                userInfoDiv.classList.remove('hidden');
                signOutBtn.classList.remove('hidden');
                userDisplayNameSpan.textContent = user.displayName;
                testimonialNombreInput.value = user.displayName || '';
                testimonialNombreInput.readOnly = true;
                testimonialNombreInput.classList.add('bg-gray-100');
            } else {
                googleSignInBtn.classList.remove('hidden');
                userInfoDiv.classList.add('hidden');
                signOutBtn.classList.add('hidden');
                userDisplayNameSpan.textContent = '';
                testimonialNombreInput.value = '';
                testimonialNombreInput.readOnly = false;
                testimonialNombreInput.classList.remove('bg-gray-100');
            }
        }

        // Función 6: Actualizar Estrellas
        let currentRating = 0;
        function updateStarDisplay(rating) {
            const stars = document.querySelectorAll('#ratingStars .fa-star');
            stars.forEach(star => {
                const starRating = parseInt(star.getAttribute('data-rating'));
                if (starRating <= rating) {
                    star.classList.add('selected');
                } else {
                    star.classList.remove('selected');
                }
            });
        }

        // Función 7: Cargar Testimonios
        async function loadTestimonials() {
            if (!db) return;
            const container = document.getElementById('testimonials-container');
            const collectionPath = `artifacts/${appId}/public/data/testimonials`; // Ruta original de tu archivo
            
            try {
                const q = query(collection(db, collectionPath), orderBy("createdAt", "desc"), limit(6));
                const querySnapshot = await getDocs(q);
                
                container.innerHTML = ''; // Limpiar
                
                querySnapshot.forEach((doc) => {
                    const data = doc.data();
                    const card = document.createElement('div');
                    card.className = "bg-slate-50 p-8 rounded-[2rem] shadow-lg border border-gray-100 reveal-element";
                    
                    // Renderizado de estrellas
                    let starsHtml = '';
                    for (let i = 1; i <= 5; i++) {
                        starsHtml += `<i class="fas fa-star ${i <= data.rating ? 'text-gold' : 'text-gray-300'}"></i>`;
                    }

                    card.innerHTML = `
                        <div class="flex items-center mb-4">
                            <div class="w-10 h-10 rounded-full bg-navy text-white flex items-center justify-center font-bold mr-3">
                                ${data.name.charAt(0).toUpperCase()}
                            </div>
                            <div>
                                <h4 class="font-bold text-navy">${data.name}</h4>
                                <div class="text-sm">${starsHtml}</div>
                            </div>
                        </div>
                        <p class="text-gray-600 italic">"${data.comment}"</p>
                    `;
                    container.appendChild(card);
                });
                initScrollAnimations(); // Re-aplicar animaciones a los nuevos elementos
            } catch (error) {
                console.warn("Error cargando testimonios:", error);
            }
        }

        // Función 8: Guardar Testimonio (Lógica Real)
        async function saveTestimonial(event) {
            event.preventDefault();
            if (!db || !auth) {
                alert("Error de conexión con la base de datos.");
                return;
            }

            const loadingSpinner = document.getElementById('testimonial-loading-spinner');
            const formStatus = document.getElementById('testimonialFormStatus');
            const submitBtn = document.getElementById('submitTestimonial');
            
            const nombre = document.getElementById('testimonialNombre').value;
            const mensaje = document.getElementById('testimonialMensaje').value;

            if (currentRating === 0) {
                document.getElementById('ratingError').classList.remove('hidden');
                return;
            }
            document.getElementById('ratingError').classList.add('hidden');

            loadingSpinner.classList.remove('hidden');
            submitBtn.disabled = true;

            try {
                const user = auth.currentUser;
                const collectionPath = `artifacts/${appId}/public/data/testimonials`;
                
                await addDoc(collection(db, collectionPath), {
                    name: nombre,
                    rating: currentRating,
                    comment: mensaje,
                    createdAt: serverTimestamp(),
                    userId: user ? user.uid : 'anonymous',
                    isGoogleUser: user && !user.isAnonymous
                });

                formStatus.textContent = "¡Opinión enviada correctamente!";
                formStatus.className = "mt-4 text-center text-green-600 font-bold";
                document.getElementById('testimonialForm').reset();
                currentRating = 0;
                updateStarDisplay(0);
                loadTestimonials(); // Recargar
            } catch (error) {
                console.error("Error guardando:", error);
                formStatus.textContent = "Hubo un error al enviar. Intenta de nuevo.";
                formStatus.className = "mt-4 text-center text-red-500 font-bold";
            } finally {
                loadingSpinner.classList.add('hidden');
                submitBtn.disabled = false;
            }
        }

        // Función 9: Poblar Tarjetas
        function populateServiceCards(lang) {
            const container = document.getElementById('service-list');
            if (!container) return;
            container.innerHTML = '';
            
            services.forEach((service, index) => {
                const title = translations[lang][service.title_key] || translations['es'][service.title_key];
                const desc = translations[lang][service.desc_key] || translations['es'][service.desc_key];
                const delayClass = index % 3 === 0 ? 'delay-100' : (index % 3 === 1 ? 'delay-200' : 'delay-300');
                
                const card = document.createElement('div');
                card.className = `service-card ${service.type} bg-white p-8 rounded-[2rem] shadow-lg border border-gray-100 hover-lift group reveal-element ${delayClass}`;
                card.innerHTML = `
                    <div class="w-16 h-16 mb-6 bg-blue-50 rounded-2xl flex items-center justify-center text-3xl text-navy group-hover:bg-navy group-hover:text-white transition-all duration-300 shadow-sm"><i class="fas ${service.icon}"></i></div>
                    <h3 class="text-xl font-bold text-navy mb-3 group-hover:translate-x-1 transition-transform">${title}</h3>
                    <p class="text-gray-600 leading-relaxed">${desc}</p>
                `;
                container.appendChild(card);
            });
            initScrollAnimations();
        }

        // Función 10: Poblar Select
        function populateApplianceSelect(lang) {
            const select = document.getElementById('equipo');
            if(!select) return;
            select.innerHTML = '';
            services.forEach(service => {
                const title = translations[lang][service.title_key] || translations['es'][service.title_key];
                const option = document.createElement('option');
                option.value = service.id;
                option.textContent = title;
                select.appendChild(option);
            });
        }

        // Función 11: Filtrar Servicios
        function filterServices(filter) {
            const cards = document.querySelectorAll('.service-card');
            const buttons = document.querySelectorAll('.filter-btn');
            
            buttons.forEach(btn => {
                if (btn.getAttribute('data-filter') === filter) {
                    btn.classList.add('active', 'bg-navy', 'text-white', 'shadow-md');
                    btn.classList.remove('bg-white', 'text-navy');
                } else {
                    btn.classList.remove('active', 'bg-navy', 'text-white', 'shadow-md');
                    btn.classList.add('bg-white', 'text-navy');
                }
            });

            cards.forEach(card => {
                if (filter === 'all' || card.classList.contains(filter)) {
                    card.classList.remove('hidden');
                    card.classList.add('reveal-element', 'visible');
                } else {
                    card.classList.add('hidden');
                    card.classList.remove('visible');
                }
            });
        }

        // Función 12: Cambiar Idioma
        function setLanguage(lang) {
            if (!translations[lang]) lang = 'es';
            document.querySelectorAll('[data-lang]').forEach(el => {
                const key = el.getAttribute('data-lang');
                if (translations[lang][key]) el.textContent = translations[lang][key];
            });
            populateServiceCards(lang);
            populateApplianceSelect(lang);
            const currentLangText = document.getElementById('current-lang-text');
            if (currentLangText) currentLangText.textContent = lang.toUpperCase();
            const mobileBtn = document.querySelector('[data-lang="nav_contact_mobile"]');
            if (mobileBtn && translations[lang]['nav_contact']) mobileBtn.textContent = translations[lang]['nav_contact'];
        }
        
        // Función 4: Animaciones de Scroll
        function initScrollAnimations() {
            const observerOptions = { root: null, rootMargin: '0px', threshold: 0.1 };
            const observer = new IntersectionObserver((entries, observer) => {
                entries.forEach(entry => {
                    if (entry.isIntersecting) {
                        entry.target.classList.add('visible');
                        if (entry.target.classList.contains('section-title')) entry.target.classList.add('visible');
                        observer.unobserve(entry.target);
                    }
                });
            }, observerOptions);
            document.querySelectorAll('.reveal-element, .section-title').forEach(el => observer.observe(el));
        }

        // Inicialización General
        document.addEventListener('DOMContentLoaded', () => {
            const preferredLang = localStorage.getItem('preferredLanguage') || 'es';
            setLanguage(preferredLang);
            filterServices('all');
            initScrollAnimations();

            // Listeners
            document.getElementById('mobile-menu-button')?.addEventListener('click', () => document.getElementById('mobile-menu').classList.remove('translate-x-full'));
            document.getElementById('close-mobile-menu-button')?.addEventListener('click', () => document.getElementById('mobile-menu').classList.add('translate-x-full'));
            document.querySelectorAll('.filter-btn').forEach(btn => btn.addEventListener('click', () => filterServices(btn.getAttribute('data-filter'))));
            
            // Estrellas
            document.querySelectorAll('#ratingStars .fa-star').forEach(star => {
                star.addEventListener('click', function() {
                    currentRating = parseInt(this.getAttribute('data-rating'));
                    document.getElementById('ratingValue').value = currentRating;
                    updateStarDisplay(currentRating);
                });
            });

            // Firebase Auth Listeners
            if (auth) {
                onAuthStateChanged(auth, (user) => {
                    updateAuthUI(user);
                    if (!user) signInAnonymously(auth).catch(console.error);
                    loadTestimonials(); // Cargar al inicio si auth está listo
                });

                // Google Login
                const googleBtn = document.getElementById('google-signin-btn');
                if (googleBtn) {
                    googleBtn.addEventListener('click', async () => {
                        try {
                            const provider = new GoogleAuthProvider();
                            await signInWithPopup(auth, provider);
                        } catch (e) {
                            console.error("Login fallido", e);
                            alert("Error al iniciar sesión con Google");
                        }
                    });
                }
                
                // Sign Out
                const signOutBtn = document.getElementById('signout-btn');
                if (signOutBtn) {
                    signOutBtn.addEventListener('click', async () => {
                        await signOut(auth);
                        window.location.reload();
                    });
                }

                // Submit Testimonio
                document.getElementById('testimonialForm').addEventListener('submit', saveTestimonial);
            }

            // Modal
            document.getElementById('close-success-modal-btn')?.addEventListener('click', () => {
                const modal = document.getElementById('success-message-modal');
                modal.classList.remove('opacity-100');
                modal.querySelector('div').classList.remove('scale-100');
                modal.querySelector('div').classList.add('scale-90');
                setTimeout(() => modal.classList.add('hidden'), 300);
            });
        });
    </script>
    
    <script>
        function initMap() {
            try {
                const valencia = { lat: 39.4699, lng: -0.3763 };
                const map = new google.maps.Map(document.getElementById("map"), {
                    zoom: 11, center: valencia, mapId: "DEMO_MAP_ID", disableDefaultUI: false, zoomControl: true,
                    styles: [{ "featureType": "all", "elementType": "geometry.fill", "stylers": [{ "weight": "2.00" }] }, { "featureType": "all", "elementType": "geometry.stroke", "stylers": [{ "color": "#9c9c9c" }] }, { "featureType": "all", "elementType": "labels.text", "stylers": [{ "visibility": "on" }] }, { "featureType": "landscape", "elementType": "all", "stylers": [{ "color": "#f2f2f2" }] }]
                });
                new google.maps.Marker({ position: valencia, map: map, title: "ERB Servicio Técnico", animation: google.maps.Animation.DROP });
            } catch (e) {
                console.error("Error mapa", e);
                window.gm_authFailure();
            }
        }
        window.initMap = initMap;
        window.gm_authFailure = function() { document.getElementById('map-error-message')?.classList.remove('hidden'); };
    </script>
    <script async src="https://maps.googleapis.com/maps/api/js?key=AIzaSyDz_erEiiEvZlRfOhnRCt-Ooz5yM9rBrgk&libraries=geometry&callback=initMap&onerror=gm_authFailure"></script>

</body>
</html>
